using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Data.Sql;
using System.Data.SqlClient;
using System.IO;
using System.Data;
using System.Text;
using System.Configuration;
using System.Web.Configuration;
using System.Web.Script.Serialization;
using NPOI.OpenXmlFormats.Wordprocessing;
//using Microsoft.Ajax.Utilities;

namespace NewCapit.dist.pages
{
    public partial class Frm_GerarTXT : System.Web.UI.Page
    {
        string cracha, hora;
        string sql4;
        string tipo, arquivo, arquivo1, pf;
        int c, d;
        int inicio, reinicio, fim, pernoite;
        int iniciob, reiniciob, fimb, pernoiteb;
        string usuarioLogado;
        public string fotoMotorista;
        string codmot, caminhofoto;

        protected void btnLimpar_Click(object sender, EventArgs e)
        {
            if (txtconformmessageValue4.Value == "Yes")
            {
                string caminho1 = Server.MapPath("../../TXT/");


                if (System.IO.Directory.Exists(caminho1))
                {
                    string[] files = System.IO.Directory.GetFiles(caminho1);

                    // Copy the files and overwrite destination files if they already exist.
                    foreach (string s in files)
                    {
                        // Use static Path methods to extract only the file name from the path.
                        string fileName = System.IO.Path.GetFileName(s);
                        System.IO.File.Delete(caminho1 + fileName);
                    }

                    string message = "Arquivos excluídos com sucesso!";
                    System.Text.StringBuilder sb = new System.Text.StringBuilder();
                    sb.Append("<script type = 'text/javascript'>");
                    sb.Append("window.onload=function(){");
                    sb.Append("alert('");
                    sb.Append(message);
                    sb.Append("')};");
                    sb.Append("</script>");
                    ClientScript.RegisterClientScriptBlock(this.GetType(), "alert", sb.ToString());
                    CarregaLista();

                }
                else
                {
                    string message = "Não foi possível efetuar exclusão!";
                    System.Text.StringBuilder sb = new System.Text.StringBuilder();
                    sb.Append("<script type = 'text/javascript'>");
                    sb.Append("window.onload=function(){");
                    sb.Append("alert('");
                    sb.Append(message);
                    sb.Append("')};");
                    sb.Append("</script>");
                    ClientScript.RegisterClientScriptBlock(this.GetType(), "alert", sb.ToString());
                }
            }
        }



        protected void btnGerar_Click(object sender, EventArgs e)
        {

            if (txtDtInicial.Text != string.Empty || txtDtFinal.Text != string.Empty)
            {
                TimeSpan date = Convert.ToDateTime(txtDtFinal.Text) - Convert.ToDateTime(txtDtInicial.Text);

                int totalDias = date.Days;

                if (totalDias <= 7)
                {
                    if (chkMotorista.Checked == false && chkCadiriri.Checked == false && chkDiadema.Checked == false && chkIpiranda.Checked == false && chkMinas.Checked == false)
                    {
                        string message = "É necessário selecionar uma unidade ou Motorista";
                        System.Text.StringBuilder sb = new System.Text.StringBuilder();
                        sb.Append("<script type = 'text/javascript'>");
                        sb.Append("window.onload=function(){");
                        sb.Append("alert('");
                        sb.Append(message);
                        sb.Append("')};");
                        sb.Append("</script>");
                        ClientScript.RegisterClientScriptBlock(this.GetType(), "alert", sb.ToString());
                    }
                    else
                    {
                        if (chkMotorista.Checked == true && txtCodMotorista.Text == string.Empty)
                        {
                            string message = "É necessário que o Motorista seja indicado!";
                            System.Text.StringBuilder sb = new System.Text.StringBuilder();
                            sb.Append("<script type = 'text/javascript'>");
                            sb.Append("window.onload=function(){");
                            sb.Append("alert('");
                            sb.Append(message);
                            sb.Append("')};");
                            sb.Append("</script>");
                            ClientScript.RegisterClientScriptBlock(this.GetType(), "alert", sb.ToString());
                        }
                        else
                        {
                            // Txt4a();
                            Txt5e();
                            ScriptManager.RegisterStartupScript(this, this.GetType(), "fecharModal", "$('.modal').modal('hide');", true);
                        }
                        
                    }

                }
                else
                {
                    string message = "O período está fora do escopo suportado pelo sistema. ";
                    System.Text.StringBuilder sb = new System.Text.StringBuilder();
                    sb.Append("<script type = 'text/javascript'>");
                    sb.Append("window.onload=function(){");
                    sb.Append("alert('");
                    sb.Append(message);
                    sb.Append("')};");
                    sb.Append("</script>");
                    ClientScript.RegisterClientScriptBlock(this.GetType(), "alert", sb.ToString());
                }
            }
            else
            {
                string message = "É necessário escolher o período de pesquisa. ";
                System.Text.StringBuilder sb = new System.Text.StringBuilder();
                sb.Append("<script type = 'text/javascript'>");
                sb.Append("window.onload=function(){");
                sb.Append("alert('");
                sb.Append(message);
                sb.Append("')};");
                sb.Append("</script>");
                ClientScript.RegisterClientScriptBlock(this.GetType(), "alert", sb.ToString());
            }


            

        }

        int dia;

        protected void chkMotorista_CheckedChanged(object sender, EventArgs e)
        {
            chkDiadema.Checked = false;
            //chkBahia.Checked = false;
            chkCadiriri.Checked = false;
            chkIpiranda.Checked = false;
            chkMinas.Checked = false;
            chkMotorista.Checked = true;
        }

        SqlConnection con = new SqlConnection(WebConfigurationManager.ConnectionStrings["conexao"].ToString());
        protected void Page_Load(object sender, EventArgs e)
        {
            if (!IsPostBack)
            {
                if (Session["UsuarioLogado"] != null)
                {
                    string nomeUsuario = Session["UsuarioLogado"].ToString();
                    //var lblUsuario = nomeUsuario;
                    var usuarioLogado = nomeUsuario;
                }
                else
                {
                    //var lblUsuario = "<Usuário>";
                    var usuarioLogado = "<Usuário>";
                }
                
                CarregaLista();
            }
            if (txtCodMotorista.Text.Trim() == string.Empty)
            {
                fotoMotorista = "../../fotos/usuario.jpg";
            }
            else
            {
                CarregaFoto();
            }
        }
        public void CarregaFoto()
        {
            var codigo = txtCodMotorista.Text.Trim();

            var obj = new Domain.ConsultaMotorista
            {
                codmot = codigo
            };
            var ConsultaMotorista = DAL.UsersDAL.CheckMotorista(obj);
            if (ConsultaMotorista != null)
            {
                if (ConsultaMotorista.status.Trim() != "INATIVO")
                {
                    if (txtCodMotorista.Text.Trim() != "")
                    {
                        fotoMotorista = ConsultaMotorista.caminhofoto.Trim().ToString();

                        if (!File.Exists(fotoMotorista))
                        {
                            fotoMotorista = ConsultaMotorista.caminhofoto.Trim().ToString();
                        }
                        else
                        {
                            fotoMotorista = "../../fotos/usuario.jpg";
                        }
                    }

                }

            }

        }
        protected void chkDiadema_CheckedChanged(object sender, EventArgs e)
        {
            chkDiadema.Checked = true;
            //chkBahia.Checked = false;
            chkCadiriri.Checked = false;
            chkIpiranda.Checked = false;
            chkMinas.Checked = false;
        }

        protected void chkCadiriri_CheckedChanged(object sender, EventArgs e)
        {
            chkDiadema.Checked = false;
            //chkBahia.Checked = false;
            chkCadiriri.Checked = true;
            chkIpiranda.Checked = false;
            chkMinas.Checked = false;
        }

        protected void chkIpiranda_CheckedChanged(object sender, EventArgs e)
        {
            chkDiadema.Checked = false;
            //chkBahia.Checked = false;
            chkCadiriri.Checked = false;
            chkIpiranda.Checked = true;
            chkMinas.Checked = false;
        }

        protected void chkMinas_CheckedChanged(object sender, EventArgs e)
        {
            chkDiadema.Checked = false;
            //chkBahia.Checked = false;
            chkCadiriri.Checked = false;
            chkIpiranda.Checked = false;
            chkMinas.Checked = true;
        }
        protected void btnPesquisarMotorista_Click(object sender, EventArgs e)
        {
            string nomeUsuario = usuarioLogado;
            if (txtCodMotorista.Text.Trim() == "")
            {     
                string linha1 = "Olá, " + nomeUsuario.Trim() + "!";
                string linha2 = "Por favor, digite o código do motorista.";

                // Concatenando as linhas com '\n' para criar a mensagem
                string mensagem = $"{linha1}\n{linha2}";

                string mensagemCodificada = HttpUtility.JavaScriptStringEncode(mensagem);
                // Gerando o script JavaScript para exibir o alerta
                string script = $"alert('{mensagemCodificada}');";

                // Registrando o script para execução no lado do cliente
                ClientScript.RegisterStartupScript(this.GetType(), "MensagemDeAlerta", script, true);
                txtCodMotorista.Focus();

            }
            else
            {
                var codigo = txtCodMotorista.Text.Trim();
                var obj = new Domain.ConsultaMotorista
                {
                    codmot = codigo
                };
                var ConsultaMotorista = DAL.UsersDAL.CheckMotorista(obj);
                if (ConsultaMotorista != null)
                {
                    if (ConsultaMotorista.status.Trim() == "INATIVO")
                    {
                        //if (txtCodMotorista.Text.Trim() != "")
                        //{
                        //    fotoMotorista = ConsultaMotorista.caminhofoto.Trim().ToString();

                        //    String path = Server.MapPath("../../fotos/");
                        //    string file = fotoMotorista;
                        //    if (File.Exists(path + file))
                        //    {
                        //        fotoMotorista = "../../fotos/" + file + "";
                        //    }
                        //    else
                        //    {
                        //        fotoMotorista = "../../fotos/usuario.jpg";
                        //    }
                        //}
                        string razaoSocial = ConsultaMotorista.nommot;
                        string unidade = ConsultaMotorista.nucleo;

                        string linha1 = "Olá, " + nomeUsuario + "!";
                        string linha2 = "Código " + codigo + ", excluido ou inativo no sistema.";
                        string linha3 = "Motorista: " + razaoSocial + ".";
                        string linha4 = "Filial: " + unidade + ". Por favor, verifique.";

                        // Concatenando as linhas com '\n' para criar a mensagem
                        string mensagem = $"{linha1}\n{linha2}\n{linha3}\n{linha4}";

                        string mensagemCodificada = HttpUtility.JavaScriptStringEncode(mensagem);
                        // Gerando o script JavaScript para exibir o alerta
                        string script = $"alert('{mensagemCodificada}');";

                        // Registrando o script para execução no lado do cliente
                        ClientScript.RegisterStartupScript(this.GetType(), "MensagemDeAlerta", script, true);
                        txtCodMotorista.Text = "";
                        txtCodMotorista.Focus();
                    }
                    else
                    {
                        txtFilialMot.Text = ConsultaMotorista.nucleo;
                        txtFuncao.Text = ConsultaMotorista.cargo;
                        txtNomMot.Text = ConsultaMotorista.nommot;
                        //if (txtCodMotorista.Text.Trim() != "")
                        //{
                        //    fotoMotorista = ConsultaMotorista.caminhofoto.Trim().ToString();

                        //    String path = Server.MapPath("../../fotos/");
                        //    string file = fotoMotorista;
                        //    if (File.Exists(path + file))
                        //    {
                        //        fotoMotorista = "../../fotos/" + file + "";
                        //    }
                        //    else
                        //    {
                        //        fotoMotorista = "../../fotos/usuario.jpg";
                        //    }
                        //}


                        if (ConsultaMotorista.tipomot.Trim() == "AGREGADO" || ConsultaMotorista.tipomot.Trim() == "TERCEIRO")
                        {
                            string razaoSocial = ConsultaMotorista.nommot;
                            string unidade = ConsultaMotorista.nucleo;

                            string linha1 = "Olá, " + nomeUsuario + "!";
                            string linha2 = "Código " + codigo;
                            string linha3 = "Motorista: " + razaoSocial + ".";
                            string linha4 = "Não é empregado.";

                            // Concatenando as linhas com '\n' para criar a mensagem
                            string mensagem = $"{linha1}\n{linha2}\n{linha3}\n{linha4}";

                            string mensagemCodificada = HttpUtility.JavaScriptStringEncode(mensagem);
                            // Gerando o script JavaScript para exibir o alerta
                            string script = $"alert('{mensagemCodificada}');";

                            // Registrando o script para execução no lado do cliente
                            ClientScript.RegisterStartupScript(this.GetType(), "MensagemDeAlerta", script, true);
                            txtCodMotorista.Text = "";
                            txtCodMotorista.Focus();

                        }                        
                    }
                }
                else
                {                    
                    string linha1 = "Olá, " + nomeUsuario + "!";
                    string linha2 = "Motorista " + codigo + ", não cadastrado no sistema.";
                    string linha3 = "Verifique o código digitado: " + codigo + ".";
                    
                    // Concatenando as linhas com '\n' para criar a mensagem
                    string mensagem = $"{linha1}\n{linha2}\n{linha3}";

                    string mensagemCodificada = HttpUtility.JavaScriptStringEncode(mensagem);
                    //// Gerando o script JavaScript para exibir o alerta
                    string script = $"alert('{mensagemCodificada}');";

                    //// Registrando o script para execução no lado do cliente
                    ClientScript.RegisterStartupScript(this.GetType(), "MensagemDeAlerta", script, true);

                    fotoMotorista = "../../fotos/usuario.jpg";
                    txtCodMotorista.Text = "";
                    txtCodMotorista.Focus();

                }

            }
        }
        public void Txt5d()
        {

            //try
            //{
            // string sql1 = "select nr_cracha from tb_motorista_txt";
            string sql1 = "select cod_login, ds_noturno from tb_motorista where ISNUMERIC(cod_login)=1 ";
            if (chkDiadema.Checked)
            {
                sql1 += " and ds_nucleo in('TNG CNT') ";
                //sql1 += " and cod_login in (330,912,1027,1058,958,1091,1099,1116,1219,1290,1338,1352,1274,1403,1421,1446,1395,1526,1532,1534,1544,1545,1543, ";
                //sql1 += " 1564,1570,1571,1584,482,999,820,989,1591,1590) ";
                //sql1 += " and cod_login in (636,906,1047,1064,1070,1075,1178,1231,1388,1412,1463,1464,1478,1485,1488,1490,1491,1492,1495,1496,1497,1498,1499,1500,1537,1539,1548,1549,1563,1567,1568,1569,1572,";
                //sql1 += " 1573,1574,1575,1576,1580,1581,1583,1585,1587,1588,10,21) ";
            }
            else if (chkCadiriri.Checked)
            {
                sql1 += " and ds_nucleo in('TNG MATRIZ') ";
                //sql1 += " and cod_login in (330,912,1027,1058,958,1091,1099,1116,1219,1290,1338,1352,1274,1403,1421,1446,1395,1526,1532,1534,1544,1545,1543, ";
                //sql1 += " 1564,1570,1571,1584,482,999,820,989,1591,1590) ";
                //sql1 += " and cod_login in (636,906,1047,1064,1070,1075,1178,1231,1388,1412,1463,1464,1478,1485,1488,1490,1491,1492,1495,1496,1497,1498,1499,1500,1537,1539,1548,1549,1563,1567,1568,1569,1572,";
                //sql1 += " 1573,1574,1575,1576,1580,1581,1583,1585,1587,1588,10,21) ";
            }
            else if (chkMinas.Checked)
            {
                sql1 += " and ds_nucleo='TNG MINAS' ";

            }
            //else if (chkBahia.Checked)
            //{
            //    sql1 += " and ds_nucleo='TNG BAHIA' ";
            //}
            else if (chkIpiranda.Checked)
            {
                sql1 += " and ds_nucleo='TNG IPIRANGA' ";
            }
            sql1 += " order by cod_login";
            SqlDataAdapter adtp1 = new SqlDataAdapter(sql1, con);
            DataTable dt1 = new DataTable();

            try
            {
                con.Open();
                adtp1.Fill(dt1);
                con.Close();
            }
            catch (Exception ed)
            {
                //MessageBox.Show(ed.ToString(), "Erro1");
            }
            //string arquivo2 = "Transmot" + DateTime.Parse(txtDtInicial.Text).ToString("ddMM") + "002.txt";

            if (chkDiadema.Checked)
            {
                arquivo1 = "Tngcnt" + DateTime.Parse(txtDtInicial.Text).ToString("ddMM") + "a" + DateTime.Parse(txtDtFinal.Text).ToString("ddMM") + ".txt";
            }
            else if (chkCadiriri.Checked)
            {
                arquivo1 = "Tngmatriz" + DateTime.Parse(txtDtInicial.Text).ToString("ddMM") + "a" + DateTime.Parse(txtDtFinal.Text).ToString("ddMM") + ".txt";
            }
            else if (chkMinas.Checked)
            {
                arquivo1 = "Tngminas" + DateTime.Parse(txtDtInicial.Text).ToString("ddMM") + "a" + DateTime.Parse(txtDtFinal.Text).ToString("ddMM") + ".txt";

            }
            //else if (chkBahia.Checked)
            //{
            //    arquivo1 = "Tngbahia" + DateTime.Parse(txtDtInicial.Text).ToString("ddMM") + "a" + DateTime.Parse(txtDtFinal.Text).ToString("ddMM") + ".txt";
            //}
            else if (chkIpiranda.Checked)
            {
                arquivo1 = "Tngipiranga" + DateTime.Parse(txtDtInicial.Text).ToString("ddMM") + "a" + DateTime.Parse(txtDtFinal.Text).ToString("ddMM") + ".txt";
            }



            string caminho1 = Server.MapPath("/TXT/");

            string filepath1 = caminho1 + arquivo1;

            FileInfo file1 = new FileInfo(filepath1);
            if (file1.Exists)
            {
                file1.Delete();
            }


            for (int x = 0; x < dt1.Rows.Count; x++)
            {

                string sql_e = "select dt_posicao_parada from tb_parada where dt_posicao_parada between '" + DateTime.Parse(txtDtInicial.Text).ToString("yyyy-MM-dd") + "' and '" + DateTime.Parse(txtDtFinal.Text).ToString("yyyy-MM-dd") + "' and cod_cracha=" + dt1.Rows[x][0].ToString() + " and fl_deletado is null   group by dt_posicao_parada order by dt_posicao_parada asc";
                SqlDataAdapter adtpe = new SqlDataAdapter(sql_e, con);
                DataTable dte = new DataTable();
                try
                {
                    con.Open();
                    adtpe.Fill(dte);
                    con.Close();
                }
                catch (Exception ex)
                {
                    var message2 = new JavaScriptSerializer().Serialize(ex.Message.ToString());
                    string retorno = "Erro! Contate o administrador. Detalhes do erro 50586: " + message2;
                    string caminho = Server.MapPath("/TXT/");
                    StreamWriter write = new StreamWriter(caminho + "Erro.txt", true);
                    write.WriteLine(retorno);
                    write.Flush();
                    write.Close();


                }
                finally
                {
                    con.Close();
                }

                for (int f = 0; f < dte.Rows.Count; f++)
                {
                    string sql3 = "select * from tb_parada where cod_cracha='" + dt1.Rows[x][0].ToString() + "' and dt_posicao_parada ='" + DateTime.Parse(dte.Rows[f][0].ToString()).ToString("yyyy-MM-dd") + "' AND (ds_macro IN ('INICIO DE JORNADA', 'INICIO JORNADA CAMINHAO', 'PARADA REFEICAO', 'FIM DE JORNADA','REINICIO DE VIAGEM','FIM DE VIAGEM', 'PARADA','PARADA INTERNA','INICIO DE VIAGEM') OR cod_ref_parada in (2,3,4,14)) AND fl_deletado IS NULL ORDER BY dt_posicao_parada, hr_posicao";
                    SqlDataAdapter adtp3 = new SqlDataAdapter(sql3, con);
                    DataTable dt3 = new DataTable();
                    try
                    {
                        con.Open();
                        adtp3.Fill(dt3);
                        con.Close();
                    }
                    catch (Exception ex)
                    {
                        var message2 = new JavaScriptSerializer().Serialize(ex.Message.ToString());
                        string retorno = "Erro! Contate o administrador. Detalhes do erro 50613: " + message2 + " || Data:" + DateTime.Parse(dte.Rows[f][0].ToString()).ToString();
                        string caminho = Server.MapPath("/TXT/");
                        StreamWriter write = new StreamWriter(caminho + "Erro.txt", true);
                        write.WriteLine(retorno);
                        write.Flush();
                        write.Close();


                    }
                    finally
                    {
                        con.Close();
                    }
                    if (chkDiadema.Checked)
                    {
                        arquivo = "Tngcnt" + DateTime.Parse(txtDtInicial.Text).ToString("ddMM") + "a" + DateTime.Parse(txtDtFinal.Text).ToString("ddMM") + ".txt";
                    }
                    else if (chkCadiriri.Checked)
                    {
                        arquivo = "Tngmatriz" + DateTime.Parse(txtDtInicial.Text).ToString("ddMM") + "a" + DateTime.Parse(txtDtFinal.Text).ToString("ddMM") + ".txt";
                    }
                    else if (chkMinas.Checked)
                    {
                        arquivo = "Tngminas" + DateTime.Parse(txtDtInicial.Text).ToString("ddMM") + "a" + DateTime.Parse(txtDtFinal.Text).ToString("ddMM") + ".txt";

                    }
                    //else if (chkBahia.Checked)
                    //{
                    //    arquivo = "Tngbahia" + DateTime.Parse(txtDtInicial.Text).ToString("ddMM") + "a" + DateTime.Parse(txtDtFinal.Text).ToString("ddMM") + ".txt";
                    //}
                    else if (chkIpiranda.Checked)
                    {
                        arquivo = "Tngipiranga" + DateTime.Parse(txtDtInicial.Text).ToString("ddMM") + "a" + DateTime.Parse(txtDtFinal.Text).ToString("ddMM") + ".txt";
                    }
                    else
                    {
                        arquivo = "Todos" + DateTime.Parse(txtDtInicial.Text).ToString("ddMM") + "a" + DateTime.Parse(txtDtFinal.Text).ToString("ddMM") + ".txt";
                    }

                    if (dt3.Rows.Count > 0)
                    {
                        if (dt3.Rows[0][6].ToString() == "INICIO DE JORNADA" || dt3.Rows[0][6].ToString() == "REINICIO DE VIAGEM" || dt3.Rows[0][6].ToString() == "PARADA PERNOITE")
                        {
                            //VERIFICA SE A ULTIMA MARCAÇÃO DO DIA É PARADA PERNOITE OU FIM DE VIAGEM
                            string sqlv = "select top 1 ds_macro from tb_parada where cod_cracha=" + dt1.Rows[x][0].ToString() + " and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).ToString("yyyy-MM-dd") + "' and fl_deletado is null order by hr_posicao  DESC ";
                            SqlDataAdapter adtpv = new SqlDataAdapter(sqlv, con);
                            DataTable dtv = new DataTable();
                            con.Open();
                            adtpv.Fill(dtv);
                            con.Close();


                            if (dtv.Rows[0][0].ToString() == "FIM DE JORNADA")
                            {
                                //JORNADA NORMAL INICIO DE JORNADA
                                #region Jornada Normal
                                //string arquivo = "Transmot" + DateTime.Parse(txtDtInicial.Text).ToString("ddMM") + "001.txt";

                                sql4 = "select dt_posicao_parada, hr_posicao, ds_macro,cod_transmissao, cod_cracha, isnull(cod_ref_parada,0) as cod_ref_parada, cod_idveiculo from tb_parada where fl_deletado is null and cod_cracha=" + dt1.Rows[x][0].ToString() + " and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).ToString("yyyy-MM-dd") + "' AND (ds_macro IN ('INICIO DE JORNADA', 'INICIO JORNADA CAMINHAO', 'PARADA REFEICAO', 'FIM DE JORNADA','REINICIO DE VIAGEM','FIM DE VIAGEM', 'PARADA','PARADA INTERNA','INICIO DE VIAGEM','RETORNO REFEICAO','PARADA CLIENTE / FORNECEDOR') OR cod_ref_parada in (2,3,4,14,22)) AND fl_deletado IS NULL ORDER BY dt_posicao_parada, hr_posicao";
                                // string sql4 = "select dt_posicao_parada, hr_posicao, ds_macro,cod_transmissao, cod_cracha, isnull(cod_ref_parada,0) as cod_ref_parada, cod_idveiculo from tb_parada where fl_deletado is null and cod_cracha=" + dt1.Rows[x][0].ToString() + " and dt_posicao_parada between '" + txtDtInicial.Text + "' and '" + txtDtFinal.Text + "' order by dt_posicao_parada, hr_posicao";
                                SqlDataAdapter adtp4 = new SqlDataAdapter(sql4, con);
                                DataTable dt4 = new DataTable();

                                try
                                {
                                    con.Open();
                                    adtp4.Fill(dt4);
                                    con.Close();
                                }
                                catch (Exception ed)
                                {
                                    // MessageBox.Show(ed.ToString(), "Erro3");
                                }

                                c = 0;

                                for (int y = 0; y < dt4.Rows.Count; y++)
                                {
                                    if (dt4.Rows[y][2].ToString() == "FIM DE JORNADA" && dt4.Rows[y][6].ToString() == "725405" || dt4.Rows[y][2].ToString() == "FIM DE JORNADA" && dt4.Rows[y][6].ToString() == "725407" || dt4.Rows[y][2].ToString() == "FIM DE JORNADA" && dt4.Rows[y][6].ToString() == "184525")
                                    {
                                        c = c + 1;
                                    }

                                }
                                string caminho = Server.MapPath("/TXT/");

                                string filepath = caminho + arquivo;

                                FileInfo file = new FileInfo(filepath);

                                //if (file.Exists)
                                //{
                                //    file.Delete();
                                //}


                                for (int w = 0; w < dt4.Rows.Count; w++)
                                {


                                    string codigo = dt1.Rows[x][0].ToString();
                                    string[] codigosEspeciais = { "330", "482", "820", "958", "989" };

                                    if (codigo.StartsWith("312"))
                                    {
                                        cracha = codigo.Insert(3, "0");
                                    }
                                    else if ((codigosEspeciais.Contains(codigo) || codigo.Length <= 4))
                                    {
                                        cracha = "30" + codigo;
                                    }
                                    else if (codigo.Length <= 3)
                                    {
                                        cracha = "300" + codigo;
                                    }

                                    else
                                    {
                                        cracha = codigo;
                                    }




                                    int t = 0;
                                    t = w - 1;

                                    string data = DateTime.Parse(dt4.Rows[w][0].ToString()).ToString("dd/MM/yy");
                                    string horas = DateTime.Parse(dt4.Rows[w][1].ToString()).ToString("HH:mm");
                                    if (t >= 0)
                                    {
                                        if (DateTime.Parse(dt4.Rows[w][1].ToString()).ToString("HH:mm") == DateTime.Parse(dt4.Rows[t][1].ToString()).ToString("HH:mm"))
                                        {
                                            hora = DateTime.Parse(horas).AddMinutes(1).ToString("HH:mm");
                                        }
                                        else
                                        {
                                            hora = DateTime.Parse(horas).ToString("HH:mm");
                                        }
                                    }
                                    else
                                    {
                                        hora = DateTime.Parse(horas).ToString("HH:mm");
                                    }
                                    //tipo = dt4.Rows[w][2].ToString();
                                    string transmissao = dt4.Rows[w][3].ToString();


                                    //if (dt4.Rows[w][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[w][2].ToString() == "TRECHO ALMOÇO" || dt4.Rows[w][2].ToString() == "FIM DE JORNADA")
                                    //{
                                    //    tipo = "2";
                                    //}
                                    //else  if (dt4.Rows[w][2].ToString() == "PARADA FORNECEDOR" || dt4.Rows[w][2].ToString() == "REINICIO DE VIAGEM")
                                    //{
                                    //    tipo = "21";
                                    //}






                                    StreamWriter write = new StreamWriter(caminho + arquivo, true);




                                    #region BLOCO INICIO JORNADA
                                    //BLOCO INICIO JORNADA
                                    if (dt4.Rows[w][2].ToString() == "INICIO DE JORNADA")
                                    {
                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");
                                    }

                                    if (dt4.Rows[w][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[w][2].ToString() == "INICIO JORNADA")
                                    {

                                        int a = 0;
                                        a = w - 1;
                                        if (a >= 0)
                                        {
                                            if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                            {
                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");

                                            }
                                            else
                                            {
                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");

                                            }
                                        }
                                        else
                                        {
                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                        }


                                    }
                                    //FIM
                                    #endregion

                                    #region BLOCO INICIO JORNADA CAMINHAO
                                    //BLOCO INICIO JORNADA CAMINHAO

                                    if (dt4.Rows[w][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[w][2].ToString() == "INICIO JORNADA")
                                    {

                                        int a = 0;
                                        a = w - 1;
                                        if (a >= 0)
                                        {
                                            if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                            {
                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");

                                            }
                                            else
                                            {
                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");
                                            }
                                        }
                                        else
                                        {
                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                        }


                                    }
                                    //FIM
                                    #endregion

                                    #region PARADA INTERNA
                                    //BLOCO PARADA INTERNA
                                    if (dt4.Rows[w][2].ToString() == "PARADA INTERNA")
                                    {
                                        if (dt4.Rows[w][5].ToString() == "3" || dt4.Rows[w][5].ToString() == "2")
                                        {
                                            int a = 0;
                                            a = w - 1;
                                            if (a >= 0)
                                            {
                                                if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                }
                                                else if (dt4.Rows[a][5].ToString() == "14")
                                                {
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                }
                                                else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "1")
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                }
                                                else if (dt4.Rows[a][2].ToString() == "PARADA REFEICAO")
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                }
                                                else if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM")
                                                {
                                                    //////write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    ////write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    ////write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                }
                                                else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                }
                                                else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                }
                                                else
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                }

                                            }

                                        }
                                        else if (dt4.Rows[w][5].ToString() == "14")
                                        {
                                            int a = 0;
                                            a = w - 1;
                                            if (a >= 0)
                                            {
                                                if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                {
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                }
                                                if (dt4.Rows[a][5].ToString() == "14")
                                                {
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                }
                                                else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "1")
                                                {
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                }
                                                else if (dt4.Rows[a][2].ToString() == "PARADA REFEICAO")
                                                {
                                                    // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                }
                                                else if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                {
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                }
                                                else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                {

                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");

                                                }
                                                if (dt4.Rows[a][5].ToString() == "22")
                                                {
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                }
                                                //else
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93: 71489");
                                                //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                //}

                                            }
                                        }
                                        else if (dt4.Rows[w][5].ToString() == "22")
                                        {
                                            int a = 0;
                                            a = w - 1;
                                            if (a >= 0)
                                            {

                                                if (dt4.Rows[a][5].ToString() == "14")
                                                {
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                }


                                            }
                                        }
                                        else
                                        {
                                            int a = 0;
                                            a = w - 1;
                                            if (a >= 0)
                                            {
                                                if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");
                                                }
                                                if (dt4.Rows[a][5].ToString() == "14")
                                                {
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                }

                                                else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "1")
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");
                                                }
                                                else if (dt4.Rows[a][2].ToString() == "PARADA REFEICAO")
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                    //// write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                }
                                                else if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                {

                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");
                                                }
                                                else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                {

                                                    //// write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");

                                                }

                                            }
                                        }

                                    }
                                    //FIM 
                                    #endregion

                                    #region BLOCO PARADA REFEIÇÃO
                                    //BLOCO PARADA REFEIÇÃO
                                    if (dt4.Rows[w][2].ToString() == "PARADA REFEICAO")
                                    {
                                        int a = 0;
                                        a = w - 1;
                                        if (a >= 0)
                                        {
                                            //if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                            //{

                                            //    if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                            //    {
                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;93");
                                            //    }
                                            //    else
                                            //    {
                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;93");
                                            //    }
                                            //}
                                            if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                            {
                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");

                                            }
                                            else
                                            {
                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                            }

                                        }
                                        //else
                                        //{
                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;93");
                                        //}
                                    }
                                    //FIM
                                    #endregion

                                    #region RETORNO REFEIÇAO
                                    //BLOCO RETORNO REFEIÇAO
                                    if (dt4.Rows[w][2].ToString() == "RETORNO REFEICAO")
                                    {

                                        int a = 0;
                                        int b = 0;
                                        a = w - 1;
                                        b = w + 1;
                                        if (a >= 0)
                                        {

                                            if (dt4.Rows[a][2].ToString() == "PARADA REFEICAO")
                                            {

                                                // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;0102");
                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");

                                            }
                                            //if (dt4.Rows[b][2].ToString() == "FIM DE JORNADA")
                                            //{
                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                            //}
                                            //else
                                            //{
                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                            //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");

                                            //}
                                        }


                                    }
                                    //FIM
                                    #endregion

                                    #region INICIO DE VIAGEM
                                    //BLOCO REINICIO / INICIO DE VIAGEM
                                    if (dt4.Rows[w][2].ToString() == "INICIO DE VIAGEM")
                                    {
                                        int a = 0;
                                        a = w - 1;
                                        if (a >= 0)
                                        {
                                            //if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                            //{
                                            //    if (dt4.Rows[a][5].ToString() == "14")
                                            //    {
                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");

                                            //    }
                                            //    else
                                            //        if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                            //    {
                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");

                                            //    }
                                            //    else
                                            //    {
                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                            //    }
                                            //}
                                            //if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                            //{
                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                            //}
                                            //else if (dt4.Rows[a][2].ToString() == "PARADA PERNOITE")
                                            //{
                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;22");
                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                            //}
                                            //else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                            //{
                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                            //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                            //}

                                            if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                            {


                                                if (dt4.Rows[a][5].ToString() == "14")
                                                {

                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");



                                                }
                                                //else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "1" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "4")
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                //}



                                            }
                                            else if (dt4.Rows[a][2].ToString() == "PARADA")
                                            {


                                                if (dt4.Rows[a][5].ToString() == "14")
                                                {

                                                    // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                }
                                                //else
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");



                                                //}



                                            }
                                            //else if (dt4.Rows[a][2].ToString() == "RETORNO REFEICAO")
                                            //{
                                            //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                            //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                            //    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");

                                            //}

                                        }
                                        //else
                                        //{
                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                        //}



                                    }
                                    //FIM
                                    #endregion

                                    #region PARADA CLIENTE / FORNECEDOR
                                    if (dt4.Rows[w][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                    {
                                        if (dt4.Rows[w][5].ToString() == "3" || dt4.Rows[w][5].ToString() == "2" || dt4.Rows[w][5].ToString() == "4")
                                        {
                                            int a = 0;
                                            a = w - 1;
                                            if (a >= 0)
                                            {
                                                //if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                //}
                                                if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                {
                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;0102");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");


                                                    }
                                                    //else if (dt4.Rows[a][5].ToString() == "15")
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");

                                                    //}
                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                    //}

                                                }
                                            }

                                        }
                                        else if (dt4.Rows[w][5].ToString() == "14")
                                        {
                                            int a = 0;
                                            a = w - 1;
                                            if (a >= 0)
                                            {
                                                if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                    // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                }
                                                else if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                {
                                                    if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "4")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                    }
                                                    else if (dt4.Rows[a][5].ToString() == "14")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");

                                                    }


                                                }
                                                else
                                                {
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                }

                                            }


                                        }


                                    }
                                    #endregion

                                    #region REINICIO
                                    //BLOCO REINICIO / INICIO DE VIAGEM
                                    if (dt4.Rows[w][2].ToString() == "REINICIO DE VIAGEM")
                                    {
                                        int a = 0;
                                        a = w - 1;
                                        if (a >= 0)
                                        {
                                            if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                            {

                                            }
                                            else if (dt4.Rows[a][2].ToString() == "PARADA PERNOITE")
                                            {
                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                            }

                                            else if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                            {

                                                if (a >= 0)
                                                {

                                                    if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                    {
                                                        //if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                        //}
                                                        if (dt4.Rows[a][5].ToString() == "14")
                                                        {

                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");

                                                        }
                                                        //else if (dt4.Rows[a][5].ToString() == "15")
                                                        //{

                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");

                                                        //}
                                                        //else
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                        //}
                                                    }
                                                    //else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                    //}


                                                }



                                            }
                                            else if (dt4.Rows[a][2].ToString() == "PARADA")
                                            {
                                                if (dt4.Rows[a][5].ToString() == "14")
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                }
                                                //else
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                //}




                                            }
                                            //else if (dt4.Rows[a][2].ToString() == "OFICINA / MANUTENCAO")
                                            //{

                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");


                                            //}

                                        }
                                        else
                                        {
                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");
                                            // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                        }



                                    }
                                    //FIM
                                    #endregion

                                    #region BLOCO PARADA
                                    // BLOCO PARADA
                                    if (dt4.Rows[w][2].ToString() == "PARADA")
                                    {
                                        int a = 0;
                                        a = w - 1;


                                        if (dt4.Rows[w][5].ToString() == "14")
                                        {
                                            if (dt4.Rows.Count >= a)
                                            {
                                                if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                {
                                                    // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");


                                                }

                                            }
                                        }
                                        //else
                                        //{
                                        //    if (dt4.Rows.Count >= a)
                                        //    {
                                        //        if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                        //        {
                                        //            write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                        //            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");

                                        //        }
                                        //        //else
                                        //        //{
                                        //        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                        //        //    // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                        //        //}
                                        //    }
                                        //}



                                        //  write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");

                                    }
                                    //FIM
                                    #endregion

                                    #region FIM DE VIAGEM
                                    //BLOCO FIM DE VIAGEM
                                    if (dt4.Rows[w][2].ToString() == "FIM DE VIAGEM")
                                    {
                                        int a = 0;
                                        int g = 0;
                                        a = w - 1;
                                        g = w - 2;
                                        if (a >= 0)
                                        {
                                            if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                            {


                                                if (dt4.Rows[a][5].ToString() == "14")
                                                {

                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;0102");

                                                }

                                                //else if (dt4.Rows[a][5].ToString() == "14")
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                //    // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                //}

                                                //else
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                //    // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                //}



                                            }
                                            else if (dt4.Rows[a][2].ToString() == "PARADA")
                                            {


                                                if (dt4.Rows[a][5].ToString() == "14")
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;0102");

                                                }

                                                //else
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                //    // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");

                                                //}


                                            }

                                            else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                            {
                                                if (g >= 0)
                                                {
                                                    //if (dt4.Rows[g][2].ToString() == "PARADA PERNOITE")
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                    //}
                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //}
                                                }
                                                //else
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                //}


                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                            }


                                        }
                                        //else
                                        //{
                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                        //}

                                    }

                                    //
                                    #endregion

                                    #region FIM DE JORNADA
                                    //BLOCO FIM DE JORMADA
                                    if (c > 0)
                                    {
                                        if (dt4.Rows[w][2].ToString() == "FIM DE JORNADA" && dt4.Rows[w][6].ToString() == "725405" || dt4.Rows[w][2].ToString() == "FIM DE JORNADA" && dt4.Rows[w][6].ToString() == "725407" || dt4.Rows[w][2].ToString() == "FIM DE JORNADA" && dt4.Rows[w][6].ToString() == "184525" && dt4.Rows[w][6].ToString() == "184522")
                                        {
                                            int a = 0;
                                            a = w - 1;

                                            if (a >= 0)
                                            {
                                                if (dt4.Rows[a][2].ToString() == "RETORNO REFEICAO")
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                }
                                                else if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                {

                                                    //WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");


                                                }
                                                else if (dt4.Rows[a][2].ToString() == "RETORNO REFEICAO")
                                                {

                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");

                                                }
                                                else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                {
                                                    int b = 0;
                                                    b = a - 1;

                                                    if (b >= 0)
                                                    {
                                                        if (dt4.Rows[b][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[b][2].ToString() == "REINICIO DE VIAGEM")
                                                        {
                                                            int d = 0;
                                                            d = b - 1;
                                                            if (d >= 0)
                                                            {

                                                                if (dt4.Rows[d][2].ToString() == "PARADA")
                                                                {
                                                                    if (dt4.Rows[d][5].ToString() == "14")
                                                                    {
                                                                        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                    }
                                                                    else
                                                                    {
                                                                        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                        // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                    }




                                                                }
                                                                else
                                                                {
                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                    // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                }
                                                            }
                                                        }
                                                        else
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                        }

                                                    }
                                                    else
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                    }

                                                }
                                                else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                }
                                                else if (dt4.Rows[a][2].ToString() == "PARADA")
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                }
                                                else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                {
                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                    }
                                                    else
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                    }
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");

                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                }
                                                else if (dt4.Rows[a][2].ToString() == "FIM DE JORNADA")
                                                {
                                                    int m = 0;
                                                    m = a - 1;

                                                    if (m >= 0)
                                                    {
                                                        if (dt4.Rows[m][2].ToString() == "RETORNO REFEICAO" || dt4.Rows[m][2].ToString() == "INICIO DE JORNADA")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        }
                                                        else if (dt4.Rows[m][2].ToString() == "FIM DE VIAGEM")
                                                        {
                                                            int b = 0;
                                                            b = m - 1;

                                                            if (b >= 0)
                                                            {
                                                                if (dt4.Rows[b][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[b][2].ToString() == "REINICIO DE VIAGEM")
                                                                {
                                                                    int d = 0;
                                                                    d = b - 1;
                                                                    if (d >= 0)
                                                                    {

                                                                        if (dt4.Rows[d][2].ToString() == "PARADA")
                                                                        {
                                                                            if (dt4.Rows[d][5].ToString() == "14")
                                                                            {
                                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                                //.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                            }
                                                                            else
                                                                            {
                                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                                            }


                                                                        }
                                                                        else
                                                                        {
                                                                            // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                        }
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                }

                                                            }


                                                        }
                                                        //else if (dt4.Rows[m][2].ToString() == "REINICIO DE VIAGEM")
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //}
                                                        //else if (dt4.Rows[m][2].ToString() == "PARADA INTERNA")
                                                        //{
                                                        //    if (dt4.Rows[m][5].ToString() == "3" || dt4.Rows[m][5].ToString() == "1" || dt4.Rows[m][5].ToString() == "2")
                                                        //    {
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");

                                                        //    }
                                                        //    else if (dt4.Rows[m][5].ToString() == "22")
                                                        //    {
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                        //    }

                                                        //    else if (dt4.Rows[m][2].ToString() == "FIM DE JORNADA")
                                                        //    {
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //        write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                        //    }

                                                        //}
                                                        else if (dt4.Rows[m][2].ToString() == "PARADA")
                                                        {
                                                            // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                        }
                                                        //else if (dt4.Rows[m][2].ToString() == "PARADA INTERNA")
                                                        //{
                                                        //    if (dt4.Rows[m][5].ToString() != "3" || dt4.Rows[m][5].ToString() != "1" || dt4.Rows[m][5].ToString() != "2")
                                                        //    {
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                        //        write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                        //    }

                                                        //}

                                                        else
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                        }


                                                    }
                                                    else
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                    }
                                                }
                                                else
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                }


                                            }
                                            else
                                            {
                                                // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                            }
                                        }

                                    }
                                    else
                                    {
                                        if (dt4.Rows[w][2].ToString() == "FIM DE JORNADA")
                                        {
                                            int q = 0;
                                            q = w + 1;

                                            if (q < dt4.Rows.Count)
                                            {
                                                if (dt4.Rows[q][2].ToString() == "FIM DE JORNADA")
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                }
                                                else
                                                {
                                                    int a = 0;
                                                    a = w - 1;

                                                    if (a >= 0)
                                                    {

                                                        if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM" || dt4.Rows[a][2].ToString() == "RETORNO REFEICAO" || dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                        }
                                                        //else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                        //{
                                                        //    if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                        //    {
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                        //        // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                        //        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //    }
                                                        //    else if (dt4.Rows[a][5].ToString() == "14")
                                                        //    {
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //        write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                        //    }
                                                        //    else
                                                        //    {
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");


                                                        //    }
                                                        //}
                                                        else if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                        {

                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "FIM DE JORNADA")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                        }
                                                        else
                                                        {
                                                            // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                        }
                                                    }
                                                }

                                            }
                                            else
                                            {
                                                int a = 0;
                                                a = w - 1;

                                                if (a >= 0)
                                                {

                                                    if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");

                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "RETORNO REFEICAO")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");

                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                    {
                                                        if (dt4.Rows[a][5].ToString() == "14")
                                                        {
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                        }
                                                        else
                                                        {
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        }
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");

                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                    }
                                                    //else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                    //{
                                                    //    if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                    //    {
                                                    //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                    //        // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                    //        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //    }
                                                    //    else if (dt4.Rows[a][5].ToString() == "14")
                                                    //    {
                                                    //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //        write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                    //    }
                                                    //    else
                                                    //    {
                                                    //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");

                                                    //    }
                                                    //}
                                                    else if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                    {

                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "FIM DE JORNADA")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");

                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                    }
                                                    else
                                                    {
                                                        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                    }
                                                }
                                                else
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                }
                                            }
                                        }





                                    }


                                    #endregion

                                    #region PARADA PERNOITE

                                    if (dt4.Rows[w][2].ToString() == "PARADA PERNOITE")
                                    {
                                        int a = 0;
                                        a = w - 1;


                                        if (a >= 0)
                                        {
                                            if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                            {


                                                if (dt4.Rows[a][5].ToString() == "14")
                                                {

                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                    //WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;0102");
                                                    write.WriteLine("+00" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm").Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");


                                                }
                                                else if (dt4.Rows[a][5].ToString() == "15")
                                                {

                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;22");


                                                }
                                                //else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");
                                                //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                //}
                                                //else
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;22");
                                                //}



                                            }
                                            else if (dt4.Rows[a][2].ToString() == "PARADA")
                                            {
                                                //if (dt4.Rows[a][5].ToString() == "7")
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");
                                                //}
                                                if (dt4.Rows[a][5].ToString() == "14")
                                                {

                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                    //WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;0102");
                                                    write.WriteLine("+00" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm").Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");


                                                }
                                                else
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                }

                                            }
                                            else if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM")
                                            {
                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";2;22");
                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";3;22");
                                            }
                                            else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                            {
                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                // write.WriteLine(cracha + ";" + data + ";" + hora + ";3;22");
                                            }
                                            //else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                            //{


                                            //    if (dt4.Rows[a][5].ToString() == "14")
                                            //    {

                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                            //        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");


                                            //    }
                                            //    //else if (dt4.Rows[a][5].ToString() == "15")
                                            //    //{

                                            //    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                            //    //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");


                                            //    //}
                                            //    else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                            //    {
                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                            //        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");
                                            //        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                            //    }
                                            //    //else
                                            //    //{
                                            //    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;22");
                                            //    //}



                                            //}
                                            //else
                                            //{
                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;22");
                                            //}

                                        }
                                        //else
                                        //{
                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;22");
                                        //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");

                                        //}

                                    }

                                    #endregion



                                    write.Flush();
                                    write.Close();



                                }

                                //FIM

                                #endregion

                            }
                            else
                            {
                                //JORNADA PERNOITE INICIO DE JORNADA
                                string sqli = "select top 1  hr_posicao from tb_parada where cod_cracha=" + dt1.Rows[x][0].ToString() + " and ds_macro = 'INICIO DE JORNADA' and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).ToString("yyyy-MM-dd") + "' and fl_deletado is null order by hr_posicao";
                                //string sqli = "select top 1  hr_posicao from tb_parada where cod_cracha=" + dt1.Rows[x][0].ToString() + " and ds_macro = 'INICIO DE JORNADA' and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).ToString("yyyy-MM-dd") + "' and fl_deletado is null or cod_cracha=" + dt1.Rows[x][0].ToString() + "  and fl_deletado is null order by hr_posicao";
                                SqlDataAdapter adtpi = new SqlDataAdapter(sqli, con);
                                DataTable dti = new DataTable();
                                con.Open();
                                adtpi.Fill(dti);
                                con.Close();

                                string sqlf = "select top 1 hr_posicao from tb_parada where cod_cracha=" + dt1.Rows[x][0].ToString() + " and ds_macro = 'FIM DE JORNADA' and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).AddDays(1).ToString("yyyy-MM-dd") + "' and fl_deletado is null OR cod_cracha=" + dt1.Rows[x][0].ToString() + " and ds_macro='PARADA PERNOITE' and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).AddDays(1).ToString("yyyy-MM-dd") + "' and fl_deletado is null order by hr_posicao";
                                //string sqlf = "select top 1 hr_posicao from tb_parada where cod_cracha=" + dt1.Rows[x][0].ToString() + " and ds_macro = 'FIM DE JORNADA' and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).AddDays(1).ToString("yyyy-MM-dd") + "' and fl_deletado is null OR cod_cracha=" + dt1.Rows[x][0].ToString() + " and ds_macro='PARADA PERNOITE' and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).AddDays(1).ToString("yyyy-MM-dd") + "' and fl_deletado is null OR cod_cracha=" + dt1.Rows[x][0].ToString() + " and ds_macro='REINICIO DE VIAGEM' and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).AddDays(1).ToString("yyyy-MM-dd") + "' and fl_deletado is null order by hr_posicao";
                                SqlDataAdapter adtpf = new SqlDataAdapter(sqlf, con);
                                DataTable dtf = new DataTable();
                                con.Open();
                                adtpf.Fill(dtf);
                                con.Close();



                                if (dti.Rows.Count > 0 && dtf.Rows.Count > 0)
                                {
                                    #region Jornada Noturna


                                    //sql4 = "select dt_posicao_parada, hr_posicao, ds_macro,cod_transmissao, cod_cracha, isnull(cod_ref_parada,0) as cod_ref_parada, cod_idveiculo from tb_parada where fl_deletado is null and cod_cracha=" + dt1.Rows[x][0].ToString() + " and dt_posicao_parada='" + txtDtInicial.Text + "' order by dt_posicao_parada, hr_posicao";
                                    sql4 = "select dt_posicao_parada, hr_posicao, ds_macro,cod_transmissao, cod_cracha, isnull(cod_ref_parada,0) as cod_ref_parada, cod_idveiculo from tb_parada where fl_deletado is null and cod_cracha=" + dt1.Rows[x][0].ToString() + " and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).ToString("yyyy-MM-dd") + "' and hr_posicao >='" + dti.Rows[0][0].ToString() + "' or cod_cracha=" + dt1.Rows[x][0].ToString() + " and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).AddDays(1).ToString("yyyy-MM-dd") + "' and hr_posicao <= '" + dtf.Rows[0][0].ToString() + "' AND (ds_macro IN ('INICIO DE JORNADA', 'INICIO JORNADA CAMINHAO', 'PARADA REFEICAO', 'FIM DE JORNADA','REINICIO DE VIAGEM','FIM DE VIAGEM', 'PARADA','PARADA INTERNA','INICIO DE VIAGEM','PARADA INTERNA','RETORNO REFEICAO','PARADA CLIENTE / FORNECEDOR') OR cod_ref_parada in (2,3,4,14,22)) AND fl_deletado IS NULL ORDER BY dt_posicao_parada, hr_posicao";
                                    // string sql4 = "select dt_posicao_parada, hr_posicao, ds_macro,cod_transmissao, cod_cracha, isnull(cod_ref_parada,0) as cod_ref_parada, cod_idveiculo from tb_parada where fl_deletado is null and cod_cracha=" + dt1.Rows[x][0].ToString() + " and dt_posicao_parada between '" + txtDtInicial.Text + "' and '" + txtDtFinal.Text + "' order by dt_posicao_parada, hr_posicao";
                                    SqlDataAdapter adtp4 = new SqlDataAdapter(sql4, con);
                                    DataTable dt4 = new DataTable();

                                    try
                                    {
                                        con.Open();
                                        adtp4.Fill(dt4);
                                        con.Close();
                                    }
                                    catch (Exception ed)
                                    {
                                        //MessageBox.Show(ed.ToString(), "Erro3");
                                    }

                                    c = 0;

                                    for (int y = 0; y < dt4.Rows.Count; y++)
                                    {
                                        if (dt4.Rows[y][2].ToString() == "FIM DE JORNADA" && dt4.Rows[y][6].ToString() == "725405" || dt4.Rows[y][2].ToString() == "FIM DE JORNADA" && dt4.Rows[y][6].ToString() == "725407" || dt4.Rows[y][2].ToString() == "FIM DE JORNADA" && dt4.Rows[y][6].ToString() == "184525")
                                        {
                                            c = c + 1;
                                        }

                                    }
                                    string caminho = Server.MapPath("/TXT/");

                                    string filepath = caminho + arquivo;

                                    FileInfo file = new FileInfo(filepath);
                                    //if(file.Exists)
                                    //{
                                    //    file.Delete();
                                    //}



                                    for (int w = 0; w < dt4.Rows.Count; w++)
                                    {

                                        string codigo = dt1.Rows[x][0].ToString();
                                        string[] codigosEspeciais = { "330", "482", "820", "958", "989" };

                                        if (codigo.StartsWith("312"))
                                        {
                                            cracha = codigo.Insert(3, "0");
                                        }
                                        else if ((codigosEspeciais.Contains(codigo) || codigo.Length <= 4))
                                        {
                                            cracha = "30" + codigo;
                                        }
                                        else if (codigo.Length <= 3)
                                        {
                                            cracha = "300" + codigo;
                                        }

                                        else
                                        {
                                            cracha = codigo;
                                        }

                                        int t = 0;
                                        t = w - 1;

                                        string data = DateTime.Parse(dt4.Rows[w][0].ToString()).ToString("dd/MM/yy");
                                        string horas = DateTime.Parse(dt4.Rows[w][1].ToString()).ToString("HH:mm");
                                        if (t >= 0)
                                        {
                                            if (DateTime.Parse(dt4.Rows[w][1].ToString()).ToString("HH:mm") == DateTime.Parse(dt4.Rows[t][1].ToString()).ToString("HH:mm"))
                                            {
                                                hora = DateTime.Parse(horas).AddMinutes(1).ToString("HH:mm");
                                            }
                                            else
                                            {
                                                hora = DateTime.Parse(horas).ToString("HH:mm");
                                            }
                                        }
                                        else
                                        {
                                            hora = DateTime.Parse(horas).ToString("HH:mm");
                                        }
                                        //tipo = dt4.Rows[w][2].ToString();
                                        string transmissao = dt4.Rows[w][3].ToString();


                                        //if (dt4.Rows[w][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[w][2].ToString() == "TRECHO ALMOÇO" || dt4.Rows[w][2].ToString() == "FIM DE JORNADA")
                                        //{
                                        //    tipo = "2";
                                        //}
                                        //else  if (dt4.Rows[w][2].ToString() == "PARADA FORNECEDOR" || dt4.Rows[w][2].ToString() == "REINICIO DE VIAGEM")
                                        //{
                                        //    tipo = "21";
                                        //}



                                        StreamWriter write = new StreamWriter(caminho + arquivo, true);

                                        #region BLOCO INICIO JORNADA
                                        //BLOCO INICIO JORNADA
                                        if (dt4.Rows[w][2].ToString() == "INICIO DE JORNADA")
                                        {
                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");
                                        }

                                        if (dt4.Rows[w][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[w][2].ToString() == "INICIO JORNADA")
                                        {

                                            int a = 0;
                                            a = w - 1;
                                            if (a >= 0)
                                            {
                                                if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");

                                                }
                                                else
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");

                                                }
                                            }
                                            else
                                            {
                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                            }


                                        }
                                        //FIM
                                        #endregion

                                        #region BLOCO INICIO JORNADA CAMINHAO
                                        //BLOCO INICIO JORNADA CAMINHAO

                                        if (dt4.Rows[w][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[w][2].ToString() == "INICIO JORNADA")
                                        {

                                            int a = 0;
                                            a = w - 1;
                                            if (a >= 0)
                                            {
                                                if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");

                                                }
                                                else
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");
                                                }
                                            }
                                            else
                                            {
                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                            }


                                        }
                                        //FIM
                                        #endregion

                                        #region PARADA INTERNA
                                        //BLOCO PARADA INTERNA
                                        if (dt4.Rows[w][2].ToString() == "PARADA INTERNA")
                                        {
                                            if (dt4.Rows[w][5].ToString() == "3" || dt4.Rows[w][5].ToString() == "2")
                                            {
                                                int a = 0;
                                                a = w - 1;
                                                if (a >= 0)
                                                {
                                                    if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                    }
                                                    else if (dt4.Rows[a][5].ToString() == "14")
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                    }
                                                    else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "1")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "PARADA REFEICAO")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM")
                                                    {
                                                        //////write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        ////write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        ////write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                    }
                                                    else
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                    }

                                                }

                                            }
                                            else if (dt4.Rows[w][5].ToString() == "14")
                                            {
                                                int a = 0;
                                                a = w - 1;
                                                if (a >= 0)
                                                {
                                                    if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                    }
                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                    }
                                                    else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "1")
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "PARADA REFEICAO")
                                                    {
                                                        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                    {

                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");

                                                    }
                                                    if (dt4.Rows[a][5].ToString() == "22")
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                    }
                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93: 71489");
                                                    //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                    //}

                                                }
                                            }
                                            else if (dt4.Rows[w][5].ToString() == "22")
                                            {
                                                int a = 0;
                                                a = w - 1;
                                                if (a >= 0)
                                                {

                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                    }


                                                }
                                            }
                                            else
                                            {
                                                int a = 0;
                                                a = w - 1;
                                                if (a >= 0)
                                                {
                                                    if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");
                                                    }
                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                    }

                                                    else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "1")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "PARADA REFEICAO")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                        //// write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                    {

                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                    {

                                                        //// write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");

                                                    }

                                                }
                                            }

                                        }
                                        //FIM 
                                        #endregion

                                        #region BLOCO PARADA REFEIÇÃO
                                        //BLOCO PARADA REFEIÇÃO
                                        if (dt4.Rows[w][2].ToString() == "PARADA REFEICAO")
                                        {
                                            int a = 0;
                                            a = w - 1;
                                            if (a >= 0)
                                            {
                                                //if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                //{

                                                //    if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                //    {
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;93");
                                                //    }
                                                //    else
                                                //    {
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;93");
                                                //    }
                                                //}
                                                if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");

                                                }
                                                else
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                }

                                            }
                                            //else
                                            //{
                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;93");
                                            //}
                                        }
                                        //FIM
                                        #endregion

                                        #region RETORNO REFEIÇAO
                                        //BLOCO RETORNO REFEIÇAO
                                        if (dt4.Rows[w][2].ToString() == "RETORNO REFEICAO")
                                        {

                                            int a = 0;
                                            int b = 0;
                                            a = w - 1;
                                            b = w + 1;
                                            if (a >= 0)
                                            {

                                                if (dt4.Rows[a][2].ToString() == "PARADA REFEICAO")
                                                {

                                                    // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;0102");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");

                                                }
                                                //if (dt4.Rows[b][2].ToString() == "FIM DE JORNADA")
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                //}
                                                //else
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");

                                                //}
                                            }


                                        }
                                        //FIM
                                        #endregion

                                        #region INICIO DE VIAGEM
                                        //BLOCO REINICIO / INICIO DE VIAGEM
                                        if (dt4.Rows[w][2].ToString() == "INICIO DE VIAGEM")
                                        {
                                            int a = 0;
                                            a = w - 1;
                                            if (a >= 0)
                                            {
                                                //if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                //{
                                                //    if (dt4.Rows[a][5].ToString() == "14")
                                                //    {
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");

                                                //    }
                                                //    else
                                                //        if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                //    {
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");

                                                //    }
                                                //    else
                                                //    {
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                //    }
                                                //}
                                                //if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                //}
                                                //else if (dt4.Rows[a][2].ToString() == "PARADA PERNOITE")
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;22");
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                //}
                                                //else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                //}

                                                if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                {


                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {

                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");



                                                    }
                                                    //else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "1" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "4")
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                    //}



                                                }
                                                else if (dt4.Rows[a][2].ToString() == "PARADA")
                                                {


                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {

                                                        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                    }
                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");



                                                    //}



                                                }
                                                //else if (dt4.Rows[a][2].ToString() == "RETORNO REFEICAO")
                                                //{
                                                //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                //    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");

                                                //}

                                            }
                                            //else
                                            //{
                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                            //}



                                        }
                                        //FIM
                                        #endregion

                                        #region PARADA CLIENTE / FORNECEDOR
                                        if (dt4.Rows[w][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                        {
                                            if (dt4.Rows[w][5].ToString() == "3" || dt4.Rows[w][5].ToString() == "2" || dt4.Rows[w][5].ToString() == "4")
                                            {
                                                int a = 0;
                                                a = w - 1;
                                                if (a >= 0)
                                                {
                                                    //if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                    //}
                                                    if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                    {
                                                        if (dt4.Rows[a][5].ToString() == "14")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;0102");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");


                                                        }
                                                        //else if (dt4.Rows[a][5].ToString() == "15")
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");

                                                        //}
                                                        //else
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                        //}

                                                    }
                                                }

                                            }
                                            else if (dt4.Rows[w][5].ToString() == "14")
                                            {
                                                int a = 0;
                                                a = w - 1;
                                                if (a >= 0)
                                                {
                                                    if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                    {
                                                        if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "4")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                        }
                                                        else if (dt4.Rows[a][5].ToString() == "14")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");

                                                        }


                                                    }
                                                    else
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                    }

                                                }


                                            }


                                        }
                                        #endregion

                                        #region REINICIO
                                        //BLOCO REINICIO / INICIO DE VIAGEM
                                        if (dt4.Rows[w][2].ToString() == "REINICIO DE VIAGEM")
                                        {
                                            int a = 0;
                                            a = w - 1;
                                            if (a >= 0)
                                            {
                                                if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                {

                                                }
                                                else if (dt4.Rows[a][2].ToString() == "PARADA PERNOITE")
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                }

                                                else if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                {

                                                    if (a >= 0)
                                                    {

                                                        if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                        {
                                                            //if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                            //}
                                                            if (dt4.Rows[a][5].ToString() == "14")
                                                            {

                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");

                                                            }
                                                            //else if (dt4.Rows[a][5].ToString() == "15")
                                                            //{

                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");

                                                            //}
                                                            //else
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                            //}
                                                        }
                                                        //else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                        //}


                                                    }



                                                }
                                                else if (dt4.Rows[a][2].ToString() == "PARADA")
                                                {
                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                    }
                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                    //}




                                                }
                                                //else if (dt4.Rows[a][2].ToString() == "OFICINA / MANUTENCAO")
                                                //{

                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");


                                                //}

                                            }
                                            else
                                            {
                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");
                                                // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                            }



                                        }
                                        //FIM
                                        #endregion

                                        #region BLOCO PARADA
                                        // BLOCO PARADA
                                        if (dt4.Rows[w][2].ToString() == "PARADA")
                                        {
                                            int a = 0;
                                            a = w - 1;


                                            if (dt4.Rows[w][5].ToString() == "14")
                                            {
                                                if (dt4.Rows.Count >= a)
                                                {
                                                    if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                    {
                                                        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");


                                                    }

                                                }
                                            }
                                            //else
                                            //{
                                            //    if (dt4.Rows.Count >= a)
                                            //    {
                                            //        if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                            //        {
                                            //            write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                            //            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");

                                            //        }
                                            //        //else
                                            //        //{
                                            //        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                            //        //    // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                            //        //}
                                            //    }
                                            //}



                                            //  write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");

                                        }
                                        //FIM
                                        #endregion

                                        #region FIM DE VIAGEM
                                        //BLOCO FIM DE VIAGEM
                                        if (dt4.Rows[w][2].ToString() == "FIM DE VIAGEM")
                                        {
                                            int a = 0;
                                            int g = 0;
                                            a = w - 1;
                                            g = w - 2;
                                            if (a >= 0)
                                            {
                                                if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                {


                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {

                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;0102");

                                                    }

                                                    //else if (dt4.Rows[a][5].ToString() == "14")
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                    //    // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                    //}

                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //    // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                    //}



                                                }
                                                else if (dt4.Rows[a][2].ToString() == "PARADA")
                                                {


                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;0102");

                                                    }

                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //    // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");

                                                    //}


                                                }

                                                else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                {
                                                    if (g >= 0)
                                                    {
                                                        //if (dt4.Rows[g][2].ToString() == "PARADA PERNOITE")
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                        //}
                                                        //else
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //}
                                                    }
                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //}


                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                }


                                            }
                                            //else
                                            //{
                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                            //}

                                        }

                                        //
                                        #endregion

                                        #region FIM DE JORNADA
                                        //BLOCO FIM DE JORMADA
                                        if (c > 0)
                                        {
                                            if (dt4.Rows[w][2].ToString() == "FIM DE JORNADA" && dt4.Rows[w][6].ToString() == "725405" || dt4.Rows[w][2].ToString() == "FIM DE JORNADA" && dt4.Rows[w][6].ToString() == "725407" || dt4.Rows[w][2].ToString() == "FIM DE JORNADA" && dt4.Rows[w][6].ToString() == "184525")
                                            {
                                                int a = 0;
                                                a = w - 1;

                                                if (a >= 0)
                                                {
                                                    if (dt4.Rows[a][2].ToString() == "RETORNO REFEICAO")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                    {

                                                        //WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");


                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "RETORNO REFEICAO")
                                                    {

                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");

                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                    {
                                                        int b = 0;
                                                        b = a - 1;

                                                        if (b >= 0)
                                                        {
                                                            if (dt4.Rows[b][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[b][2].ToString() == "REINICIO DE VIAGEM")
                                                            {
                                                                int d = 0;
                                                                d = b - 1;
                                                                if (d >= 0)
                                                                {

                                                                    if (dt4.Rows[d][2].ToString() == "PARADA")
                                                                    {
                                                                        if (dt4.Rows[d][5].ToString() == "14")
                                                                        {
                                                                            // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                        }
                                                                        else
                                                                        {
                                                                            // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                            // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                        }




                                                                    }
                                                                    else
                                                                    {
                                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                        // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                    }
                                                                }
                                                            }
                                                            else
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            }

                                                        }
                                                        else
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                        }

                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "PARADA")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                    {
                                                        if (dt4.Rows[a][5].ToString() == "14")
                                                        {
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                        }
                                                        else
                                                        {
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        }
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");

                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "FIM DE JORNADA")
                                                    {
                                                        int m = 0;
                                                        m = a - 1;

                                                        if (m >= 0)
                                                        {
                                                            if (dt4.Rows[m][2].ToString() == "RETORNO REFEICAO" || dt4.Rows[m][2].ToString() == "INICIO DE JORNADA")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            }
                                                            else if (dt4.Rows[m][2].ToString() == "FIM DE VIAGEM")
                                                            {
                                                                int b = 0;
                                                                b = m - 1;

                                                                if (b >= 0)
                                                                {
                                                                    if (dt4.Rows[b][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[b][2].ToString() == "REINICIO DE VIAGEM")
                                                                    {
                                                                        int d = 0;
                                                                        d = b - 1;
                                                                        if (d >= 0)
                                                                        {

                                                                            if (dt4.Rows[d][2].ToString() == "PARADA")
                                                                            {
                                                                                if (dt4.Rows[d][5].ToString() == "14")
                                                                                {
                                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                                    //.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                                }
                                                                                else
                                                                                {
                                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                                                }


                                                                            }
                                                                            else
                                                                            {
                                                                                // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                            }
                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                    }

                                                                }


                                                            }
                                                            //else if (dt4.Rows[m][2].ToString() == "REINICIO DE VIAGEM")
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //}
                                                            //else if (dt4.Rows[m][2].ToString() == "PARADA INTERNA")
                                                            //{
                                                            //    if (dt4.Rows[m][5].ToString() == "3" || dt4.Rows[m][5].ToString() == "1" || dt4.Rows[m][5].ToString() == "2")
                                                            //    {
                                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");

                                                            //    }
                                                            //    else if (dt4.Rows[m][5].ToString() == "22")
                                                            //    {
                                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                            //    }

                                                            //    else if (dt4.Rows[m][2].ToString() == "FIM DE JORNADA")
                                                            //    {
                                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //        write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            //    }

                                                            //}
                                                            else if (dt4.Rows[m][2].ToString() == "PARADA")
                                                            {
                                                                // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                            }
                                                            //else if (dt4.Rows[m][2].ToString() == "PARADA INTERNA")
                                                            //{
                                                            //    if (dt4.Rows[m][5].ToString() != "3" || dt4.Rows[m][5].ToString() != "1" || dt4.Rows[m][5].ToString() != "2")
                                                            //    {
                                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                            //        write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                            //    }

                                                            //}

                                                            else
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            }


                                                        }
                                                        else
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                        }
                                                    }
                                                    else
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                    }


                                                }
                                                else
                                                {
                                                    // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                }
                                            }

                                        }
                                        else
                                        {
                                            if (dt4.Rows[w][2].ToString() == "FIM DE JORNADA")
                                            {
                                                int q = 0;
                                                q = w + 1;

                                                if (q < dt4.Rows.Count)
                                                {
                                                    if (dt4.Rows[q][2].ToString() == "FIM DE JORNADA")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                    }
                                                    else
                                                    {
                                                        int a = 0;
                                                        a = w - 1;

                                                        if (a >= 0)
                                                        {

                                                            if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM" || dt4.Rows[a][2].ToString() == "RETORNO REFEICAO" || dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                            }
                                                            //else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                            //{
                                                            //    if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                            //    {
                                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                            //        // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                            //        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //    }
                                                            //    else if (dt4.Rows[a][5].ToString() == "14")
                                                            //    {
                                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //        write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            //    }
                                                            //    else
                                                            //    {
                                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");


                                                            //    }
                                                            //}
                                                            else if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                            {

                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "FIM DE JORNADA")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            }
                                                            else
                                                            {
                                                                // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            }
                                                        }
                                                    }

                                                }
                                                else
                                                {
                                                    int a = 0;
                                                    a = w - 1;

                                                    if (a >= 0)
                                                    {

                                                        if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");

                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "RETORNO REFEICAO")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");

                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                        {
                                                            if (dt4.Rows[a][5].ToString() == "14")
                                                            {
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                            }
                                                            else
                                                            {
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            }
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");

                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                        }
                                                        //else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                        //{
                                                        //    if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                        //    {
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                        //        // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                        //        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //    }
                                                        //    else if (dt4.Rows[a][5].ToString() == "14")
                                                        //    {
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //        write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                        //    }
                                                        //    else
                                                        //    {
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");

                                                        //    }
                                                        //}
                                                        else if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                        {

                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "FIM DE JORNADA")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");

                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                        }
                                                        else
                                                        {
                                                            // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                        }
                                                    }
                                                    else
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                    }
                                                }
                                            }





                                        }


                                        #endregion

                                        #region PARADA PERNOITE

                                        if (dt4.Rows[w][2].ToString() == "PARADA PERNOITE")
                                        {
                                            int a = 0;
                                            a = w - 1;


                                            if (a >= 0)
                                            {
                                                if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                {


                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {

                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                        //WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;0102");
                                                        write.WriteLine("+00" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm").Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");


                                                    }
                                                    else if (dt4.Rows[a][5].ToString() == "15")
                                                    {

                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;22");


                                                    }
                                                    //else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");
                                                    //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //}
                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;22");
                                                    //}



                                                }
                                                else if (dt4.Rows[a][2].ToString() == "PARADA")
                                                {
                                                    //if (dt4.Rows[a][5].ToString() == "7")
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");
                                                    //}
                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {

                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                        //WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;0102");
                                                        write.WriteLine("+00" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm").Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");


                                                    }
                                                    else
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                    }

                                                }
                                                else if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM")
                                                {
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";2;22");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";3;22");
                                                }
                                                else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                {
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                    // write.WriteLine(cracha + ";" + data + ";" + hora + ";3;22");
                                                }
                                                //else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                //{


                                                //    if (dt4.Rows[a][5].ToString() == "14")
                                                //    {

                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                //        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");


                                                //    }
                                                //    //else if (dt4.Rows[a][5].ToString() == "15")
                                                //    //{

                                                //    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                //    //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");


                                                //    //}
                                                //    else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                //    {
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                //        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");
                                                //        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                //    }
                                                //    //else
                                                //    //{
                                                //    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;22");
                                                //    //}



                                                //}
                                                //else
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;22");
                                                //}

                                            }
                                            //else
                                            //{
                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;22");
                                            //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");

                                            //}

                                        }

                                        #endregion


                                        write.Flush();
                                        write.Close();
                                    }

                                    //FIM

                                    #endregion
                                }
                            }

                        }

                        else
                        {
                            //JORNADA DIFERENCIA DE COMEÇO

                            //VERIFICA SE A ULTIMA MARCAÇÃO DO DIA É PARADA PERNOITE OU FIM DE VIAGEM
                            string sqlz = "select top 1 ds_macro from tb_parada where cod_cracha=" + dt1.Rows[x][0].ToString() + " and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).ToString("yyyy-MM-dd") + "' order by hr_posicao  DESC ";
                            SqlDataAdapter adtpz = new SqlDataAdapter(sqlz, con);
                            DataTable dtz = new DataTable();
                            con.Open();
                            adtpz.Fill(dtz);
                            con.Close();


                            if (dtz.Rows[0][0].ToString() == "FIM DE JORNADA" || dtz.Rows[0][0].ToString() == "PARADA PERNOITE")
                            {
                                //JORNADA NORMAL COM DIFERENÇA NO COMEÇO
                                string sqld = "select TOP 1  ds_macro, hr_posicao from tb_parada  where  cod_cracha=" + dt1.Rows[x][0].ToString() + " and fl_deletado is null and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).ToString("yyyy-MM-dd") + "'  and hr_posicao > (select top 1 hr_posicao from tb_parada where cod_cracha=" + dt1.Rows[x][0].ToString() + " and fl_deletado is null and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).ToString("yyyy-MM-dd") + "'  and ds_macro='FIM DE JORNADA'  OR cod_cracha=" + dt1.Rows[x][0].ToString() + " and fl_deletado is null and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).ToString("yyyy-MM-dd") + "'  and ds_macro='PARADA PERNOITE' order by hr_posicao) order by hr_posicao ";
                                SqlDataAdapter adtpd = new SqlDataAdapter(sqld, con);
                                DataTable dtd = new DataTable();
                                con.Open();
                                adtpd.Fill(dtd);
                                con.Close();

                                if (dtd.Rows.Count > 0)
                                {

                                    #region Jornada Normal
                                    //string arquivo = "Transmot" + DateTime.Parse(txtDtInicial.Text).ToString("ddMM") + "001.txt";

                                    sql4 = "select dt_posicao_parada, hr_posicao, ds_macro,cod_transmissao, cod_cracha, isnull(cod_ref_parada,0) as cod_ref_parada, cod_idveiculo from tb_parada where fl_deletado is null and cod_cracha=" + dt1.Rows[x][0].ToString() + " and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).ToString("yyyy-MM-dd") + "' and fl_deletado is null and hr_posicao >= '" + dtd.Rows[0][1].ToString() + "' AND (ds_macro IN ('INICIO DE JORNADA', 'INICIO JORNADA CAMINHAO', 'PARADA REFEICAO', 'FIM DE JORNADA','REINICIO DE VIAGEM','FIM DE VIAGEM', 'PARADA','PARADA INTERNA','INICIO DE VIAGEM','PARADA INTERNA','RETORNO REFEICAO','PARADA CLIENTE / FORNECEDOR') OR cod_ref_parada in (2,3,4,14,22)) AND fl_deletado IS NULL ORDER BY dt_posicao_parada, hr_posicao";
                                    // string sql4 = "select dt_posicao_parada, hr_posicao, ds_macro,cod_transmissao, cod_cracha, isnull(cod_ref_parada,0) as cod_ref_parada, cod_idveiculo from tb_parada where fl_deletado is null and cod_cracha=" + dt1.Rows[x][0].ToString() + " and dt_posicao_parada between '" + txtDtInicial.Text + "' and '" + txtDtFinal.Text + "' order by dt_posicao_parada, hr_posicao";
                                    SqlDataAdapter adtp4 = new SqlDataAdapter(sql4, con);
                                    DataTable dt4 = new DataTable();

                                    try
                                    {
                                        con.Open();
                                        adtp4.Fill(dt4);
                                        con.Close();
                                    }
                                    catch (Exception ed)
                                    {
                                        // MessageBox.Show(ed.ToString(), "Erro3");
                                    }

                                    c = 0;

                                    for (int y = 0; y < dt4.Rows.Count; y++)
                                    {
                                        if (dt4.Rows[y][2].ToString() == "FIM DE JORNADA" && dt4.Rows[y][6].ToString() == "725405" || dt4.Rows[y][2].ToString() == "FIM DE JORNADA" && dt4.Rows[y][6].ToString() == "725407" || dt4.Rows[y][2].ToString() == "FIM DE JORNADA" && dt4.Rows[y][6].ToString() == "184525")
                                        {
                                            c = c + 1;
                                        }

                                    }
                                    string caminho = Server.MapPath("/TXT/");

                                    string filepath = caminho + arquivo;

                                    FileInfo file = new FileInfo(filepath);

                                    //if (file.Exists)
                                    //{
                                    //    file.Delete();
                                    //}


                                    for (int w = 0; w < dt4.Rows.Count; w++)
                                    {
                                        //if (chkDiadema.Checked || chkCadiriri.Checked)
                                        //{


                                        //        if (dt1.Rows[x][0].ToString().Length < 4)
                                        //        {
                                        //            cracha = "300" + dt1.Rows[x][0].ToString();
                                        //        }
                                        //        else if (dt1.Rows[x][0].ToString().Length >= 4 || dt1.Rows[x][0].ToString().Length <= 5)
                                        //        {
                                        //            cracha = "30" + dt1.Rows[x][0].ToString();
                                        //        }
                                        //        else
                                        //        {
                                        //            cracha = dt1.Rows[x][0].ToString();
                                        //        }




                                        //}
                                        //else
                                        //{
                                        //    if (dt1.Rows[x][0].ToString().Length < 4)
                                        //    {
                                        //        cracha = "300" + dt1.Rows[x][0].ToString();
                                        //    }
                                        //    else if (dt1.Rows[x][0].ToString().Length >= 4 || dt1.Rows[x][0].ToString().Length <= 5)
                                        //    {
                                        //        cracha = "30" + dt1.Rows[x][0].ToString();
                                        //    }
                                        //    else
                                        //    {
                                        //        cracha = dt1.Rows[x][0].ToString();
                                        //    }
                                        //}
                                        string codigo = dt1.Rows[x][0].ToString();
                                        string[] codigosEspeciais = { "330", "482", "820", "958", "989" };

                                        if (codigo.StartsWith("312"))
                                        {
                                            cracha = codigo.Insert(3, "0");
                                        }
                                        else if ((codigosEspeciais.Contains(codigo) || codigo.Length <= 4))
                                        {
                                            cracha = "30" + codigo;
                                        }
                                        else if (codigo.Length <= 3)
                                        {
                                            cracha = "300" + codigo;
                                        }

                                        else
                                        {
                                            cracha = codigo;
                                        }





                                        //  cracha = "30" + dt1.Rows[x][0].ToString();
                                        int t = 0;
                                        t = w - 1;

                                        string data = DateTime.Parse(dt4.Rows[w][0].ToString()).ToString("dd/MM/yy");
                                        string horas = DateTime.Parse(dt4.Rows[w][1].ToString()).ToString("HH:mm");
                                        if (t >= 0)
                                        {
                                            if (DateTime.Parse(dt4.Rows[w][1].ToString()).ToString("HH:mm") == DateTime.Parse(dt4.Rows[t][1].ToString()).ToString("HH:mm"))
                                            {
                                                hora = DateTime.Parse(horas).AddMinutes(1).ToString("HH:mm");
                                            }
                                            else
                                            {
                                                hora = DateTime.Parse(horas).ToString("HH:mm");
                                            }
                                        }
                                        else
                                        {
                                            hora = DateTime.Parse(horas).ToString("HH:mm");
                                        }
                                        //tipo = dt4.Rows[w][2].ToString();
                                        string transmissao = dt4.Rows[w][3].ToString();


                                        //if (dt4.Rows[w][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[w][2].ToString() == "TRECHO ALMOÇO" || dt4.Rows[w][2].ToString() == "FIM DE JORNADA")
                                        //{
                                        //    tipo = "2";
                                        //}
                                        //else  if (dt4.Rows[w][2].ToString() == "PARADA FORNECEDOR" || dt4.Rows[w][2].ToString() == "REINICIO DE VIAGEM")
                                        //{
                                        //    tipo = "21";
                                        //}






                                        StreamWriter write = new StreamWriter(caminho + arquivo, true);


                                        #region BLOCO INICIO JORNADA
                                        //BLOCO INICIO JORNADA
                                        if (dt4.Rows[w][2].ToString() == "INICIO DE JORNADA")
                                        {
                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");
                                        }

                                        if (dt4.Rows[w][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[w][2].ToString() == "INICIO JORNADA")
                                        {

                                            int a = 0;
                                            a = w - 1;
                                            if (a >= 0)
                                            {
                                                if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");

                                                }
                                                else
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");

                                                }
                                            }
                                            else
                                            {
                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");
                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                            }


                                        }
                                        //FIM
                                        #endregion

                                        #region BLOCO INICIO JORNADA CAMINHAO
                                        //BLOCO INICIO JORNADA CAMINHAO

                                        if (dt4.Rows[w][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[w][2].ToString() == "INICIO JORNADA")
                                        {

                                            int a = 0;
                                            a = w - 1;
                                            if (a >= 0)
                                            {
                                                if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");

                                                }
                                                else
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");
                                                }
                                            }
                                            else
                                            {
                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                            }


                                        }
                                        //FIM
                                        #endregion

                                        #region PARADA INTERNA
                                        //BLOCO PARADA INTERNA
                                        if (dt4.Rows[w][2].ToString() == "PARADA INTERNA")
                                        {
                                            if (dt4.Rows[w][5].ToString() == "3" || dt4.Rows[w][5].ToString() == "2")
                                            {
                                                int a = 0;
                                                a = w - 1;
                                                if (a >= 0)
                                                {
                                                    if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                    }
                                                    else if (dt4.Rows[a][5].ToString() == "14")
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                    }
                                                    else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "1")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "PARADA REFEICAO")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM")
                                                    {
                                                        //////write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        ////write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        ////write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                    }
                                                    else
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                    }

                                                }

                                            }
                                            else if (dt4.Rows[w][5].ToString() == "14")
                                            {
                                                int a = 0;
                                                a = w - 1;
                                                if (a >= 0)
                                                {
                                                    if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                    }
                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                    }
                                                    else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "1")
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "PARADA REFEICAO")
                                                    {
                                                        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                    {

                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");

                                                    }
                                                    if (dt4.Rows[a][5].ToString() == "22")
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                    }
                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93: 71489");
                                                    //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                    //}

                                                }
                                            }
                                            else if (dt4.Rows[w][5].ToString() == "22")
                                            {
                                                int a = 0;
                                                a = w - 1;
                                                if (a >= 0)
                                                {

                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                    }


                                                }
                                            }
                                            else
                                            {
                                                int a = 0;
                                                a = w - 1;
                                                if (a >= 0)
                                                {
                                                    if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");
                                                    }
                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                    }

                                                    else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "1")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "PARADA REFEICAO")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                        //// write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                    {

                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                    {

                                                        //// write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");

                                                    }

                                                }
                                            }

                                        }
                                        //FIM 
                                        #endregion

                                        #region BLOCO PARADA REFEIÇÃO
                                        //BLOCO PARADA REFEIÇÃO
                                        if (dt4.Rows[w][2].ToString() == "PARADA REFEICAO")
                                        {
                                            int a = 0;
                                            a = w - 1;
                                            if (a >= 0)
                                            {
                                                //if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                //{

                                                //    if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                //    {
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;93");
                                                //    }
                                                //    else
                                                //    {
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;93");
                                                //    }
                                                //}
                                                if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");

                                                }
                                                else
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                }

                                            }
                                            //else
                                            //{
                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;93");
                                            //}
                                        }
                                        //FIM
                                        #endregion

                                        #region RETORNO REFEIÇAO
                                        //BLOCO RETORNO REFEIÇAO
                                        if (dt4.Rows[w][2].ToString() == "RETORNO REFEICAO")
                                        {

                                            int a = 0;
                                            int b = 0;
                                            a = w - 1;
                                            b = w + 1;
                                            if (a >= 0)
                                            {

                                                if (dt4.Rows[a][2].ToString() == "PARADA REFEICAO")
                                                {

                                                    // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;0102");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");

                                                }
                                                //if (dt4.Rows[b][2].ToString() == "FIM DE JORNADA")
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                //}
                                                //else
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");

                                                //}
                                            }


                                        }
                                        //FIM
                                        #endregion

                                        #region INICIO DE VIAGEM
                                        //BLOCO REINICIO / INICIO DE VIAGEM
                                        if (dt4.Rows[w][2].ToString() == "INICIO DE VIAGEM")
                                        {
                                            int a = 0;
                                            a = w - 1;
                                            if (a >= 0)
                                            {
                                                //if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                //{
                                                //    if (dt4.Rows[a][5].ToString() == "14")
                                                //    {
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");

                                                //    }
                                                //    else
                                                //        if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                //    {
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");

                                                //    }
                                                //    else
                                                //    {
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                //    }
                                                //}
                                                //if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                //}
                                                //else if (dt4.Rows[a][2].ToString() == "PARADA PERNOITE")
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;22");
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                //}
                                                //else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                //}

                                                if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                {


                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {

                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");



                                                    }
                                                    //else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "1" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "4")
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                    //}



                                                }
                                                else if (dt4.Rows[a][2].ToString() == "PARADA")
                                                {


                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {

                                                        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                    }
                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");



                                                    //}



                                                }
                                                //else if (dt4.Rows[a][2].ToString() == "RETORNO REFEICAO")
                                                //{
                                                //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                //    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");

                                                //}

                                            }
                                            //else
                                            //{
                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                            //}



                                        }
                                        //FIM
                                        #endregion

                                        #region PARADA CLIENTE / FORNECEDOR
                                        if (dt4.Rows[w][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                        {
                                            if (dt4.Rows[w][5].ToString() == "3" || dt4.Rows[w][5].ToString() == "2" || dt4.Rows[w][5].ToString() == "4")
                                            {
                                                int a = 0;
                                                a = w - 1;
                                                if (a >= 0)
                                                {
                                                    //if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                    //}
                                                    if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                    {
                                                        if (dt4.Rows[a][5].ToString() == "14")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;0102");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");


                                                        }
                                                        //else if (dt4.Rows[a][5].ToString() == "15")
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");

                                                        //}
                                                        //else
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                        //}

                                                    }
                                                }

                                            }
                                            else if (dt4.Rows[w][5].ToString() == "14")
                                            {
                                                int a = 0;
                                                a = w - 1;
                                                if (a >= 0)
                                                {
                                                    if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                    {
                                                        if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "4")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                        }
                                                        else if (dt4.Rows[a][5].ToString() == "14")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");

                                                        }


                                                    }
                                                    else
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                    }

                                                }


                                            }


                                        }
                                        #endregion

                                        #region REINICIO
                                        //BLOCO REINICIO / INICIO DE VIAGEM
                                        if (dt4.Rows[w][2].ToString() == "REINICIO DE VIAGEM")
                                        {
                                            int a = 0;
                                            a = w - 1;
                                            if (a >= 0)
                                            {
                                                if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                {

                                                }
                                                else if (dt4.Rows[a][2].ToString() == "PARADA PERNOITE")
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                }

                                                else if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                {

                                                    if (a >= 0)
                                                    {

                                                        if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                        {
                                                            //if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                            //}
                                                            if (dt4.Rows[a][5].ToString() == "14")
                                                            {

                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");

                                                            }
                                                            //else if (dt4.Rows[a][5].ToString() == "15")
                                                            //{

                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");

                                                            //}
                                                            //else
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                            //}
                                                        }
                                                        //else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                        //}


                                                    }



                                                }
                                                else if (dt4.Rows[a][2].ToString() == "PARADA")
                                                {
                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                    }
                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                    //}




                                                }
                                                //else if (dt4.Rows[a][2].ToString() == "OFICINA / MANUTENCAO")
                                                //{

                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");


                                                //}

                                            }
                                            else
                                            {
                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");
                                                // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                            }



                                        }
                                        //FIM
                                        #endregion

                                        #region BLOCO PARADA
                                        // BLOCO PARADA
                                        if (dt4.Rows[w][2].ToString() == "PARADA")
                                        {
                                            int a = 0;
                                            a = w - 1;


                                            if (dt4.Rows[w][5].ToString() == "14")
                                            {
                                                if (dt4.Rows.Count >= a)
                                                {
                                                    if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                    {
                                                        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");


                                                    }

                                                }
                                            }
                                            //else
                                            //{
                                            //    if (dt4.Rows.Count >= a)
                                            //    {
                                            //        if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                            //        {
                                            //            write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                            //            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");

                                            //        }
                                            //        //else
                                            //        //{
                                            //        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                            //        //    // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                            //        //}
                                            //    }
                                            //}



                                            //  write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");

                                        }
                                        //FIM
                                        #endregion

                                        #region FIM DE VIAGEM
                                        //BLOCO FIM DE VIAGEM
                                        if (dt4.Rows[w][2].ToString() == "FIM DE VIAGEM")
                                        {
                                            int a = 0;
                                            int g = 0;
                                            a = w - 1;
                                            g = w - 2;
                                            if (a >= 0)
                                            {
                                                if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                {


                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {

                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;0102");

                                                    }

                                                    //else if (dt4.Rows[a][5].ToString() == "14")
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                    //    // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                    //}

                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //    // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                    //}



                                                }
                                                else if (dt4.Rows[a][2].ToString() == "PARADA")
                                                {


                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;0102");

                                                    }

                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //    // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");

                                                    //}


                                                }

                                                else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                {
                                                    if (g >= 0)
                                                    {
                                                        //if (dt4.Rows[g][2].ToString() == "PARADA PERNOITE")
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                        //}
                                                        //else
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //}
                                                    }
                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //}


                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                }


                                            }
                                            //else
                                            //{
                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                            //}

                                        }

                                        //
                                        #endregion

                                        #region FIM DE JORNADA
                                        //BLOCO FIM DE JORMADA
                                        if (c > 0)
                                        {
                                            if (dt4.Rows[w][2].ToString() == "FIM DE JORNADA" && dt4.Rows[w][6].ToString() == "725405" || dt4.Rows[w][2].ToString() == "FIM DE JORNADA" && dt4.Rows[w][6].ToString() == "725407" || dt4.Rows[w][2].ToString() == "FIM DE JORNADA" && dt4.Rows[w][6].ToString() == "184525")
                                            {
                                                int a = 0;
                                                a = w - 1;

                                                if (a >= 0)
                                                {
                                                    if (dt4.Rows[a][2].ToString() == "RETORNO REFEICAO")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                    {

                                                        //WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");


                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "RETORNO REFEICAO")
                                                    {

                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");

                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                    {
                                                        int b = 0;
                                                        b = a - 1;

                                                        if (b >= 0)
                                                        {
                                                            if (dt4.Rows[b][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[b][2].ToString() == "REINICIO DE VIAGEM")
                                                            {
                                                                int d = 0;
                                                                d = b - 1;
                                                                if (d >= 0)
                                                                {

                                                                    if (dt4.Rows[d][2].ToString() == "PARADA")
                                                                    {
                                                                        if (dt4.Rows[d][5].ToString() == "14")
                                                                        {
                                                                            // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                        }
                                                                        else
                                                                        {
                                                                            // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                            // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                        }




                                                                    }
                                                                    else
                                                                    {
                                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                        // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                    }
                                                                }
                                                            }
                                                            else
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            }

                                                        }
                                                        else
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                        }

                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "PARADA")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                    {
                                                        if (dt4.Rows[a][5].ToString() == "14")
                                                        {
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                        }
                                                        else
                                                        {
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        }
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");

                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "FIM DE JORNADA")
                                                    {
                                                        int m = 0;
                                                        m = a - 1;

                                                        if (m >= 0)
                                                        {
                                                            if (dt4.Rows[m][2].ToString() == "RETORNO REFEICAO" || dt4.Rows[m][2].ToString() == "INICIO DE JORNADA")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            }
                                                            else if (dt4.Rows[m][2].ToString() == "FIM DE VIAGEM")
                                                            {
                                                                int b = 0;
                                                                b = m - 1;

                                                                if (b >= 0)
                                                                {
                                                                    if (dt4.Rows[b][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[b][2].ToString() == "REINICIO DE VIAGEM")
                                                                    {
                                                                        int d = 0;
                                                                        d = b - 1;
                                                                        if (d >= 0)
                                                                        {

                                                                            if (dt4.Rows[d][2].ToString() == "PARADA")
                                                                            {
                                                                                if (dt4.Rows[d][5].ToString() == "14")
                                                                                {
                                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                                    //.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                                }
                                                                                else
                                                                                {
                                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                                                }


                                                                            }
                                                                            else
                                                                            {
                                                                                // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                            }
                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                    }

                                                                }


                                                            }
                                                            //else if (dt4.Rows[m][2].ToString() == "REINICIO DE VIAGEM")
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //}
                                                            //else if (dt4.Rows[m][2].ToString() == "PARADA INTERNA")
                                                            //{
                                                            //    if (dt4.Rows[m][5].ToString() == "3" || dt4.Rows[m][5].ToString() == "1" || dt4.Rows[m][5].ToString() == "2")
                                                            //    {
                                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");

                                                            //    }
                                                            //    else if (dt4.Rows[m][5].ToString() == "22")
                                                            //    {
                                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                            //    }

                                                            //    else if (dt4.Rows[m][2].ToString() == "FIM DE JORNADA")
                                                            //    {
                                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //        write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            //    }

                                                            //}
                                                            else if (dt4.Rows[m][2].ToString() == "PARADA")
                                                            {
                                                                // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                            }
                                                            //else if (dt4.Rows[m][2].ToString() == "PARADA INTERNA")
                                                            //{
                                                            //    if (dt4.Rows[m][5].ToString() != "3" || dt4.Rows[m][5].ToString() != "1" || dt4.Rows[m][5].ToString() != "2")
                                                            //    {
                                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                            //        write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                            //    }

                                                            //}

                                                            else
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            }


                                                        }
                                                        else
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                        }
                                                    }
                                                    else
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                    }


                                                }
                                                else
                                                {
                                                    // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                }
                                            }

                                        }
                                        else
                                        {
                                            if (dt4.Rows[w][2].ToString() == "FIM DE JORNADA")
                                            {
                                                int q = 0;
                                                q = w + 1;

                                                if (q < dt4.Rows.Count)
                                                {
                                                    if (dt4.Rows[q][2].ToString() == "FIM DE JORNADA")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                    }
                                                    else
                                                    {
                                                        int a = 0;
                                                        a = w - 1;

                                                        if (a >= 0)
                                                        {

                                                            if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM" || dt4.Rows[a][2].ToString() == "RETORNO REFEICAO" || dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                            }
                                                            //else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                            //{
                                                            //    if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                            //    {
                                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                            //        // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                            //        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //    }
                                                            //    else if (dt4.Rows[a][5].ToString() == "14")
                                                            //    {
                                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //        write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            //    }
                                                            //    else
                                                            //    {
                                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");


                                                            //    }
                                                            //}
                                                            else if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                            {

                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "FIM DE JORNADA")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            }
                                                            else
                                                            {
                                                                // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            }
                                                        }
                                                    }

                                                }
                                                else
                                                {
                                                    int a = 0;
                                                    a = w - 1;

                                                    if (a >= 0)
                                                    {

                                                        if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");

                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "RETORNO REFEICAO")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");

                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                        {
                                                            if (dt4.Rows[a][5].ToString() == "14")
                                                            {
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                            }
                                                            else
                                                            {
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            }
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");

                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                        }
                                                        //else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                        //{
                                                        //    if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                        //    {
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                        //        // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                        //        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //    }
                                                        //    else if (dt4.Rows[a][5].ToString() == "14")
                                                        //    {
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //        write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                        //    }
                                                        //    else
                                                        //    {
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");

                                                        //    }
                                                        //}
                                                        else if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                        {

                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "FIM DE JORNADA")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");

                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                        }
                                                        else
                                                        {
                                                            // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                        }
                                                    }
                                                    else
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                    }
                                                }
                                            }





                                        }


                                        #endregion

                                        #region PARADA PERNOITE

                                        if (dt4.Rows[w][2].ToString() == "PARADA PERNOITE")
                                        {
                                            int a = 0;
                                            a = w - 1;


                                            if (a >= 0)
                                            {
                                                if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                {


                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {

                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                        //WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;0102");
                                                        write.WriteLine("+00" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm").Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");


                                                    }
                                                    else if (dt4.Rows[a][5].ToString() == "15")
                                                    {

                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;22");


                                                    }
                                                    //else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");
                                                    //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //}
                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;22");
                                                    //}



                                                }
                                                else if (dt4.Rows[a][2].ToString() == "PARADA")
                                                {
                                                    //if (dt4.Rows[a][5].ToString() == "7")
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");
                                                    //}
                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {

                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                        //WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;0102");
                                                        write.WriteLine("+00" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm").Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");


                                                    }
                                                    else
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                    }

                                                }
                                                else if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM")
                                                {
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";2;22");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";3;22");
                                                }
                                                else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                {
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                    // write.WriteLine(cracha + ";" + data + ";" + hora + ";3;22");
                                                }
                                                //else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                //{


                                                //    if (dt4.Rows[a][5].ToString() == "14")
                                                //    {

                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                //        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");


                                                //    }
                                                //    //else if (dt4.Rows[a][5].ToString() == "15")
                                                //    //{

                                                //    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                //    //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");


                                                //    //}
                                                //    else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                //    {
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                //        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");
                                                //        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                //    }
                                                //    //else
                                                //    //{
                                                //    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;22");
                                                //    //}



                                                //}
                                                //else
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;22");
                                                //}

                                            }
                                            //else
                                            //{
                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;22");
                                            //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");

                                            //}

                                        }

                                        #endregion

                                        write.Flush();
                                        write.Close();

                                    }

                                    //FIM

                                    #endregion
                                }
                                else
                                {

                                }
                            }
                            else
                            {
                                //JORNADA PERNOITE COM DIFERENÇA NO COMEÇO
                                string sqli = "select TOP 1  hr_posicao from tb_parada  where  cod_cracha=" + dt1.Rows[x][0].ToString() + " and fl_deletado is null and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).ToString("yyyy-MM-dd") + "'  and hr_posicao > (select top 1 hr_posicao from tb_parada where cod_cracha=" + dt1.Rows[x][0].ToString() + " and fl_deletado is null and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).ToString("yyyy-MM-dd") + "'  and ds_macro='FIM DE JORNADA'  OR cod_cracha=" + dt1.Rows[x][0].ToString() + " and fl_deletado is null and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).ToString("yyyy-MM-dd") + "'  and ds_macro='PARADA PERNOITE' order by hr_posicao) order by hr_posicao ";
                                SqlDataAdapter adtpi = new SqlDataAdapter(sqli, con);
                                DataTable dti = new DataTable();
                                con.Open();
                                adtpi.Fill(dti);
                                con.Close();

                                string sqlf = "select top 1 hr_posicao from tb_parada where cod_cracha=" + dt1.Rows[x][0].ToString() + " and ds_macro = 'FIM DE JORNADA' and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).AddDays(1).ToString("yyyy-MM-dd") + "' and fl_deletado is null OR cod_cracha=" + dt1.Rows[x][0].ToString() + " and ds_macro='PARADA PERNOITE' and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).AddDays(1).ToString("yyyy-MM-dd") + "' and fl_deletado is null order by hr_posicao";
                                SqlDataAdapter adtpf = new SqlDataAdapter(sqlf, con);
                                DataTable dtf = new DataTable();
                                con.Open();
                                adtpf.Fill(dtf);
                                con.Close();



                                if (dti.Rows.Count > 0 && dtf.Rows.Count > 0)
                                {
                                    #region Jornada Noturna


                                    //sql4 = "select dt_posicao_parada, hr_posicao, ds_macro,cod_transmissao, cod_cracha, isnull(cod_ref_parada,0) as cod_ref_parada, cod_idveiculo from tb_parada where fl_deletado is null and cod_cracha=" + dt1.Rows[x][0].ToString() + " and dt_posicao_parada='" + txtDtInicial.Text + "' order by dt_posicao_parada, hr_posicao";
                                    sql4 = "select dt_posicao_parada, hr_posicao, ds_macro,cod_transmissao, cod_cracha, isnull(cod_ref_parada,0) as cod_ref_parada, cod_idveiculo from tb_parada where fl_deletado is null and cod_cracha=" + dt1.Rows[x][0].ToString() + " and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).ToString("yyyy-MM-dd") + "' and hr_posicao >='" + dti.Rows[0][0].ToString() + "' or cod_cracha=" + dt1.Rows[x][0].ToString() + " and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).AddDays(1).ToString("yyyy-MM-dd") + "' and hr_posicao <= '" + dtf.Rows[0][0].ToString() + "' AND (ds_macro IN ('INICIO DE JORNADA', 'INICIO JORNADA CAMINHAO', 'PARADA REFEICAO', 'FIM DE JORNADA','REINICIO DE VIAGEM','FIM DE VIAGEM', 'PARADA','INICIO DE VIAGEM','PARADA INTERNA','RETORNO REFEICAO','PARADA CLIENTE / FORNECEDOR') OR cod_ref_parada in (2,3,4,14,22)) AND fl_deletado IS NULL ORDER BY dt_posicao_parada, hr_posicao";
                                    // string sql4 = "select dt_posicao_parada, hr_posicao, ds_macro,cod_transmissao, cod_cracha, isnull(cod_ref_parada,0) as cod_ref_parada, cod_idveiculo from tb_parada where fl_deletado is null and cod_cracha=" + dt1.Rows[x][0].ToString() + " and dt_posicao_parada between '" + txtDtInicial.Text + "' and '" + txtDtFinal.Text + "' order by dt_posicao_parada, hr_posicao";
                                    SqlDataAdapter adtp4 = new SqlDataAdapter(sql4, con);
                                    DataTable dt4 = new DataTable();

                                    try
                                    {
                                        con.Open();
                                        adtp4.Fill(dt4);
                                        con.Close();
                                    }
                                    catch (Exception ed)
                                    {
                                        //MessageBox.Show(ed.ToString(), "Erro3");
                                    }

                                    c = 0;

                                    for (int y = 0; y < dt4.Rows.Count; y++)
                                    {
                                        if (dt4.Rows[y][2].ToString() == "FIM DE JORNADA" && dt4.Rows[y][6].ToString() == "725405" || dt4.Rows[y][2].ToString() == "FIM DE JORNADA" && dt4.Rows[y][6].ToString() == "725407" || dt4.Rows[y][2].ToString() == "FIM DE JORNADA" && dt4.Rows[y][6].ToString() == "184525")
                                        {
                                            c = c + 1;
                                        }

                                    }
                                    string caminho = Server.MapPath("/TXT/");

                                    string filepath = caminho + arquivo;

                                    FileInfo file = new FileInfo(filepath);
                                    //if(file.Exists)
                                    //{
                                    //    file.Delete();
                                    //}



                                    for (int w = 0; w < dt4.Rows.Count; w++)
                                    {

                                        string codigo = dt1.Rows[x][0].ToString();
                                        string[] codigosEspeciais = { "330", "482", "820", "958", "989" };

                                        if (codigo.StartsWith("312"))
                                        {
                                            cracha = codigo.Insert(3, "0");
                                        }
                                        else if ((codigosEspeciais.Contains(codigo) || codigo.Length <= 4))
                                        {
                                            cracha = "30" + codigo;
                                        }
                                        else if (codigo.Length <= 3)
                                        {
                                            cracha = "300" + codigo;
                                        }

                                        else
                                        {
                                            cracha = codigo;
                                        }

                                        // cracha = "30" + dt1.Rows[x][0].ToString();
                                        int t = 0;
                                        t = w - 1;
                                        string data = DateTime.Parse(dt4.Rows[w][0].ToString()).ToString("dd/MM/yy");
                                        string horas = DateTime.Parse(dt4.Rows[w][1].ToString()).ToString("HH:mm");
                                        if (t >= 0)
                                        {
                                            if (DateTime.Parse(dt4.Rows[w][1].ToString()).ToString("HH:mm") == DateTime.Parse(dt4.Rows[t][1].ToString()).ToString("HH:mm"))
                                            {
                                                hora = DateTime.Parse(horas).AddMinutes(1).ToString("HH:mm");
                                            }
                                            else
                                            {
                                                hora = DateTime.Parse(horas).ToString("HH:mm");
                                            }
                                        }
                                        else
                                        {
                                            hora = DateTime.Parse(horas).ToString("HH:mm");
                                        }
                                        //tipo = dt4.Rows[w][2].ToString();
                                        string transmissao = dt4.Rows[w][3].ToString();


                                        //if (dt4.Rows[w][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[w][2].ToString() == "TRECHO ALMOÇO" || dt4.Rows[w][2].ToString() == "FIM DE JORNADA")
                                        //{
                                        //    tipo = "2";
                                        //}
                                        //else  if (dt4.Rows[w][2].ToString() == "PARADA FORNECEDOR" || dt4.Rows[w][2].ToString() == "REINICIO DE VIAGEM")
                                        //{
                                        //    tipo = "21";
                                        //}



                                        StreamWriter write = new StreamWriter(caminho + arquivo, true);

                                        #region BLOCO INICIO JORNADA
                                        //BLOCO INICIO JORNADA
                                        if (dt4.Rows[w][2].ToString() == "INICIO DE JORNADA")
                                        {
                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");
                                        }

                                        if (dt4.Rows[w][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[w][2].ToString() == "INICIO JORNADA")
                                        {

                                            int a = 0;
                                            a = w - 1;
                                            if (a >= 0)
                                            {
                                                if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");

                                                }
                                                else
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");

                                                }
                                            }
                                            else
                                            {
                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                            }


                                        }
                                        //FIM
                                        #endregion

                                        #region BLOCO INICIO JORNADA CAMINHAO
                                        //BLOCO INICIO JORNADA CAMINHAO

                                        if (dt4.Rows[w][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[w][2].ToString() == "INICIO JORNADA")
                                        {

                                            int a = 0;
                                            a = w - 1;
                                            if (a >= 0)
                                            {
                                                if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");

                                                }
                                                else
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");
                                                }
                                            }
                                            else
                                            {
                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                            }


                                        }
                                        //FIM
                                        #endregion

                                        #region PARADA INTERNA
                                        //BLOCO PARADA INTERNA
                                        if (dt4.Rows[w][2].ToString() == "PARADA INTERNA")
                                        {
                                            if (dt4.Rows[w][5].ToString() == "3" || dt4.Rows[w][5].ToString() == "2")
                                            {
                                                int a = 0;
                                                a = w - 1;
                                                if (a >= 0)
                                                {
                                                    if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                    }
                                                    else if (dt4.Rows[a][5].ToString() == "14")
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                    }
                                                    else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "1")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "PARADA REFEICAO")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM")
                                                    {
                                                        //////write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        ////write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        ////write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                    }
                                                    else
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                    }

                                                }

                                            }
                                            else if (dt4.Rows[w][5].ToString() == "14")
                                            {
                                                int a = 0;
                                                a = w - 1;
                                                if (a >= 0)
                                                {
                                                    if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                    }
                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                    }
                                                    else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "1")
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "PARADA REFEICAO")
                                                    {
                                                        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                    {

                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");

                                                    }
                                                    if (dt4.Rows[a][5].ToString() == "22")
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                    }
                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93: 71489");
                                                    //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                    //}

                                                }
                                            }
                                            else if (dt4.Rows[w][5].ToString() == "22")
                                            {
                                                int a = 0;
                                                a = w - 1;
                                                if (a >= 0)
                                                {

                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                    }


                                                }
                                            }
                                            else
                                            {
                                                int a = 0;
                                                a = w - 1;
                                                if (a >= 0)
                                                {
                                                    if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");
                                                    }
                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                    }

                                                    else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "1")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "PARADA REFEICAO")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                        //// write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                    {

                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                    {

                                                        //// write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");

                                                    }

                                                }
                                            }

                                        }
                                        //FIM 
                                        #endregion

                                        #region BLOCO PARADA REFEIÇÃO
                                        //BLOCO PARADA REFEIÇÃO
                                        if (dt4.Rows[w][2].ToString() == "PARADA REFEICAO")
                                        {
                                            int a = 0;
                                            a = w - 1;
                                            if (a >= 0)
                                            {
                                                //if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                //{

                                                //    if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                //    {
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;93");
                                                //    }
                                                //    else
                                                //    {
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;93");
                                                //    }
                                                //}
                                                if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");

                                                }
                                                else
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                }

                                            }
                                            //else
                                            //{
                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;93");
                                            //}
                                        }
                                        //FIM
                                        #endregion

                                        #region RETORNO REFEIÇAO
                                        //BLOCO RETORNO REFEIÇAO
                                        if (dt4.Rows[w][2].ToString() == "RETORNO REFEICAO")
                                        {

                                            int a = 0;
                                            int b = 0;
                                            a = w - 1;
                                            b = w + 1;
                                            if (a >= 0)
                                            {

                                                if (dt4.Rows[a][2].ToString() == "PARADA REFEICAO")
                                                {

                                                    // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;0102");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");

                                                }
                                                //if (dt4.Rows[b][2].ToString() == "FIM DE JORNADA")
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                //}
                                                //else
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");

                                                //}
                                            }


                                        }
                                        //FIM
                                        #endregion

                                        #region INICIO DE VIAGEM
                                        //BLOCO REINICIO / INICIO DE VIAGEM
                                        if (dt4.Rows[w][2].ToString() == "INICIO DE VIAGEM")
                                        {
                                            int a = 0;
                                            a = w - 1;
                                            if (a >= 0)
                                            {
                                                //if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                //{
                                                //    if (dt4.Rows[a][5].ToString() == "14")
                                                //    {
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");

                                                //    }
                                                //    else
                                                //        if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                //    {
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");

                                                //    }
                                                //    else
                                                //    {
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                //    }
                                                //}
                                                //if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                //}
                                                //else if (dt4.Rows[a][2].ToString() == "PARADA PERNOITE")
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;22");
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                //}
                                                //else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                //}

                                                if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                {


                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {

                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");



                                                    }
                                                    //else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "1" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "4")
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                    //}



                                                }
                                                else if (dt4.Rows[a][2].ToString() == "PARADA")
                                                {


                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {

                                                        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                    }
                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");



                                                    //}



                                                }
                                                //else if (dt4.Rows[a][2].ToString() == "RETORNO REFEICAO")
                                                //{
                                                //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                //    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");

                                                //}

                                            }
                                            //else
                                            //{
                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                            //}



                                        }
                                        //FIM
                                        #endregion

                                        #region PARADA CLIENTE / FORNECEDOR
                                        if (dt4.Rows[w][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                        {
                                            if (dt4.Rows[w][5].ToString() == "3" || dt4.Rows[w][5].ToString() == "2" || dt4.Rows[w][5].ToString() == "4")
                                            {
                                                int a = 0;
                                                a = w - 1;
                                                if (a >= 0)
                                                {
                                                    //if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                    //}
                                                    if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                    {
                                                        if (dt4.Rows[a][5].ToString() == "14")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;0102");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");


                                                        }
                                                        //else if (dt4.Rows[a][5].ToString() == "15")
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");

                                                        //}
                                                        //else
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                        //}

                                                    }
                                                }

                                            }
                                            else if (dt4.Rows[w][5].ToString() == "14")
                                            {
                                                int a = 0;
                                                a = w - 1;
                                                if (a >= 0)
                                                {
                                                    if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                    {
                                                        if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "4")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                        }
                                                        else if (dt4.Rows[a][5].ToString() == "14")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");

                                                        }


                                                    }
                                                    else
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                    }

                                                }


                                            }


                                        }
                                        #endregion

                                        #region REINICIO
                                        //BLOCO REINICIO / INICIO DE VIAGEM
                                        if (dt4.Rows[w][2].ToString() == "REINICIO DE VIAGEM")
                                        {
                                            int a = 0;
                                            a = w - 1;
                                            if (a >= 0)
                                            {
                                                if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                {

                                                }
                                                else if (dt4.Rows[a][2].ToString() == "PARADA PERNOITE")
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                }

                                                else if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                {

                                                    if (a >= 0)
                                                    {

                                                        if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                        {
                                                            //if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                            //}
                                                            if (dt4.Rows[a][5].ToString() == "14")
                                                            {

                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");

                                                            }
                                                            //else if (dt4.Rows[a][5].ToString() == "15")
                                                            //{

                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");

                                                            //}
                                                            //else
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                            //}
                                                        }
                                                        //else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                        //}


                                                    }



                                                }
                                                else if (dt4.Rows[a][2].ToString() == "PARADA")
                                                {
                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                    }
                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                    //}




                                                }
                                                //else if (dt4.Rows[a][2].ToString() == "OFICINA / MANUTENCAO")
                                                //{

                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");


                                                //}

                                            }
                                            else
                                            {
                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");
                                                // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                            }



                                        }
                                        //FIM
                                        #endregion

                                        #region BLOCO PARADA
                                        // BLOCO PARADA
                                        if (dt4.Rows[w][2].ToString() == "PARADA")
                                        {
                                            int a = 0;
                                            a = w - 1;


                                            if (dt4.Rows[w][5].ToString() == "14")
                                            {
                                                if (dt4.Rows.Count >= a)
                                                {
                                                    if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                    {
                                                        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");


                                                    }

                                                }
                                            }
                                            //else
                                            //{
                                            //    if (dt4.Rows.Count >= a)
                                            //    {
                                            //        if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                            //        {
                                            //            write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                            //            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");

                                            //        }
                                            //        //else
                                            //        //{
                                            //        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                            //        //    // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                            //        //}
                                            //    }
                                            //}



                                            //  write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");

                                        }
                                        //FIM
                                        #endregion

                                        #region FIM DE VIAGEM
                                        //BLOCO FIM DE VIAGEM
                                        if (dt4.Rows[w][2].ToString() == "FIM DE VIAGEM")
                                        {
                                            int a = 0;
                                            int g = 0;
                                            a = w - 1;
                                            g = w - 2;
                                            if (a >= 0)
                                            {
                                                if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                {


                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {

                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;0102");

                                                    }

                                                    //else if (dt4.Rows[a][5].ToString() == "14")
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                    //    // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                    //}

                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //    // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                    //}



                                                }
                                                else if (dt4.Rows[a][2].ToString() == "PARADA")
                                                {


                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;0102");

                                                    }

                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //    // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");

                                                    //}


                                                }

                                                else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                {
                                                    if (g >= 0)
                                                    {
                                                        //if (dt4.Rows[g][2].ToString() == "PARADA PERNOITE")
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                        //}
                                                        //else
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //}
                                                    }
                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //}


                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                }


                                            }
                                            //else
                                            //{
                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                            //}

                                        }

                                        //
                                        #endregion

                                        #region FIM DE JORNADA
                                        //BLOCO FIM DE JORMADA
                                        if (c > 0)
                                        {
                                            if (dt4.Rows[w][2].ToString() == "FIM DE JORNADA" && dt4.Rows[w][6].ToString() == "725405" || dt4.Rows[w][2].ToString() == "FIM DE JORNADA" && dt4.Rows[w][6].ToString() == "725407" || dt4.Rows[w][2].ToString() == "FIM DE JORNADA" && dt4.Rows[w][6].ToString() == "184525")
                                            {
                                                int a = 0;
                                                a = w - 1;

                                                if (a >= 0)
                                                {
                                                    if (dt4.Rows[a][2].ToString() == "RETORNO REFEICAO")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                    {

                                                        //WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");


                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "RETORNO REFEICAO")
                                                    {

                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");

                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                    {
                                                        int b = 0;
                                                        b = a - 1;

                                                        if (b >= 0)
                                                        {
                                                            if (dt4.Rows[b][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[b][2].ToString() == "REINICIO DE VIAGEM")
                                                            {
                                                                int d = 0;
                                                                d = b - 1;
                                                                if (d >= 0)
                                                                {

                                                                    if (dt4.Rows[d][2].ToString() == "PARADA")
                                                                    {
                                                                        if (dt4.Rows[d][5].ToString() == "14")
                                                                        {
                                                                            // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                        }
                                                                        else
                                                                        {
                                                                            // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                            // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                        }




                                                                    }
                                                                    else
                                                                    {
                                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                        // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                    }
                                                                }
                                                            }
                                                            else
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            }

                                                        }
                                                        else
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                        }

                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "PARADA")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                    {
                                                        if (dt4.Rows[a][5].ToString() == "14")
                                                        {
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                        }
                                                        else
                                                        {
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        }
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");

                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "FIM DE JORNADA")
                                                    {
                                                        int m = 0;
                                                        m = a - 1;

                                                        if (m >= 0)
                                                        {
                                                            if (dt4.Rows[m][2].ToString() == "RETORNO REFEICAO" || dt4.Rows[m][2].ToString() == "INICIO DE JORNADA")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            }
                                                            else if (dt4.Rows[m][2].ToString() == "FIM DE VIAGEM")
                                                            {
                                                                int b = 0;
                                                                b = m - 1;

                                                                if (b >= 0)
                                                                {
                                                                    if (dt4.Rows[b][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[b][2].ToString() == "REINICIO DE VIAGEM")
                                                                    {
                                                                        int d = 0;
                                                                        d = b - 1;
                                                                        if (d >= 0)
                                                                        {

                                                                            if (dt4.Rows[d][2].ToString() == "PARADA")
                                                                            {
                                                                                if (dt4.Rows[d][5].ToString() == "14")
                                                                                {
                                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                                    //.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                                }
                                                                                else
                                                                                {
                                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                                                }


                                                                            }
                                                                            else
                                                                            {
                                                                                // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                            }
                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                    }

                                                                }


                                                            }
                                                            //else if (dt4.Rows[m][2].ToString() == "REINICIO DE VIAGEM")
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //}
                                                            //else if (dt4.Rows[m][2].ToString() == "PARADA INTERNA")
                                                            //{
                                                            //    if (dt4.Rows[m][5].ToString() == "3" || dt4.Rows[m][5].ToString() == "1" || dt4.Rows[m][5].ToString() == "2")
                                                            //    {
                                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");

                                                            //    }
                                                            //    else if (dt4.Rows[m][5].ToString() == "22")
                                                            //    {
                                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                            //    }

                                                            //    else if (dt4.Rows[m][2].ToString() == "FIM DE JORNADA")
                                                            //    {
                                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //        write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            //    }

                                                            //}
                                                            else if (dt4.Rows[m][2].ToString() == "PARADA")
                                                            {
                                                                // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                            }
                                                            //else if (dt4.Rows[m][2].ToString() == "PARADA INTERNA")
                                                            //{
                                                            //    if (dt4.Rows[m][5].ToString() != "3" || dt4.Rows[m][5].ToString() != "1" || dt4.Rows[m][5].ToString() != "2")
                                                            //    {
                                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                            //        write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                            //    }

                                                            //}

                                                            else
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            }


                                                        }
                                                        else
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                        }
                                                    }
                                                    else
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                    }


                                                }
                                                else
                                                {
                                                    // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                }
                                            }

                                        }
                                        else
                                        {
                                            if (dt4.Rows[w][2].ToString() == "FIM DE JORNADA")
                                            {
                                                int q = 0;
                                                q = w + 1;

                                                if (q < dt4.Rows.Count)
                                                {
                                                    if (dt4.Rows[q][2].ToString() == "FIM DE JORNADA")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                    }
                                                    else
                                                    {
                                                        int a = 0;
                                                        a = w - 1;

                                                        if (a >= 0)
                                                        {

                                                            if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM" || dt4.Rows[a][2].ToString() == "RETORNO REFEICAO" || dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                            }
                                                            //else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                            //{
                                                            //    if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                            //    {
                                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                            //        // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                            //        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //    }
                                                            //    else if (dt4.Rows[a][5].ToString() == "14")
                                                            //    {
                                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //        write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            //    }
                                                            //    else
                                                            //    {
                                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");


                                                            //    }
                                                            //}
                                                            else if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                            {

                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "FIM DE JORNADA")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            }
                                                            else
                                                            {
                                                                // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            }
                                                        }
                                                    }

                                                }
                                                else
                                                {
                                                    int a = 0;
                                                    a = w - 1;

                                                    if (a >= 0)
                                                    {

                                                        if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");

                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "RETORNO REFEICAO")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");

                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                        {
                                                            if (dt4.Rows[a][5].ToString() == "14")
                                                            {
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                            }
                                                            else
                                                            {
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            }
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");

                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                        }
                                                        //else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                        //{
                                                        //    if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                        //    {
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                        //        // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                        //        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //    }
                                                        //    else if (dt4.Rows[a][5].ToString() == "14")
                                                        //    {
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //        write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                        //    }
                                                        //    else
                                                        //    {
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");

                                                        //    }
                                                        //}
                                                        else if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                        {

                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "FIM DE JORNADA")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");

                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                        }
                                                        else
                                                        {
                                                            // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                        }
                                                    }
                                                    else
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                    }
                                                }
                                            }





                                        }


                                        #endregion

                                        #region PARADA PERNOITE

                                        if (dt4.Rows[w][2].ToString() == "PARADA PERNOITE")
                                        {
                                            int a = 0;
                                            a = w - 1;


                                            if (a >= 0)
                                            {
                                                if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                {


                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {

                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                        //WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;0102");
                                                        write.WriteLine("+00" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm").Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");


                                                    }
                                                    else if (dt4.Rows[a][5].ToString() == "15")
                                                    {

                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;22");


                                                    }
                                                    //else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");
                                                    //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //}
                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;22");
                                                    //}



                                                }
                                                else if (dt4.Rows[a][2].ToString() == "PARADA")
                                                {
                                                    //if (dt4.Rows[a][5].ToString() == "7")
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");
                                                    //}
                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {

                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                        //WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;0102");
                                                        write.WriteLine("+00" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm").Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");


                                                    }
                                                    else
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                    }

                                                }
                                                else if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM")
                                                {
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";2;22");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";3;22");
                                                }
                                                else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                {
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                    // write.WriteLine(cracha + ";" + data + ";" + hora + ";3;22");
                                                }
                                                //else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                //{


                                                //    if (dt4.Rows[a][5].ToString() == "14")
                                                //    {

                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                //        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");


                                                //    }
                                                //    //else if (dt4.Rows[a][5].ToString() == "15")
                                                //    //{

                                                //    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                //    //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");


                                                //    //}
                                                //    else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                //    {
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                //        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");
                                                //        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                //    }
                                                //    //else
                                                //    //{
                                                //    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;22");
                                                //    //}



                                                //}
                                                //else
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;22");
                                                //}

                                            }
                                            //else
                                            //{
                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;22");
                                            //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");

                                            //}

                                        }

                                        #endregion


                                        write.Flush();
                                        write.Close();
                                    }

                                    //FIM

                                    #endregion
                                }
                            }
                        }




                    }
                    else
                    {

                        string retorno = "Erro! Contate o administrador. Detalhes do erro 60340: Não há marcações";
                        System.Text.StringBuilder sb2 = new System.Text.StringBuilder();
                        sb2.Append("<script type = 'text/javascript'>");
                        sb2.Append("window.onload=function(){");
                        sb2.Append("alert('");
                        sb2.Append(retorno);
                        sb2.Append("')};");
                        sb2.Append("</script>");
                        ClientScript.RegisterClientScriptBlock(this.GetType(), "alert", sb2.ToString());
                    }




                }
            }

            CarregaLista();
            string message = "Gerado com Sucesso!";
            System.Text.StringBuilder sb = new System.Text.StringBuilder();
            sb.Append("<script type = 'text/javascript'>");
            sb.Append("window.onload=function(){");
            sb.Append("alert('");
            sb.Append(message);
            sb.Append("')};");
            sb.Append("</script>");
            ClientScript.RegisterClientScriptBlock(this.GetType(), "alert", sb.ToString());

            txtDtInicial.Text = "";
            Response.Redirect(Request.RawUrl);




            //}
            //catch (Exception ed)
            //{

            //}
        }

        public void Txt5e()
        {

            //try
            //{
            // string sql1 = "select nr_cracha from tb_motorista_txt";
            string sql1 = "select cod_login, ds_noturno from tb_motorista where ISNUMERIC(cod_login)=1 ";




            if (chkDiadema.Checked)
            {
                sql1 += " and ds_nucleo in('TNG CNT') ";
                //sql1 += " and cod_login in (330,912,1027,1058,958,1091,1099,1116,1219,1290,1338,1352,1274,1403,1421,1446,1395,1526,1532,1534,1544,1545,1543, ";
                //sql1 += " 1564,1570,1571,1584,482,999,820,989,1591,1590) ";
                //sql1 += " and cod_login in (636,906,1047,1064,1070,1075,1178,1231,1388,1412,1463,1464,1478,1485,1488,1490,1491,1492,1495,1496,1497,1498,1499,1500,1537,1539,1548,1549,1563,1567,1568,1569,1572,";
                //sql1 += " 1573,1574,1575,1576,1580,1581,1583,1585,1587,1588,10,21) ";
            }
            else if (chkCadiriri.Checked)
            {
                sql1 += " and ds_nucleo in('TNG MATRIZ') ";
                //sql1 += " and cod_login in (330,912,1027,1058,958,1091,1099,1116,1219,1290,1338,1352,1274,1403,1421,1446,1395,1526,1532,1534,1544,1545,1543, ";
                //sql1 += " 1564,1570,1571,1584,482,999,820,989,1591,1590) ";
                //sql1 += " and cod_login in (636,906,1047,1064,1070,1075,1178,1231,1388,1412,1463,1464,1478,1485,1488,1490,1491,1492,1495,1496,1497,1498,1499,1500,1537,1539,1548,1549,1563,1567,1568,1569,1572,";
                //sql1 += " 1573,1574,1575,1576,1580,1581,1583,1585,1587,1588,10,21) ";
            }
            else if (chkMinas.Checked)
            {
                sql1 += " and ds_nucleo='TNG MINAS' ";

            }
            //else if (chkBahia.Checked)
            //{
            //    sql1 += " and ds_nucleo='TNG BAHIA' ";
            //}
            else if (chkIpiranda.Checked)
            {
                sql1 += " and ds_nucleo='TNG IPIRANGA' ";
            }
            else if(chkMotorista.Checked)
            {
               
                 sql1 += " and cod_login='" + txtCodMotorista.Text + "' ";
               
                
            }
            sql1 += " order by cod_login";
            SqlDataAdapter adtp1 = new SqlDataAdapter(sql1, con);
            DataTable dt1 = new DataTable();

            try
            {
                con.Open();
                adtp1.Fill(dt1);
                con.Close();
            }
            catch (Exception ed)
            {
                //MessageBox.Show(ed.ToString(), "Erro1");
            }
            //string arquivo2 = "Transmot" + DateTime.Parse(txtDtInicial.Text).ToString("ddMM") + "002.txt";

            if (chkDiadema.Checked)
            {
                arquivo1 = "Tngcnt" + DateTime.Parse(txtDtInicial.Text).ToString("ddMM") + "a" + DateTime.Parse(txtDtFinal.Text).ToString("ddMM") + ".txt";
            }
            else if (chkCadiriri.Checked)
            {
                arquivo1 = "Tngmatriz" + DateTime.Parse(txtDtInicial.Text).ToString("ddMM") + "a" + DateTime.Parse(txtDtFinal.Text).ToString("ddMM") + ".txt";
            }
            else if (chkMinas.Checked)
            {
                arquivo1 = "Tngminas" + DateTime.Parse(txtDtInicial.Text).ToString("ddMM") + "a" + DateTime.Parse(txtDtFinal.Text).ToString("ddMM") + ".txt";

            }
            //else if (chkBahia.Checked)
            //{
            //    arquivo1 = "Tngbahia" + DateTime.Parse(txtDtInicial.Text).ToString("ddMM") + "a" + DateTime.Parse(txtDtFinal.Text).ToString("ddMM") + ".txt";
            //}
            else if (chkIpiranda.Checked)
            {
                arquivo1 = "Tngipiranga" + DateTime.Parse(txtDtInicial.Text).ToString("ddMM") + "a" + DateTime.Parse(txtDtFinal.Text).ToString("ddMM") + ".txt";
            }
            else if (chkMotorista.Checked)
            {
                arquivo1 = txtCodMotorista.Text + DateTime.Parse(txtDtInicial.Text).ToString("ddMM") + "a" + DateTime.Parse(txtDtFinal.Text).ToString("ddMM") + ".txt";
            }



            string caminho1 = Server.MapPath("/TXT/");

            string filepath1 = caminho1 + arquivo1;

            FileInfo file1 = new FileInfo(filepath1);
            if (file1.Exists)
            {
                file1.Delete();
            }


            for (int x = 0; x < dt1.Rows.Count; x++)
            {

                string sql_e = "select dt_posicao_parada from tb_parada where dt_posicao_parada between '" + DateTime.Parse(txtDtInicial.Text).ToString("yyyy-MM-dd") + "' and '" + DateTime.Parse(txtDtFinal.Text).ToString("yyyy-MM-dd") + "' and cod_cracha=" + dt1.Rows[x][0].ToString() + " and fl_deletado is null   group by dt_posicao_parada order by dt_posicao_parada asc";
                SqlDataAdapter adtpe = new SqlDataAdapter(sql_e, con);
                DataTable dte = new DataTable();
                try
                {
                    con.Open();
                    adtpe.Fill(dte);
                    con.Close();
                }
                catch (Exception ex)
                {
                    var message2 = new JavaScriptSerializer().Serialize(ex.Message.ToString());
                    string retorno = "Erro! Contate o administrador. Detalhes do erro 50586: " + message2;
                    string caminho = Server.MapPath("/TXT/");
                    StreamWriter write = new StreamWriter(caminho + "Erro.txt", true);
                    write.WriteLine(retorno);
                    write.Flush();
                    write.Close();


                }
                finally
                {
                    con.Close();
                }

                for (int f = 0; f < dte.Rows.Count; f++)
                {
                    string sql3 = "select * from tb_parada where cod_cracha='" + dt1.Rows[x][0].ToString() + "' and dt_posicao_parada ='" + DateTime.Parse(dte.Rows[f][0].ToString()).ToString("yyyy-MM-dd") + "' AND (ds_macro IN ('INICIO DE JORNADA', 'INICIO JORNADA CAMINHAO', 'PARADA REFEICAO', 'FIM DE JORNADA','REINICIO DE VIAGEM','FIM DE VIAGEM', 'PARADA','PARADA INTERNA','INICIO DE VIAGEM') OR cod_ref_parada in (2,3,4,14)) AND fl_deletado IS NULL ORDER BY dt_posicao_parada, hr_posicao";
                    SqlDataAdapter adtp3 = new SqlDataAdapter(sql3, con);
                    DataTable dt3 = new DataTable();
                    try
                    {
                        con.Open();
                        adtp3.Fill(dt3);
                        con.Close();
                    }
                    catch (Exception ex)
                    {
                        var message2 = new JavaScriptSerializer().Serialize(ex.Message.ToString());
                        string retorno = "Erro! Contate o administrador. Detalhes do erro 50613: " + message2 + " || Data:" + DateTime.Parse(dte.Rows[f][0].ToString()).ToString();
                        string caminho = Server.MapPath("/TXT/");
                        StreamWriter write = new StreamWriter(caminho + "Erro.txt", true);
                        write.WriteLine(retorno);
                        write.Flush();
                        write.Close();


                    }
                    finally
                    {
                        con.Close();
                    }
                    if (chkDiadema.Checked)
                    {
                        arquivo = "Tngcnt" + DateTime.Parse(txtDtInicial.Text).ToString("ddMM") + "a" + DateTime.Parse(txtDtFinal.Text).ToString("ddMM") + ".txt";
                    }
                    else if (chkCadiriri.Checked)
                    {
                        arquivo = "Tngmatriz" + DateTime.Parse(txtDtInicial.Text).ToString("ddMM") + "a" + DateTime.Parse(txtDtFinal.Text).ToString("ddMM") + ".txt";
                    }
                    else if (chkMinas.Checked)
                    {
                        arquivo = "Tngminas" + DateTime.Parse(txtDtInicial.Text).ToString("ddMM") + "a" + DateTime.Parse(txtDtFinal.Text).ToString("ddMM") + ".txt";

                    }
                    //else if (chkBahia.Checked)
                    //{
                    //    arquivo = "Tngbahia" + DateTime.Parse(txtDtInicial.Text).ToString("ddMM") + "a" + DateTime.Parse(txtDtFinal.Text).ToString("ddMM") + ".txt";
                    //}
                    else if (chkIpiranda.Checked)
                    {
                        arquivo = "Tngipiranga" + DateTime.Parse(txtDtInicial.Text).ToString("ddMM") + "a" + DateTime.Parse(txtDtFinal.Text).ToString("ddMM") + ".txt";
                    }
                    else if (chkMotorista.Checked)
                    {
                        arquivo = txtCodMotorista.Text + DateTime.Parse(txtDtInicial.Text).ToString("ddMM") + "a" + DateTime.Parse(txtDtFinal.Text).ToString("ddMM") + ".txt";
                    }
                    else
                    {
                        arquivo = "Todos" + DateTime.Parse(txtDtInicial.Text).ToString("ddMM") + "a" + DateTime.Parse(txtDtFinal.Text).ToString("ddMM") + ".txt";
                    }





                    if (dt3.Rows.Count > 0)
                    {

                        if (dt3.Rows[0][6].ToString() == "INICIO DE JORNADA")
                        {

                            //VERIFICA SE A ULTIMA MARCAÇÃO DO DIA É PARADA PERNOITE OU FIM DE JORNADA
                            string sqlv = "select TOP 1 ds_macro  from tb_parada where cod_cracha=" + dt1.Rows[x][0].ToString() + " and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).ToString("yyyy-MM-dd") + "' and fl_deletado is null order by hr_posicao  DESC ";
                            SqlDataAdapter adtpv = new SqlDataAdapter(sqlv, con);
                            DataTable dtv = new DataTable();
                            con.Open();
                            adtpv.Fill(dtv);
                            con.Close();


                            if (dtv.Rows[0][0].ToString() == "FIM DE JORNADA" || dtv.Rows[0][0].ToString() == "PARADA PERNOITE")
                            {

                                //JORNADA NORMAL INICIO DE JORNADA
                                #region Jornada Normal
                                //string arquivo = "Transmot" + DateTime.Parse(txtDtInicial.Text).ToString("ddMM") + "001.txt";

                                sql4 = "select dt_posicao_parada, hr_posicao, ds_macro,cod_transmissao, cod_cracha, isnull(cod_ref_parada,0) as cod_ref_parada, cod_idveiculo from tb_parada where fl_deletado is null and cod_cracha=" + dt1.Rows[x][0].ToString() + " and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).ToString("yyyy-MM-dd") + "' AND (ds_macro IN ('INICIO DE JORNADA', 'INICIO JORNADA CAMINHAO', 'PARADA REFEICAO', 'FIM DE JORNADA','REINICIO DE VIAGEM','FIM DE VIAGEM', 'PARADA','PARADA INTERNA','INICIO DE VIAGEM','RETORNO REFEICAO','PARADA CLIENTE / FORNECEDOR','PARADA PERNOITE') OR cod_ref_parada in (2,3,4,14,22)) AND fl_deletado IS NULL ORDER BY dt_posicao_parada, hr_posicao";
                                // string sql4 = "select dt_posicao_parada, hr_posicao, ds_macro,cod_transmissao, cod_cracha, isnull(cod_ref_parada,0) as cod_ref_parada, cod_idveiculo from tb_parada where fl_deletado is null and cod_cracha=" + dt1.Rows[x][0].ToString() + " and dt_posicao_parada between '" + txtDtInicial.Text + "' and '" + txtDtFinal.Text + "' order by dt_posicao_parada, hr_posicao";
                                SqlDataAdapter adtp4 = new SqlDataAdapter(sql4, con);
                                DataTable dt4 = new DataTable();

                                try
                                {
                                    con.Open();
                                    adtp4.Fill(dt4);
                                    con.Close();
                                }
                                catch (Exception ed)
                                {
                                    // MessageBox.Show(ed.ToString(), "Erro3");
                                }

                                c = 0;

                                for (int y = 0; y < dt4.Rows.Count; y++)
                                {
                                    if (dt4.Rows[y][2].ToString() == "FIM DE JORNADA" && dt4.Rows[y][6].ToString() == "725405" || dt4.Rows[y][2].ToString() == "FIM DE JORNADA" && dt4.Rows[y][6].ToString() == "725407" || dt4.Rows[y][2].ToString() == "FIM DE JORNADA" && dt4.Rows[y][6].ToString() == "184525")
                                    {
                                        c = c + 1;
                                    }

                                }
                                string caminho = Server.MapPath("/TXT/");

                                string filepath = caminho + arquivo;

                                FileInfo file = new FileInfo(filepath);

                                //if (file.Exists)
                                //{
                                //    file.Delete();
                                //}


                                for (int w = 0; w < dt4.Rows.Count; w++)
                                {


                                    string codigo = dt1.Rows[x][0].ToString();
                                    string[] codigosEspeciais = { "330", "482", "820", "958", "989" };

                                    if (codigo.StartsWith("312"))
                                    {
                                        cracha = codigo.Insert(3, "0");
                                    }
                                    else if ((codigosEspeciais.Contains(codigo) || codigo.Length <= 4))
                                    {
                                        cracha = "30" + codigo;
                                    }
                                    else if (codigo.Length <= 3)
                                    {
                                        cracha = "300" + codigo;
                                    }

                                    else
                                    {
                                        cracha = codigo;
                                    }




                                    int t = 0;
                                    t = w - 1;

                                    string data = DateTime.Parse(dt4.Rows[w][0].ToString()).ToString("dd/MM/yy");
                                    string horas = DateTime.Parse(dt4.Rows[w][1].ToString()).ToString("HH:mm");
                                    if (t >= 0)
                                    {
                                        if (DateTime.Parse(dt4.Rows[w][1].ToString()).ToString("HH:mm") == DateTime.Parse(dt4.Rows[t][1].ToString()).ToString("HH:mm"))
                                        {
                                            hora = DateTime.Parse(horas).AddMinutes(1).ToString("HH:mm");
                                        }
                                        else
                                        {
                                            hora = DateTime.Parse(horas).ToString("HH:mm");
                                        }
                                    }
                                    else
                                    {
                                        hora = DateTime.Parse(horas).ToString("HH:mm");
                                    }
                                    //tipo = dt4.Rows[w][2].ToString();
                                    string transmissao = dt4.Rows[w][3].ToString();


                                    //if (dt4.Rows[w][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[w][2].ToString() == "TRECHO ALMOÇO" || dt4.Rows[w][2].ToString() == "FIM DE JORNADA")
                                    //{
                                    //    tipo = "2";
                                    //}
                                    //else  if (dt4.Rows[w][2].ToString() == "PARADA FORNECEDOR" || dt4.Rows[w][2].ToString() == "REINICIO DE VIAGEM")
                                    //{
                                    //    tipo = "21";
                                    //}






                                    StreamWriter write = new StreamWriter(caminho + arquivo, true);




                                    #region BLOCO INICIO JORNADA
                                    //BLOCO INICIO JORNADA
                                    if (dt4.Rows[w][2].ToString() == "INICIO DE JORNADA")
                                    {
                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");
                                    }

                                    if (dt4.Rows[w][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[w][2].ToString() == "INICIO JORNADA")
                                    {

                                        int a = 0;
                                        a = w - 1;
                                        if (a >= 0)
                                        {
                                            if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                            {
                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");

                                            }
                                            else
                                            {
                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");

                                            }
                                        }
                                        else
                                        {
                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                        }


                                    }
                                    //FIM
                                    #endregion

                                    #region BLOCO INICIO JORNADA CAMINHAO
                                    //BLOCO INICIO JORNADA CAMINHAO

                                    if (dt4.Rows[w][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[w][2].ToString() == "INICIO JORNADA")
                                    {

                                        int a = 0;
                                        a = w - 1;
                                        if (a >= 0)
                                        {
                                            if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                            {
                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");

                                            }
                                            else
                                            {
                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");
                                            }
                                        }
                                        else
                                        {
                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                        }


                                    }
                                    //FIM
                                    #endregion

                                    #region PARADA INTERNA
                                    //BLOCO PARADA INTERNA
                                    if (dt4.Rows[w][2].ToString() == "PARADA INTERNA")
                                    {
                                        if (dt4.Rows[w][5].ToString() == "3" || dt4.Rows[w][5].ToString() == "2")
                                        {
                                            int a = 0;
                                            a = w - 1;
                                            if (a >= 0)
                                            {
                                                if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                }
                                                else if (dt4.Rows[a][5].ToString() == "14")
                                                {
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                }
                                                else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "1")
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                }
                                                else if (dt4.Rows[a][2].ToString() == "PARADA REFEICAO")
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                }
                                                else if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM")
                                                {
                                                    //////write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    ////write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    ////write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                }
                                                else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                }
                                                else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                }
                                                else
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                }

                                            }

                                        }
                                        else if (dt4.Rows[w][5].ToString() == "14")
                                        {
                                            int a = 0;
                                            a = w - 1;
                                            if (a >= 0)
                                            {
                                                if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                {
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                }
                                                if (dt4.Rows[a][5].ToString() == "14")
                                                {
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                }
                                                else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "1")
                                                {
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                }
                                                else if (dt4.Rows[a][2].ToString() == "PARADA REFEICAO")
                                                {
                                                    // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                }
                                                else if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                {
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                }
                                                else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                {

                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");

                                                }
                                                if (dt4.Rows[a][5].ToString() == "22")
                                                {
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                }
                                                //else
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93: 71489");
                                                //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                //}

                                            }
                                        }
                                        else if (dt4.Rows[w][5].ToString() == "22")
                                        {
                                            int a = 0;
                                            a = w - 1;
                                            if (a >= 0)
                                            {

                                                if (dt4.Rows[a][5].ToString() == "14")
                                                {
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                }


                                            }
                                        }
                                        else
                                        {
                                            int a = 0;
                                            a = w - 1;
                                            if (a >= 0)
                                            {
                                                if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");
                                                }
                                                if (dt4.Rows[a][5].ToString() == "14")
                                                {
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                }

                                                else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "1")
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");
                                                }
                                                else if (dt4.Rows[a][2].ToString() == "PARADA REFEICAO")
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                    //// write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                }
                                                else if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                {

                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");
                                                }
                                                else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                {

                                                    //// write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");

                                                }

                                            }
                                        }

                                    }
                                    //FIM 
                                    #endregion

                                    #region BLOCO PARADA REFEIÇÃO
                                    //BLOCO PARADA REFEIÇÃO
                                    if (dt4.Rows[w][2].ToString() == "PARADA REFEICAO")
                                    {
                                        int a = 0;
                                        a = w - 1;
                                        if (a >= 0)
                                        {
                                            //if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                            //{

                                            //    if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                            //    {
                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;93");
                                            //    }
                                            //    else
                                            //    {
                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;93");
                                            //    }
                                            //}
                                            if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                            {
                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");

                                            }
                                            else
                                            {
                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                            }

                                        }
                                        //else
                                        //{
                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;93");
                                        //}
                                    }
                                    //FIM
                                    #endregion

                                    #region RETORNO REFEIÇAO
                                    //BLOCO RETORNO REFEIÇAO
                                    if (dt4.Rows[w][2].ToString() == "RETORNO REFEICAO")
                                    {

                                        int a = 0;
                                        int b = 0;
                                        a = w - 1;
                                        b = w + 1;
                                        if (a >= 0)
                                        {

                                            if (dt4.Rows[a][2].ToString() == "PARADA REFEICAO")
                                            {

                                                // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;0102");
                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");

                                            }
                                            //if (dt4.Rows[b][2].ToString() == "FIM DE JORNADA")
                                            //{
                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                            //}
                                            //else
                                            //{
                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                            //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");

                                            //}
                                        }


                                    }
                                    //FIM
                                    #endregion

                                    #region INICIO DE VIAGEM
                                    //BLOCO REINICIO / INICIO DE VIAGEM
                                    if (dt4.Rows[w][2].ToString() == "INICIO DE VIAGEM")
                                    {
                                        int a = 0;
                                        a = w - 1;
                                        if (a >= 0)
                                        {
                                            //if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                            //{
                                            //    if (dt4.Rows[a][5].ToString() == "14")
                                            //    {
                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");

                                            //    }
                                            //    else
                                            //        if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                            //    {
                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");

                                            //    }
                                            //    else
                                            //    {
                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                            //    }
                                            //}
                                            //if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                            //{
                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                            //}
                                            //else if (dt4.Rows[a][2].ToString() == "PARADA PERNOITE")
                                            //{
                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;22");
                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                            //}
                                            //else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                            //{
                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                            //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                            //}

                                            if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                            {


                                                if (dt4.Rows[a][5].ToString() == "14")
                                                {

                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");



                                                }
                                                //else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "1" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "4")
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                //}



                                            }
                                            else if (dt4.Rows[a][2].ToString() == "PARADA")
                                            {


                                                if (dt4.Rows[a][5].ToString() == "14")
                                                {

                                                    // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                }
                                                //else
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");



                                                //}



                                            }
                                            //else if (dt4.Rows[a][2].ToString() == "RETORNO REFEICAO")
                                            //{
                                            //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                            //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                            //    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");

                                            //}

                                        }
                                        //else
                                        //{
                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                        //}



                                    }
                                    //FIM
                                    #endregion

                                    #region PARADA CLIENTE / FORNECEDOR
                                    if (dt4.Rows[w][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                    {
                                        if (dt4.Rows[w][5].ToString() == "3" || dt4.Rows[w][5].ToString() == "2" || dt4.Rows[w][5].ToString() == "4")
                                        {
                                            int a = 0;
                                            a = w - 1;
                                            if (a >= 0)
                                            {
                                                //if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                //}
                                                if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                {
                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;0102");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");


                                                    }
                                                    //else if (dt4.Rows[a][5].ToString() == "15")
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");

                                                    //}
                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                    //}

                                                }
                                            }

                                        }
                                        else if (dt4.Rows[w][5].ToString() == "14")
                                        {
                                            int a = 0;
                                            a = w - 1;
                                            if (a >= 0)
                                            {
                                                if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                    // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                }
                                                else if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                {
                                                    if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "4")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                    }
                                                    else if (dt4.Rows[a][5].ToString() == "14")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");

                                                    }


                                                }
                                                else
                                                {
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                }

                                            }


                                        }


                                    }
                                    #endregion

                                    #region REINICIO
                                    //BLOCO REINICIO / INICIO DE VIAGEM
                                    if (dt4.Rows[w][2].ToString() == "REINICIO DE VIAGEM")
                                    {
                                        int a = 0;
                                        a = w - 1;
                                        if (a >= 0)
                                        {
                                            if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                            {

                                            }
                                            else if (dt4.Rows[a][2].ToString() == "PARADA PERNOITE")
                                            {
                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");
                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                            }

                                            else if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                            {

                                                if (a >= 0)
                                                {

                                                    if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                    {
                                                        //if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                        //}
                                                        if (dt4.Rows[a][5].ToString() == "14")
                                                        {

                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");

                                                        }
                                                        //else if (dt4.Rows[a][5].ToString() == "15")
                                                        //{

                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");

                                                        //}
                                                        //else
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                        //}
                                                    }
                                                    //else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                    //}


                                                }



                                            }
                                            else if (dt4.Rows[a][2].ToString() == "PARADA")
                                            {
                                                if (dt4.Rows[a][5].ToString() == "14")
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                }
                                                //else
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                //}




                                            }
                                            //else if (dt4.Rows[a][2].ToString() == "OFICINA / MANUTENCAO")
                                            //{

                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");


                                            //}

                                        }
                                        else
                                        {
                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");
                                            // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                        }



                                    }
                                    //FIM
                                    #endregion

                                    #region BLOCO PARADA
                                    // BLOCO PARADA
                                    if (dt4.Rows[w][2].ToString() == "PARADA")
                                    {
                                        int a = 0;
                                        a = w - 1;


                                        if (dt4.Rows[w][5].ToString() == "14")
                                        {
                                            if (dt4.Rows.Count >= a)
                                            {
                                                if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                {
                                                    // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");


                                                }

                                            }
                                        }
                                        //else
                                        //{
                                        //    if (dt4.Rows.Count >= a)
                                        //    {
                                        //        if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                        //        {
                                        //            write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                        //            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");

                                        //        }
                                        //        //else
                                        //        //{
                                        //        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                        //        //    // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                        //        //}
                                        //    }
                                        //}



                                        //  write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");

                                    }
                                    //FIM
                                    #endregion

                                    #region FIM DE VIAGEM
                                    //BLOCO FIM DE VIAGEM
                                    if (dt4.Rows[w][2].ToString() == "FIM DE VIAGEM")
                                    {
                                        int a = 0;
                                        int g = 0;
                                        a = w - 1;
                                        g = w - 2;
                                        if (a >= 0)
                                        {
                                            if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                            {


                                                if (dt4.Rows[a][5].ToString() == "14")
                                                {

                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;0102");

                                                }

                                                //else if (dt4.Rows[a][5].ToString() == "14")
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                //    // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                //}

                                                //else
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                //    // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                //}



                                            }
                                            else if (dt4.Rows[a][2].ToString() == "PARADA")
                                            {


                                                if (dt4.Rows[a][5].ToString() == "14")
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;0102");

                                                }

                                                //else
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                //    // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");

                                                //}


                                            }

                                            else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                            {
                                                if (g >= 0)
                                                {
                                                    //if (dt4.Rows[g][2].ToString() == "PARADA PERNOITE")
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                    //}
                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //}
                                                }
                                                //else
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                //}


                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                            }


                                        }
                                        //else
                                        //{
                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                        //}

                                    }

                                    //
                                    #endregion

                                    #region FIM DE JORNADA
                                    //BLOCO FIM DE JORMADA
                                    if (c > 0)
                                    {
                                        if (dt4.Rows[w][2].ToString() == "FIM DE JORNADA" && dt4.Rows[w][6].ToString() == "725405" || dt4.Rows[w][2].ToString() == "FIM DE JORNADA" && dt4.Rows[w][6].ToString() == "725407" || dt4.Rows[w][2].ToString() == "FIM DE JORNADA" && dt4.Rows[w][6].ToString() == "184525" && dt4.Rows[w][6].ToString() == "184522")
                                        {
                                            int a = 0;
                                            a = w - 1;

                                            if (a >= 0)
                                            {
                                                if (dt4.Rows[a][2].ToString() == "RETORNO REFEICAO")
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                }
                                                else if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                {

                                                    //WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");


                                                }
                                                else if (dt4.Rows[a][2].ToString() == "RETORNO REFEICAO")
                                                {

                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");

                                                }
                                                else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                {
                                                    int b = 0;
                                                    b = a - 1;

                                                    if (b >= 0)
                                                    {
                                                        if (dt4.Rows[b][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[b][2].ToString() == "REINICIO DE VIAGEM")
                                                        {
                                                            int d = 0;
                                                            d = b - 1;
                                                            if (d >= 0)
                                                            {

                                                                if (dt4.Rows[d][2].ToString() == "PARADA")
                                                                {
                                                                    if (dt4.Rows[d][5].ToString() == "14")
                                                                    {
                                                                        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                    }
                                                                    else
                                                                    {
                                                                        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                        // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                    }




                                                                }
                                                                else
                                                                {
                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                    // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                }
                                                            }
                                                        }
                                                        else
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                        }

                                                    }
                                                    else
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                    }

                                                }
                                                else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                }
                                                else if (dt4.Rows[a][2].ToString() == "PARADA")
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                }
                                                else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                {
                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                    }
                                                    else
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                    }
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");

                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                }
                                                else if (dt4.Rows[a][2].ToString() == "FIM DE JORNADA")
                                                {
                                                    int m = 0;
                                                    m = a - 1;

                                                    if (m >= 0)
                                                    {
                                                        if (dt4.Rows[m][2].ToString() == "RETORNO REFEICAO" || dt4.Rows[m][2].ToString() == "INICIO DE JORNADA")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        }
                                                        else if (dt4.Rows[m][2].ToString() == "FIM DE VIAGEM")
                                                        {
                                                            int b = 0;
                                                            b = m - 1;

                                                            if (b >= 0)
                                                            {
                                                                if (dt4.Rows[b][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[b][2].ToString() == "REINICIO DE VIAGEM")
                                                                {
                                                                    int d = 0;
                                                                    d = b - 1;
                                                                    if (d >= 0)
                                                                    {

                                                                        if (dt4.Rows[d][2].ToString() == "PARADA")
                                                                        {
                                                                            if (dt4.Rows[d][5].ToString() == "14")
                                                                            {
                                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                                //.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                            }
                                                                            else
                                                                            {
                                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                                            }


                                                                        }
                                                                        else
                                                                        {
                                                                            // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                        }
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                }

                                                            }


                                                        }
                                                        //else if (dt4.Rows[m][2].ToString() == "REINICIO DE VIAGEM")
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //}
                                                        //else if (dt4.Rows[m][2].ToString() == "PARADA INTERNA")
                                                        //{
                                                        //    if (dt4.Rows[m][5].ToString() == "3" || dt4.Rows[m][5].ToString() == "1" || dt4.Rows[m][5].ToString() == "2")
                                                        //    {
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");

                                                        //    }
                                                        //    else if (dt4.Rows[m][5].ToString() == "22")
                                                        //    {
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                        //    }

                                                        //    else if (dt4.Rows[m][2].ToString() == "FIM DE JORNADA")
                                                        //    {
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //        write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                        //    }

                                                        //}
                                                        else if (dt4.Rows[m][2].ToString() == "PARADA")
                                                        {
                                                            // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                        }
                                                        //else if (dt4.Rows[m][2].ToString() == "PARADA INTERNA")
                                                        //{
                                                        //    if (dt4.Rows[m][5].ToString() != "3" || dt4.Rows[m][5].ToString() != "1" || dt4.Rows[m][5].ToString() != "2")
                                                        //    {
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                        //        write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                        //    }

                                                        //}

                                                        else
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                        }


                                                    }
                                                    else
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                    }
                                                }
                                                else
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                }


                                            }
                                            else
                                            {
                                                // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                            }
                                        }

                                    }
                                    else
                                    {
                                        if (dt4.Rows[w][2].ToString() == "FIM DE JORNADA")
                                        {
                                            int q = 0;
                                            q = w + 1;

                                            if (q < dt4.Rows.Count)
                                            {
                                                if (dt4.Rows[q][2].ToString() == "FIM DE JORNADA")
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                }
                                                else
                                                {
                                                    int a = 0;
                                                    a = w - 1;

                                                    if (a >= 0)
                                                    {

                                                        if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM" || dt4.Rows[a][2].ToString() == "RETORNO REFEICAO" || dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                        }
                                                        //else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                        //{
                                                        //    if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                        //    {
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                        //        // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                        //        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //    }
                                                        //    else if (dt4.Rows[a][5].ToString() == "14")
                                                        //    {
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //        write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                        //    }
                                                        //    else
                                                        //    {
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");


                                                        //    }
                                                        //}
                                                        else if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                        {

                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "FIM DE JORNADA")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                        }
                                                        else
                                                        {
                                                            // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                        }
                                                    }
                                                }

                                            }
                                            else
                                            {
                                                int a = 0;
                                                a = w - 1;

                                                if (a >= 0)
                                                {

                                                    if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");

                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "RETORNO REFEICAO")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");

                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                    {
                                                        if (dt4.Rows[a][5].ToString() == "14")
                                                        {
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                        }
                                                        else
                                                        {
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        }
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");

                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                    }
                                                    //else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                    //{
                                                    //    if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                    //    {
                                                    //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                    //        // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                    //        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //    }
                                                    //    else if (dt4.Rows[a][5].ToString() == "14")
                                                    //    {
                                                    //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //        write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                    //    }
                                                    //    else
                                                    //    {
                                                    //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");

                                                    //    }
                                                    //}
                                                    else if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                    {

                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "FIM DE JORNADA")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");

                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                    }
                                                    else
                                                    {
                                                        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                    }
                                                }
                                                else
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                }
                                            }
                                        }





                                    }


                                    #endregion

                                    #region PARADA PERNOITE

                                    if (dt4.Rows[w][2].ToString() == "PARADA PERNOITE")
                                    {
                                        int a = 0;
                                        a = w - 1;


                                        if (a >= 0)
                                        {
                                            if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                            {


                                                if (dt4.Rows[a][5].ToString() == "14")
                                                {

                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                    //WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;0102");
                                                    write.WriteLine("+00" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm").Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");


                                                }
                                                else if (dt4.Rows[a][5].ToString() == "15")
                                                {

                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;22");


                                                }
                                                //else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");
                                                //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                //}
                                                else
                                                {
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                }



                                            }
                                            else if (dt4.Rows[a][2].ToString() == "PARADA")
                                            {
                                                //if (dt4.Rows[a][5].ToString() == "7")
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");
                                                //}
                                                if (dt4.Rows[a][5].ToString() == "14")
                                                {

                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                    //WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;0102");
                                                    write.WriteLine("+00" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm").Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");


                                                }
                                                else
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                }

                                            }
                                            else if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM")
                                            {
                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";2;22");
                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";3;22");
                                            }
                                            else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                            {
                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                // write.WriteLine(cracha + ";" + data + ";" + hora + ";3;22");
                                            }
                                            //else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                            //{


                                            //    if (dt4.Rows[a][5].ToString() == "14")
                                            //    {

                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                            //        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");


                                            //    }
                                            //    //else if (dt4.Rows[a][5].ToString() == "15")
                                            //    //{

                                            //    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                            //    //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");


                                            //    //}
                                            //    else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                            //    {
                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                            //        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");
                                            //        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                            //    }
                                            //    //else
                                            //    //{
                                            //    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;22");
                                            //    //}



                                            //}
                                            //else
                                            //{
                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;22");
                                            //}

                                        }
                                        //else
                                        //{
                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;22");
                                        //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");

                                        //}

                                    }

                                    #endregion



                                    write.Flush();
                                    write.Close();



                                }

                                //FIM

                                #endregion
                            }
                            else
                            {
                                //JORNADA PERNOITE INICIO DE JORNADA
                                string sqli = "select top 1  hr_posicao from tb_parada where cod_cracha=" + dt1.Rows[x][0].ToString() + " and ds_macro = 'INICIO DE JORNADA' and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).ToString("yyyy-MM-dd") + "' and fl_deletado is null order by hr_posicao";
                                SqlDataAdapter adtpi = new SqlDataAdapter(sqli, con);
                                DataTable dti = new DataTable();
                                con.Open();
                                adtpi.Fill(dti);
                                con.Close();

                                string sqlf = "select top 1 hr_posicao from tb_parada where cod_cracha=" + dt1.Rows[x][0].ToString() + " and ds_macro = 'FIM DE JORNADA' and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).AddDays(1).ToString("yyyy-MM-dd") + "' and fl_deletado is null OR cod_cracha=" + dt1.Rows[x][0].ToString() + " and ds_macro='PARADA PERNOITE' and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).AddDays(1).ToString("yyyy-MM-dd") + "' and fl_deletado is null order by hr_posicao";
                                SqlDataAdapter adtpf = new SqlDataAdapter(sqlf, con);
                                DataTable dtf = new DataTable();
                                con.Open();
                                adtpf.Fill(dtf);
                                con.Close();



                                if (dti.Rows.Count > 0 && dtf.Rows.Count > 0)
                                {
                                    sql4 = "select dt_posicao_parada, hr_posicao, ds_macro,cod_transmissao, cod_cracha, isnull(cod_ref_parada,0) as cod_ref_parada, cod_idveiculo from tb_parada where fl_deletado is null and cod_cracha=" + dt1.Rows[x][0].ToString() + " and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).ToString("yyyy-MM-dd") + "' and hr_posicao >='" + dti.Rows[0][0].ToString() + "' or cod_cracha=" + dt1.Rows[x][0].ToString() + " and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).AddDays(1).ToString("yyyy-MM-dd") + "' and hr_posicao <= '" + dtf.Rows[0][0].ToString() + "' AND (ds_macro IN ('INICIO DE JORNADA', 'INICIO JORNADA CAMINHAO', 'PARADA REFEICAO', 'FIM DE JORNADA','REINICIO DE VIAGEM','FIM DE VIAGEM', 'PARADA','PARADA INTERNA','INICIO DE VIAGEM','PARADA INTERNA','RETORNO REFEICAO','PARADA CLIENTE / FORNECEDOR','PARADA PERNOITE') OR cod_ref_parada in (2,3,4,14,22)) AND fl_deletado IS NULL ORDER BY dt_posicao_parada, hr_posicao";
                                    SqlDataAdapter adtp4 = new SqlDataAdapter(sql4, con);
                                    DataTable dt4 = new DataTable();
                                    con.Open();
                                    adtp4.Fill(dt4);
                                    con.Close();

                                    #region Jornada Noturna




                                    try
                                    {
                                        con.Open();
                                        adtp4.Fill(dt4);
                                        con.Close();
                                    }
                                    catch (Exception ed)
                                    {
                                        //MessageBox.Show(ed.ToString(), "Erro3");
                                    }

                                    c = 0;

                                    for (int y = 0; y < dt4.Rows.Count; y++)
                                    {
                                        if (dt4.Rows[y][2].ToString() == "FIM DE JORNADA" && dt4.Rows[y][6].ToString() == "725405" || dt4.Rows[y][2].ToString() == "FIM DE JORNADA" && dt4.Rows[y][6].ToString() == "725407" || dt4.Rows[y][2].ToString() == "FIM DE JORNADA" && dt4.Rows[y][6].ToString() == "184525")
                                        {
                                            c = c + 1;
                                        }

                                    }
                                    string caminho = Server.MapPath("/TXT/");

                                    string filepath = caminho + arquivo;

                                    FileInfo file = new FileInfo(filepath);
                                    //if(file.Exists)
                                    //{
                                    //    file.Delete();
                                    //}



                                    for (int w = 0; w < dt4.Rows.Count; w++)
                                    {

                                        string codigo = dt1.Rows[x][0].ToString();
                                        string[] codigosEspeciais = { "330", "482", "820", "958", "989" };

                                        if (codigo.StartsWith("312"))
                                        {
                                            cracha = codigo.Insert(3, "0");
                                        }
                                        else if ((codigosEspeciais.Contains(codigo) || codigo.Length <= 4))
                                        {
                                            cracha = "30" + codigo;
                                        }
                                        else if (codigo.Length <= 3)
                                        {
                                            cracha = "300" + codigo;
                                        }

                                        else
                                        {
                                            cracha = codigo;
                                        }

                                        int t = 0;
                                        t = w - 1;

                                        string data = DateTime.Parse(dt4.Rows[w][0].ToString()).ToString("dd/MM/yy");
                                        string horas = DateTime.Parse(dt4.Rows[w][1].ToString()).ToString("HH:mm");
                                        if (t >= 0)
                                        {
                                            if (DateTime.Parse(dt4.Rows[w][1].ToString()).ToString("HH:mm") == DateTime.Parse(dt4.Rows[t][1].ToString()).ToString("HH:mm"))
                                            {
                                                hora = DateTime.Parse(horas).AddMinutes(1).ToString("HH:mm");
                                            }
                                            else
                                            {
                                                hora = DateTime.Parse(horas).ToString("HH:mm");
                                            }
                                        }
                                        else
                                        {
                                            hora = DateTime.Parse(horas).ToString("HH:mm");
                                        }
                                        //tipo = dt4.Rows[w][2].ToString();
                                        string transmissao = dt4.Rows[w][3].ToString();


                                        //if (dt4.Rows[w][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[w][2].ToString() == "TRECHO ALMOÇO" || dt4.Rows[w][2].ToString() == "FIM DE JORNADA")
                                        //{
                                        //    tipo = "2";
                                        //}
                                        //else  if (dt4.Rows[w][2].ToString() == "PARADA FORNECEDOR" || dt4.Rows[w][2].ToString() == "REINICIO DE VIAGEM")
                                        //{
                                        //    tipo = "21";
                                        //}



                                        StreamWriter write = new StreamWriter(caminho + arquivo, true);

                                        #region BLOCO INICIO JORNADA
                                        //BLOCO INICIO JORNADA
                                        if (dt4.Rows[w][2].ToString() == "INICIO DE JORNADA")
                                        {
                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");
                                        }

                                        if (dt4.Rows[w][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[w][2].ToString() == "INICIO JORNADA")
                                        {

                                            int a = 0;
                                            a = w - 1;
                                            if (a >= 0)
                                            {
                                                if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");

                                                }
                                                else
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");

                                                }
                                            }
                                            else
                                            {
                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                            }


                                        }
                                        //FIM
                                        #endregion

                                        #region BLOCO INICIO JORNADA CAMINHAO
                                        //BLOCO INICIO JORNADA CAMINHAO

                                        if (dt4.Rows[w][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[w][2].ToString() == "INICIO JORNADA")
                                        {

                                            int a = 0;
                                            a = w - 1;
                                            if (a >= 0)
                                            {
                                                if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");

                                                }
                                                else
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");
                                                }
                                            }
                                            else
                                            {
                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                            }


                                        }
                                        //FIM
                                        #endregion

                                        #region PARADA INTERNA
                                        //BLOCO PARADA INTERNA
                                        if (dt4.Rows[w][2].ToString() == "PARADA INTERNA")
                                        {
                                            if (dt4.Rows[w][5].ToString() == "3" || dt4.Rows[w][5].ToString() == "2")
                                            {
                                                int a = 0;
                                                a = w - 1;
                                                if (a >= 0)
                                                {
                                                    if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                    }
                                                    else if (dt4.Rows[a][5].ToString() == "14")
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                    }
                                                    else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "1")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "PARADA REFEICAO")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM")
                                                    {
                                                        //////write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        ////write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        ////write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                    }
                                                    else
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                    }

                                                }

                                            }
                                            else if (dt4.Rows[w][5].ToString() == "14")
                                            {
                                                int a = 0;
                                                a = w - 1;
                                                if (a >= 0)
                                                {
                                                    if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                    }
                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                    }
                                                    else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "1")
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "PARADA REFEICAO")
                                                    {
                                                        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                    {

                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");

                                                    }
                                                    if (dt4.Rows[a][5].ToString() == "22")
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                    }
                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93: 71489");
                                                    //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                    //}

                                                }
                                            }
                                            else if (dt4.Rows[w][5].ToString() == "22")
                                            {
                                                int a = 0;
                                                a = w - 1;
                                                if (a >= 0)
                                                {

                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                    }


                                                }
                                            }
                                            else
                                            {
                                                int a = 0;
                                                a = w - 1;
                                                if (a >= 0)
                                                {
                                                    if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");
                                                    }
                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                    }

                                                    else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "1")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "PARADA REFEICAO")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                        //// write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                    {

                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                    {

                                                        //// write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");

                                                    }

                                                }
                                            }

                                        }
                                        //FIM 
                                        #endregion

                                        #region BLOCO PARADA REFEIÇÃO
                                        //BLOCO PARADA REFEIÇÃO
                                        if (dt4.Rows[w][2].ToString() == "PARADA REFEICAO")
                                        {
                                            int a = 0;
                                            a = w - 1;
                                            if (a >= 0)
                                            {
                                                //if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                //{

                                                //    if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                //    {
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;93");
                                                //    }
                                                //    else
                                                //    {
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;93");
                                                //    }
                                                //}
                                                if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");

                                                }
                                                else
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                }

                                            }
                                            //else
                                            //{
                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;93");
                                            //}
                                        }
                                        //FIM
                                        #endregion

                                        #region RETORNO REFEIÇAO
                                        //BLOCO RETORNO REFEIÇAO
                                        if (dt4.Rows[w][2].ToString() == "RETORNO REFEICAO")
                                        {

                                            int a = 0;
                                            int b = 0;
                                            a = w - 1;
                                            b = w + 1;
                                            if (a >= 0)
                                            {

                                                if (dt4.Rows[a][2].ToString() == "PARADA REFEICAO")
                                                {

                                                    // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;0102");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");

                                                }
                                                //if (dt4.Rows[b][2].ToString() == "FIM DE JORNADA")
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                //}
                                                //else
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");

                                                //}
                                            }


                                        }
                                        //FIM
                                        #endregion

                                        #region INICIO DE VIAGEM
                                        //BLOCO REINICIO / INICIO DE VIAGEM
                                        if (dt4.Rows[w][2].ToString() == "INICIO DE VIAGEM")
                                        {
                                            int a = 0;
                                            a = w - 1;
                                            if (a >= 0)
                                            {
                                                //if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                //{
                                                //    if (dt4.Rows[a][5].ToString() == "14")
                                                //    {
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");

                                                //    }
                                                //    else
                                                //        if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                //    {
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");

                                                //    }
                                                //    else
                                                //    {
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                //    }
                                                //}
                                                //if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                //}
                                                //else if (dt4.Rows[a][2].ToString() == "PARADA PERNOITE")
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;22");
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                //}
                                                //else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                //}

                                                if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                {


                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {

                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");



                                                    }
                                                    //else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "1" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "4")
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                    //}



                                                }
                                                else if (dt4.Rows[a][2].ToString() == "PARADA")
                                                {


                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {

                                                        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                    }
                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");



                                                    //}



                                                }
                                                //else if (dt4.Rows[a][2].ToString() == "RETORNO REFEICAO")
                                                //{
                                                //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                //    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");

                                                //}

                                            }
                                            //else
                                            //{
                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                            //}



                                        }
                                        //FIM
                                        #endregion

                                        #region PARADA CLIENTE / FORNECEDOR
                                        if (dt4.Rows[w][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                        {
                                            if (dt4.Rows[w][5].ToString() == "3" || dt4.Rows[w][5].ToString() == "2" || dt4.Rows[w][5].ToString() == "4")
                                            {
                                                int a = 0;
                                                a = w - 1;
                                                if (a >= 0)
                                                {
                                                    //if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                    //}
                                                    if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                    {
                                                        if (dt4.Rows[a][5].ToString() == "14")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;0102");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");


                                                        }
                                                        //else if (dt4.Rows[a][5].ToString() == "15")
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");

                                                        //}
                                                        //else
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                        //}

                                                    }
                                                }

                                            }
                                            else if (dt4.Rows[w][5].ToString() == "14")
                                            {
                                                int a = 0;
                                                a = w - 1;
                                                if (a >= 0)
                                                {
                                                    if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                    {
                                                        if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "4")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                        }
                                                        else if (dt4.Rows[a][5].ToString() == "14")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");

                                                        }


                                                    }
                                                    else
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                    }

                                                }


                                            }


                                        }
                                        #endregion

                                        #region REINICIO
                                        //BLOCO REINICIO / INICIO DE VIAGEM
                                        if (dt4.Rows[w][2].ToString() == "REINICIO DE VIAGEM")
                                        {
                                            int a = 0;
                                            a = w - 1;
                                            if (a >= 0)
                                            {
                                                if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                {

                                                }
                                                else if (dt4.Rows[a][2].ToString() == "PARADA PERNOITE")
                                                {
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                }

                                                else if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                {

                                                    if (a >= 0)
                                                    {

                                                        if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                        {
                                                            //if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                            //}
                                                            if (dt4.Rows[a][5].ToString() == "14")
                                                            {

                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");

                                                            }
                                                            //else if (dt4.Rows[a][5].ToString() == "15")
                                                            //{

                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");

                                                            //}
                                                            //else
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                            //}
                                                        }
                                                        //else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                        //}


                                                    }



                                                }
                                                else if (dt4.Rows[a][2].ToString() == "PARADA")
                                                {
                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                    }
                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                    //}




                                                }
                                                //else if (dt4.Rows[a][2].ToString() == "OFICINA / MANUTENCAO")
                                                //{

                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");


                                                //}

                                            }
                                            else
                                            {
                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");
                                                // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                            }



                                        }
                                        //FIM
                                        #endregion

                                        #region BLOCO PARADA
                                        // BLOCO PARADA
                                        if (dt4.Rows[w][2].ToString() == "PARADA")
                                        {
                                            int a = 0;
                                            a = w - 1;


                                            if (dt4.Rows[w][5].ToString() == "14")
                                            {
                                                if (dt4.Rows.Count >= a)
                                                {
                                                    if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                    {
                                                        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");


                                                    }

                                                }
                                            }
                                            //else
                                            //{
                                            //    if (dt4.Rows.Count >= a)
                                            //    {
                                            //        if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                            //        {
                                            //            write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                            //            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");

                                            //        }
                                            //        //else
                                            //        //{
                                            //        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                            //        //    // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                            //        //}
                                            //    }
                                            //}



                                            //  write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");

                                        }
                                        //FIM
                                        #endregion

                                        #region FIM DE VIAGEM
                                        //BLOCO FIM DE VIAGEM
                                        if (dt4.Rows[w][2].ToString() == "FIM DE VIAGEM")
                                        {
                                            int a = 0;
                                            int g = 0;
                                            a = w - 1;
                                            g = w - 2;
                                            if (a >= 0)
                                            {
                                                if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                {


                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {

                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;0102");

                                                    }

                                                    //else if (dt4.Rows[a][5].ToString() == "14")
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                    //    // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                    //}

                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //    // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                    //}



                                                }
                                                else if (dt4.Rows[a][2].ToString() == "PARADA")
                                                {


                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;0102");

                                                    }

                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //    // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");

                                                    //}


                                                }

                                                else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                {
                                                    if (g >= 0)
                                                    {
                                                        //if (dt4.Rows[g][2].ToString() == "PARADA PERNOITE")
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                        //}
                                                        //else
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //}
                                                    }
                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //}


                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                }


                                            }
                                            //else
                                            //{
                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                            //}

                                        }

                                        //
                                        #endregion

                                        #region FIM DE JORNADA
                                        //BLOCO FIM DE JORMADA
                                        if (c > 0)
                                        {
                                            if (dt4.Rows[w][2].ToString() == "FIM DE JORNADA" && dt4.Rows[w][6].ToString() == "725405" || dt4.Rows[w][2].ToString() == "FIM DE JORNADA" && dt4.Rows[w][6].ToString() == "725407" || dt4.Rows[w][2].ToString() == "FIM DE JORNADA" && dt4.Rows[w][6].ToString() == "184525")
                                            {
                                                int a = 0;
                                                a = w - 1;

                                                if (a >= 0)
                                                {
                                                    if (dt4.Rows[a][2].ToString() == "RETORNO REFEICAO")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                    {

                                                        //WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");


                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "RETORNO REFEICAO")
                                                    {

                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");

                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                    {
                                                        int b = 0;
                                                        b = a - 1;

                                                        if (b >= 0)
                                                        {
                                                            if (dt4.Rows[b][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[b][2].ToString() == "REINICIO DE VIAGEM")
                                                            {
                                                                int d = 0;
                                                                d = b - 1;
                                                                if (d >= 0)
                                                                {

                                                                    if (dt4.Rows[d][2].ToString() == "PARADA")
                                                                    {
                                                                        if (dt4.Rows[d][5].ToString() == "14")
                                                                        {
                                                                            // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                        }
                                                                        else
                                                                        {
                                                                            // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                            // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                        }




                                                                    }
                                                                    else
                                                                    {
                                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                        // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                    }
                                                                }
                                                            }
                                                            else
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            }

                                                        }
                                                        else
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                        }

                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "PARADA")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                    {
                                                        if (dt4.Rows[a][5].ToString() == "14")
                                                        {
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                        }
                                                        else
                                                        {
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        }
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");

                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "FIM DE JORNADA")
                                                    {
                                                        int m = 0;
                                                        m = a - 1;

                                                        if (m >= 0)
                                                        {
                                                            if (dt4.Rows[m][2].ToString() == "RETORNO REFEICAO" || dt4.Rows[m][2].ToString() == "INICIO DE JORNADA")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            }
                                                            else if (dt4.Rows[m][2].ToString() == "FIM DE VIAGEM")
                                                            {
                                                                int b = 0;
                                                                b = m - 1;

                                                                if (b >= 0)
                                                                {
                                                                    if (dt4.Rows[b][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[b][2].ToString() == "REINICIO DE VIAGEM")
                                                                    {
                                                                        int d = 0;
                                                                        d = b - 1;
                                                                        if (d >= 0)
                                                                        {

                                                                            if (dt4.Rows[d][2].ToString() == "PARADA")
                                                                            {
                                                                                if (dt4.Rows[d][5].ToString() == "14")
                                                                                {
                                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                                    //.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                                }
                                                                                else
                                                                                {
                                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                                                }


                                                                            }
                                                                            else
                                                                            {
                                                                                // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                            }
                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                    }

                                                                }


                                                            }
                                                            //else if (dt4.Rows[m][2].ToString() == "REINICIO DE VIAGEM")
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //}
                                                            //else if (dt4.Rows[m][2].ToString() == "PARADA INTERNA")
                                                            //{
                                                            //    if (dt4.Rows[m][5].ToString() == "3" || dt4.Rows[m][5].ToString() == "1" || dt4.Rows[m][5].ToString() == "2")
                                                            //    {
                                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");

                                                            //    }
                                                            //    else if (dt4.Rows[m][5].ToString() == "22")
                                                            //    {
                                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                            //    }

                                                            //    else if (dt4.Rows[m][2].ToString() == "FIM DE JORNADA")
                                                            //    {
                                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //        write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            //    }

                                                            //}
                                                            else if (dt4.Rows[m][2].ToString() == "PARADA")
                                                            {
                                                                // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                            }
                                                            //else if (dt4.Rows[m][2].ToString() == "PARADA INTERNA")
                                                            //{
                                                            //    if (dt4.Rows[m][5].ToString() != "3" || dt4.Rows[m][5].ToString() != "1" || dt4.Rows[m][5].ToString() != "2")
                                                            //    {
                                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                            //        write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                            //    }

                                                            //}

                                                            else
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            }


                                                        }
                                                        else
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                        }
                                                    }
                                                    else
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                    }


                                                }
                                                else
                                                {
                                                    // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                }
                                            }

                                        }
                                        else
                                        {
                                            if (dt4.Rows[w][2].ToString() == "FIM DE JORNADA")
                                            {
                                                int q = 0;
                                                q = w + 1;

                                                if (q < dt4.Rows.Count)
                                                {
                                                    if (dt4.Rows[q][2].ToString() == "FIM DE JORNADA")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                    }
                                                    else
                                                    {
                                                        int a = 0;
                                                        a = w - 1;

                                                        if (a >= 0)
                                                        {

                                                            if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM" || dt4.Rows[a][2].ToString() == "RETORNO REFEICAO" || dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                            }
                                                            //else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                            //{
                                                            //    if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                            //    {
                                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                            //        // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                            //        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //    }
                                                            //    else if (dt4.Rows[a][5].ToString() == "14")
                                                            //    {
                                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //        write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            //    }
                                                            //    else
                                                            //    {
                                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");


                                                            //    }
                                                            //}
                                                            else if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                            {

                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "FIM DE JORNADA")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            }
                                                            else
                                                            {
                                                                // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            }
                                                        }
                                                    }

                                                }
                                                else
                                                {
                                                    int a = 0;
                                                    a = w - 1;

                                                    if (a >= 0)
                                                    {

                                                        if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");

                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "RETORNO REFEICAO")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");

                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                        {
                                                            if (dt4.Rows[a][5].ToString() == "14")
                                                            {
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                            }
                                                            else
                                                            {
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            }
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");

                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                        }
                                                        //else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                        //{
                                                        //    if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                        //    {
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                        //        // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                        //        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //    }
                                                        //    else if (dt4.Rows[a][5].ToString() == "14")
                                                        //    {
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //        write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                        //    }
                                                        //    else
                                                        //    {
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");

                                                        //    }
                                                        //}
                                                        else if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                        {

                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "FIM DE JORNADA")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");

                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                        }
                                                        else
                                                        {
                                                            // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                        }
                                                    }
                                                    else
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                    }
                                                }
                                            }





                                        }


                                        #endregion

                                        #region PARADA PERNOITE

                                        if (dt4.Rows[w][2].ToString() == "PARADA PERNOITE")
                                        {
                                            int a = 0;
                                            a = w - 1;


                                            if (a >= 0)
                                            {
                                                if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                {


                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {

                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                        //WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;0102");
                                                        write.WriteLine("+00" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm").Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");


                                                    }
                                                    else if (dt4.Rows[a][5].ToString() == "15")
                                                    {

                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;22");


                                                    }
                                                    //else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");
                                                    //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //}
                                                    else
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                    }



                                                }
                                                else if (dt4.Rows[a][2].ToString() == "PARADA")
                                                {
                                                    //if (dt4.Rows[a][5].ToString() == "7")
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");
                                                    //}
                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {

                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                        //WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;0102");
                                                        write.WriteLine("+00" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm").Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");


                                                    }
                                                    else
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                    }

                                                }
                                                else if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM")
                                                {
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";2;22");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";3;22");
                                                }
                                                else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                {
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                    // write.WriteLine(cracha + ";" + data + ";" + hora + ";3;22");
                                                }
                                                //else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                //{


                                                //    if (dt4.Rows[a][5].ToString() == "14")
                                                //    {

                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                //        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");


                                                //    }
                                                //    //else if (dt4.Rows[a][5].ToString() == "15")
                                                //    //{

                                                //    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                //    //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");


                                                //    //}
                                                //    else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                //    {
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                //        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");
                                                //        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                //    }
                                                //    //else
                                                //    //{
                                                //    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;22");
                                                //    //}



                                                //}
                                                //else
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;22");
                                                //}

                                            }
                                            //else
                                            //{
                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;22");
                                            //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");

                                            //}

                                        }

                                        #endregion


                                        write.Flush();
                                        write.Close();
                                    }

                                    //FIM

                                    #endregion
                                }
                            }

                        }
                        else if (dt3.Rows[0][6].ToString() == "REINICIO DE VIAGEM")
                        {
                            //VERIFICA SE A ULTIMA MARCAÇÃO DO DIA ANTERIOR É PARADA PERNOITE OU FIM DE VIAGEM
                            string sqlv = "select TOP 1 ds_macro from tb_parada where cod_cracha=" + dt1.Rows[x][0].ToString() + " and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).AddDays(-1).ToString("yyyy-MM-dd") + "' and fl_deletado is null order by hr_posicao  DESC ";
                            SqlDataAdapter adtpv = new SqlDataAdapter(sqlv, con);
                            DataTable dtv = new DataTable();
                            con.Open();
                            adtpv.Fill(dtv);
                            con.Close();

                            if (dtv.Rows.Count > 0)
                            {
                                if (dtv.Rows[0][0].ToString() == "PARADA PERNOITE" || dtv.Rows[0][0].ToString() == "FIM DE JORNADA")
                                {
                                    //JORNADA NORMAL REINICIO DE VIAGEM

                                    //VERIFICA SE A ULTIMA MARCAÇÃO DO DIA É PARADA PERNOITE OU FIM DE VIAGEM
                                    string sqlu = "select ds_macro from tb_parada where cod_cracha=" + dt1.Rows[x][0].ToString() + " and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).ToString("yyyy-MM-dd") + "' and fl_deletado is null order by hr_posicao  DESC";
                                    SqlDataAdapter adtpu = new SqlDataAdapter(sqlu, con);
                                    DataTable dtu = new DataTable();
                                    con.Open();
                                    adtpu.Fill(dtu);
                                    con.Close();


                                    if (dtu.Rows[0][0].ToString() == "FIM DE JORNADA" || dtu.Rows[0][0].ToString() == "PARADA PERNOITE")
                                    {
                                        //JORNADA NORMAL REINICIO DE VIAGEM
                                        #region Jornada Normal
                                        //string arquivo = "Transmot" + DateTime.Parse(txtDtInicial.Text).ToString("ddMM") + "001.txt";

                                        sql4 = "select dt_posicao_parada, hr_posicao, ds_macro,cod_transmissao, cod_cracha, isnull(cod_ref_parada,0) as cod_ref_parada, cod_idveiculo from tb_parada where fl_deletado is null and cod_cracha=" + dt1.Rows[x][0].ToString() + " and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).ToString("yyyy-MM-dd") + "' AND (ds_macro IN ('INICIO DE JORNADA', 'INICIO JORNADA CAMINHAO', 'PARADA REFEICAO', 'FIM DE JORNADA','REINICIO DE VIAGEM','FIM DE VIAGEM', 'PARADA','PARADA INTERNA','INICIO DE VIAGEM','RETORNO REFEICAO','PARADA CLIENTE / FORNECEDOR','PARADA PERNOITE') OR cod_ref_parada in (0,2,3,4,14,22)) AND fl_deletado IS NULL ORDER BY dt_posicao_parada, hr_posicao";
                                        // string sql4 = "select dt_posicao_parada, hr_posicao, ds_macro,cod_transmissao, cod_cracha, isnull(cod_ref_parada,0) as cod_ref_parada, cod_idveiculo from tb_parada where fl_deletado is null and cod_cracha=" + dt1.Rows[x][0].ToString() + " and dt_posicao_parada between '" + txtDtInicial.Text + "' and '" + txtDtFinal.Text + "' order by dt_posicao_parada, hr_posicao";
                                        SqlDataAdapter adtp4 = new SqlDataAdapter(sql4, con);
                                        DataTable dt4 = new DataTable();

                                        try
                                        {
                                            con.Open();
                                            adtp4.Fill(dt4);
                                            con.Close();
                                        }
                                        catch (Exception ed)
                                        {
                                            // MessageBox.Show(ed.ToString(), "Erro3");
                                        }

                                        c = 0;

                                        for (int y = 0; y < dt4.Rows.Count; y++)
                                        {
                                            if (dt4.Rows[y][2].ToString() == "FIM DE JORNADA" && dt4.Rows[y][6].ToString() == "725405" || dt4.Rows[y][2].ToString() == "FIM DE JORNADA" && dt4.Rows[y][6].ToString() == "725407" || dt4.Rows[y][2].ToString() == "FIM DE JORNADA" && dt4.Rows[y][6].ToString() == "184525")
                                            {
                                                c = c + 1;
                                            }

                                        }
                                        string caminho = Server.MapPath("/TXT/");

                                        string filepath = caminho + arquivo;

                                        FileInfo file = new FileInfo(filepath);

                                        //if (file.Exists)
                                        //{
                                        //    file.Delete();
                                        //}


                                        for (int w = 0; w < dt4.Rows.Count; w++)
                                        {


                                            string codigo = dt1.Rows[x][0].ToString();
                                            string[] codigosEspeciais = { "330", "482", "820", "958", "989" };

                                            if (codigo.StartsWith("312"))
                                            {
                                                cracha = codigo.Insert(3, "0");
                                            }
                                            else if ((codigosEspeciais.Contains(codigo) || codigo.Length <= 4))
                                            {
                                                cracha = "30" + codigo;
                                            }
                                            else if (codigo.Length <= 3)
                                            {
                                                cracha = "300" + codigo;
                                            }

                                            else
                                            {
                                                cracha = codigo;
                                            }




                                            int t = 0;
                                            t = w - 1;

                                            string data = DateTime.Parse(dt4.Rows[w][0].ToString()).ToString("dd/MM/yy");
                                            string horas = DateTime.Parse(dt4.Rows[w][1].ToString()).ToString("HH:mm");
                                            if (t >= 0)
                                            {
                                                if (DateTime.Parse(dt4.Rows[w][1].ToString()).ToString("HH:mm") == DateTime.Parse(dt4.Rows[t][1].ToString()).ToString("HH:mm"))
                                                {
                                                    hora = DateTime.Parse(horas).AddMinutes(1).ToString("HH:mm");
                                                }
                                                else
                                                {
                                                    hora = DateTime.Parse(horas).ToString("HH:mm");
                                                }
                                            }
                                            else
                                            {
                                                hora = DateTime.Parse(horas).ToString("HH:mm");
                                            }
                                            //tipo = dt4.Rows[w][2].ToString();
                                            string transmissao = dt4.Rows[w][3].ToString();


                                            //if (dt4.Rows[w][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[w][2].ToString() == "TRECHO ALMOÇO" || dt4.Rows[w][2].ToString() == "FIM DE JORNADA")
                                            //{
                                            //    tipo = "2";
                                            //}
                                            //else  if (dt4.Rows[w][2].ToString() == "PARADA FORNECEDOR" || dt4.Rows[w][2].ToString() == "REINICIO DE VIAGEM")
                                            //{
                                            //    tipo = "21";
                                            //}






                                            StreamWriter write = new StreamWriter(caminho + arquivo, true);




                                            #region BLOCO INICIO JORNADA
                                            //BLOCO INICIO JORNADA
                                            if (dt4.Rows[w][2].ToString() == "INICIO DE JORNADA")
                                            {
                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");
                                            }

                                            if (dt4.Rows[w][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[w][2].ToString() == "INICIO JORNADA")
                                            {

                                                int a = 0;
                                                a = w - 1;
                                                if (a >= 0)
                                                {
                                                    if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");

                                                    }
                                                    else
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");

                                                    }
                                                }
                                                else
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                }


                                            }
                                            //FIM
                                            #endregion

                                            #region BLOCO INICIO JORNADA CAMINHAO
                                            //BLOCO INICIO JORNADA CAMINHAO

                                            if (dt4.Rows[w][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[w][2].ToString() == "INICIO JORNADA")
                                            {

                                                int a = 0;
                                                a = w - 1;
                                                if (a >= 0)
                                                {
                                                    if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");

                                                    }
                                                    else
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");
                                                    }
                                                }
                                                else
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                }


                                            }
                                            //FIM
                                            #endregion

                                            #region PARADA INTERNA
                                            //BLOCO PARADA INTERNA
                                            if (dt4.Rows[w][2].ToString() == "PARADA INTERNA")
                                            {
                                                if (dt4.Rows[w][5].ToString() == "3" || dt4.Rows[w][5].ToString() == "2")
                                                {
                                                    int a = 0;
                                                    a = w - 1;
                                                    if (a >= 0)
                                                    {
                                                        if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                        }
                                                        else if (dt4.Rows[a][5].ToString() == "14")
                                                        {
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                        }
                                                        else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "1")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "PARADA REFEICAO")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM")
                                                        {
                                                            //////write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            ////write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            ////write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                        }
                                                        else
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                        }

                                                    }

                                                }
                                                else if (dt4.Rows[w][5].ToString() == "14")
                                                {
                                                    int a = 0;
                                                    a = w - 1;
                                                    if (a >= 0)
                                                    {
                                                        if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                        {
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                        }
                                                        if (dt4.Rows[a][5].ToString() == "14")
                                                        {
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                        }
                                                        else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "1")
                                                        {
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "PARADA REFEICAO")
                                                        {
                                                            // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                        {
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                        {

                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");

                                                        }
                                                        if (dt4.Rows[a][5].ToString() == "22")
                                                        {
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                        }
                                                        //else
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93: 71489");
                                                        //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                        //}

                                                    }
                                                }
                                                else if (dt4.Rows[w][5].ToString() == "22")
                                                {
                                                    int a = 0;
                                                    a = w - 1;
                                                    if (a >= 0)
                                                    {

                                                        if (dt4.Rows[a][5].ToString() == "14")
                                                        {
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                        }


                                                    }
                                                }
                                                else
                                                {
                                                    int a = 0;
                                                    a = w - 1;
                                                    if (a >= 0)
                                                    {
                                                        if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");
                                                        }
                                                        if (dt4.Rows[a][5].ToString() == "14")
                                                        {
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                        }

                                                        else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "1")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");
                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "PARADA REFEICAO")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                            //// write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                        {

                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");
                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                        {

                                                            //// write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");

                                                        }

                                                    }
                                                }

                                            }
                                            //FIM 
                                            #endregion

                                            #region BLOCO PARADA REFEIÇÃO
                                            //BLOCO PARADA REFEIÇÃO
                                            if (dt4.Rows[w][2].ToString() == "PARADA REFEICAO")
                                            {
                                                int a = 0;
                                                a = w - 1;
                                                if (a >= 0)
                                                {
                                                    //if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                    //{

                                                    //    if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                    //    {
                                                    //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                    //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;93");
                                                    //    }
                                                    //    else
                                                    //    {
                                                    //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                    //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;93");
                                                    //    }
                                                    //}
                                                    if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");

                                                    }
                                                    else
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                    }

                                                }
                                                //else
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;93");
                                                //}
                                            }
                                            //FIM
                                            #endregion

                                            #region RETORNO REFEIÇAO
                                            //BLOCO RETORNO REFEIÇAO
                                            if (dt4.Rows[w][2].ToString() == "RETORNO REFEICAO")
                                            {

                                                int a = 0;
                                                int b = 0;
                                                a = w - 1;
                                                b = w + 1;
                                                if (a >= 0)
                                                {

                                                    if (dt4.Rows[a][2].ToString() == "PARADA REFEICAO")
                                                    {

                                                        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;0102");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");

                                                    }
                                                    //if (dt4.Rows[b][2].ToString() == "FIM DE JORNADA")
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                    //}
                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                    //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");

                                                    //}
                                                }


                                            }
                                            //FIM
                                            #endregion

                                            #region INICIO DE VIAGEM
                                            //BLOCO REINICIO / INICIO DE VIAGEM
                                            if (dt4.Rows[w][2].ToString() == "INICIO DE VIAGEM")
                                            {
                                                int a = 0;
                                                a = w - 1;
                                                if (a >= 0)
                                                {
                                                    //if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                    //{
                                                    //    if (dt4.Rows[a][5].ToString() == "14")
                                                    //    {
                                                    //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                    //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");

                                                    //    }
                                                    //    else
                                                    //        if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                    //    {
                                                    //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                    //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");

                                                    //    }
                                                    //    else
                                                    //    {
                                                    //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                    //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                    //    }
                                                    //}
                                                    //if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                    //}
                                                    //else if (dt4.Rows[a][2].ToString() == "PARADA PERNOITE")
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;22");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                    //}
                                                    //else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                    //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                    //}

                                                    if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                    {


                                                        if (dt4.Rows[a][5].ToString() == "14")
                                                        {

                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");



                                                        }
                                                        //else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "1" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "4")
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                        //}



                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "PARADA")
                                                    {


                                                        if (dt4.Rows[a][5].ToString() == "14")
                                                        {

                                                            // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                        }
                                                        //else
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");



                                                        //}



                                                    }
                                                    //else if (dt4.Rows[a][2].ToString() == "RETORNO REFEICAO")
                                                    //{
                                                    //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                    //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                    //    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");

                                                    //}

                                                }
                                                //else
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                //}



                                            }
                                            //FIM
                                            #endregion

                                            #region PARADA CLIENTE / FORNECEDOR
                                            if (dt4.Rows[w][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                            {
                                                if (dt4.Rows[w][5].ToString() == "3" || dt4.Rows[w][5].ToString() == "2" || dt4.Rows[w][5].ToString() == "4")
                                                {
                                                    int a = 0;
                                                    a = w - 1;
                                                    if (a >= 0)
                                                    {
                                                        //if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                        //}
                                                        if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                        {
                                                            if (dt4.Rows[a][5].ToString() == "14")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;0102");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");


                                                            }
                                                            //else if (dt4.Rows[a][5].ToString() == "15")
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");

                                                            //}
                                                            //else
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                            //}

                                                        }
                                                    }

                                                }
                                                else if (dt4.Rows[w][5].ToString() == "14")
                                                {
                                                    int a = 0;
                                                    a = w - 1;
                                                    if (a >= 0)
                                                    {
                                                        if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                        {
                                                            if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "4")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                            }
                                                            else if (dt4.Rows[a][5].ToString() == "14")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");

                                                            }


                                                        }
                                                        else
                                                        {
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                        }

                                                    }


                                                }


                                            }
                                            #endregion

                                            #region REINICIO
                                            //BLOCO REINICIO / INICIO DE VIAGEM
                                            if (dt4.Rows[w][2].ToString() == "REINICIO DE VIAGEM")
                                            {
                                                int a = 0;
                                                a = w - 1;
                                                if (a >= 0)
                                                {
                                                    if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                    {

                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "PARADA PERNOITE")
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                    }

                                                    else if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                    {

                                                        if (a >= 0)
                                                        {

                                                            if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                            {
                                                                //if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                                //{
                                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                                //}
                                                                if (dt4.Rows[a][5].ToString() == "14")
                                                                {

                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");

                                                                }
                                                                //else if (dt4.Rows[a][5].ToString() == "15")
                                                                //{

                                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");

                                                                //}
                                                                //else
                                                                //{
                                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                                //}
                                                            }
                                                            //else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                            //}


                                                        }



                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "PARADA")
                                                    {
                                                        if (dt4.Rows[a][5].ToString() == "14")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                        }
                                                        //else
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                        //}




                                                    }
                                                    //else if (dt4.Rows[a][2].ToString() == "OFICINA / MANUTENCAO")
                                                    //{

                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");


                                                    //}

                                                }
                                                else
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");
                                                    // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                }



                                            }
                                            //FIM
                                            #endregion

                                            #region BLOCO PARADA
                                            // BLOCO PARADA
                                            if (dt4.Rows[w][2].ToString() == "PARADA")
                                            {
                                                int a = 0;
                                                a = w - 1;


                                                if (dt4.Rows[w][5].ToString() == "14")
                                                {
                                                    if (dt4.Rows.Count >= a)
                                                    {
                                                        if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                        {
                                                            // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");


                                                        }

                                                    }
                                                }
                                                //else
                                                //{
                                                //    if (dt4.Rows.Count >= a)
                                                //    {
                                                //        if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                //        {
                                                //            write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                //            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");

                                                //        }
                                                //        //else
                                                //        //{
                                                //        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                //        //    // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                //        //}
                                                //    }
                                                //}



                                                //  write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");

                                            }
                                            //FIM
                                            #endregion

                                            #region FIM DE VIAGEM
                                            //BLOCO FIM DE VIAGEM
                                            if (dt4.Rows[w][2].ToString() == "FIM DE VIAGEM")
                                            {
                                                int a = 0;
                                                int g = 0;
                                                a = w - 1;
                                                g = w - 2;
                                                if (a >= 0)
                                                {
                                                    if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                    {


                                                        if (dt4.Rows[a][5].ToString() == "14")
                                                        {

                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;0102");

                                                        }

                                                        //else if (dt4.Rows[a][5].ToString() == "14")
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                        //    // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                        //}

                                                        //else
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //    // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                        //}



                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "PARADA")
                                                    {


                                                        if (dt4.Rows[a][5].ToString() == "14")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;0102");

                                                        }

                                                        //else
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //    // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");

                                                        //}


                                                    }

                                                    else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                    {
                                                        if (g >= 0)
                                                        {
                                                            //if (dt4.Rows[g][2].ToString() == "PARADA PERNOITE")
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            //}
                                                            //else
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //}
                                                        }
                                                        //else
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //}


                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                    }


                                                }
                                                //else
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                //}

                                            }

                                            //
                                            #endregion

                                            #region FIM DE JORNADA
                                            //BLOCO FIM DE JORMADA
                                            if (c > 0)
                                            {
                                                if (dt4.Rows[w][2].ToString() == "FIM DE JORNADA" && dt4.Rows[w][6].ToString() == "725405" || dt4.Rows[w][2].ToString() == "FIM DE JORNADA" && dt4.Rows[w][6].ToString() == "725407" || dt4.Rows[w][2].ToString() == "FIM DE JORNADA" && dt4.Rows[w][6].ToString() == "184525" && dt4.Rows[w][6].ToString() == "184522")
                                                {
                                                    int a = 0;
                                                    a = w - 1;

                                                    if (a >= 0)
                                                    {
                                                        if (dt4.Rows[a][2].ToString() == "RETORNO REFEICAO")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                        {

                                                            //WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");


                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "RETORNO REFEICAO")
                                                        {

                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");

                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                        {
                                                            int b = 0;
                                                            b = a - 1;

                                                            if (b >= 0)
                                                            {
                                                                if (dt4.Rows[b][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[b][2].ToString() == "REINICIO DE VIAGEM")
                                                                {
                                                                    int d = 0;
                                                                    d = b - 1;
                                                                    if (d >= 0)
                                                                    {

                                                                        if (dt4.Rows[d][2].ToString() == "PARADA")
                                                                        {
                                                                            if (dt4.Rows[d][5].ToString() == "14")
                                                                            {
                                                                                // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                            }
                                                                            else
                                                                            {
                                                                                // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                                // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                            }




                                                                        }
                                                                        else
                                                                        {
                                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                            // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                        }
                                                                    }
                                                                }
                                                                else
                                                                {
                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                    // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                }

                                                            }
                                                            else
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                            }

                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "PARADA")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                        {
                                                            if (dt4.Rows[a][5].ToString() == "14")
                                                            {
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                            }
                                                            else
                                                            {
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            }
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");

                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "FIM DE JORNADA")
                                                        {
                                                            int m = 0;
                                                            m = a - 1;

                                                            if (m >= 0)
                                                            {
                                                                if (dt4.Rows[m][2].ToString() == "RETORNO REFEICAO" || dt4.Rows[m][2].ToString() == "INICIO DE JORNADA")
                                                                {
                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                }
                                                                else if (dt4.Rows[m][2].ToString() == "FIM DE VIAGEM")
                                                                {
                                                                    int b = 0;
                                                                    b = m - 1;

                                                                    if (b >= 0)
                                                                    {
                                                                        if (dt4.Rows[b][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[b][2].ToString() == "REINICIO DE VIAGEM")
                                                                        {
                                                                            int d = 0;
                                                                            d = b - 1;
                                                                            if (d >= 0)
                                                                            {

                                                                                if (dt4.Rows[d][2].ToString() == "PARADA")
                                                                                {
                                                                                    if (dt4.Rows[d][5].ToString() == "14")
                                                                                    {
                                                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                                        //.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                                                    }


                                                                                }
                                                                                else
                                                                                {
                                                                                    // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                                }
                                                                            }
                                                                        }
                                                                        else
                                                                        {
                                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                        }

                                                                    }


                                                                }
                                                                //else if (dt4.Rows[m][2].ToString() == "REINICIO DE VIAGEM")
                                                                //{
                                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                                //}
                                                                //else if (dt4.Rows[m][2].ToString() == "PARADA INTERNA")
                                                                //{
                                                                //    if (dt4.Rows[m][5].ToString() == "3" || dt4.Rows[m][5].ToString() == "1" || dt4.Rows[m][5].ToString() == "2")
                                                                //    {
                                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");

                                                                //    }
                                                                //    else if (dt4.Rows[m][5].ToString() == "22")
                                                                //    {
                                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                                //    }

                                                                //    else if (dt4.Rows[m][2].ToString() == "FIM DE JORNADA")
                                                                //    {
                                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                                //        write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                //    }

                                                                //}
                                                                else if (dt4.Rows[m][2].ToString() == "PARADA")
                                                                {
                                                                    // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                                }
                                                                //else if (dt4.Rows[m][2].ToString() == "PARADA INTERNA")
                                                                //{
                                                                //    if (dt4.Rows[m][5].ToString() != "3" || dt4.Rows[m][5].ToString() != "1" || dt4.Rows[m][5].ToString() != "2")
                                                                //    {
                                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                                //        write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                                //    }

                                                                //}

                                                                else
                                                                {
                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                }


                                                            }
                                                            else
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            }
                                                        }
                                                        else
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                        }


                                                    }
                                                    else
                                                    {
                                                        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                    }
                                                }

                                            }
                                            else
                                            {
                                                if (dt4.Rows[w][2].ToString() == "FIM DE JORNADA")
                                                {
                                                    int q = 0;
                                                    q = w + 1;

                                                    if (q < dt4.Rows.Count)
                                                    {
                                                        if (dt4.Rows[q][2].ToString() == "FIM DE JORNADA")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                        }
                                                        else
                                                        {
                                                            int a = 0;
                                                            a = w - 1;

                                                            if (a >= 0)
                                                            {

                                                                if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM" || dt4.Rows[a][2].ToString() == "RETORNO REFEICAO" || dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                                {
                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                    // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                                }
                                                                //else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                                //{
                                                                //    if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                                //    {
                                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                                //        // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                                //        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                                //    }
                                                                //    else if (dt4.Rows[a][5].ToString() == "14")
                                                                //    {
                                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                                //        write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                //    }
                                                                //    else
                                                                //    {
                                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");


                                                                //    }
                                                                //}
                                                                else if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                                {

                                                                }
                                                                else if (dt4.Rows[a][2].ToString() == "FIM DE JORNADA")
                                                                {
                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                }
                                                                else
                                                                {
                                                                    // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                    // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                }
                                                            }
                                                        }

                                                    }
                                                    else
                                                    {
                                                        int a = 0;
                                                        a = w - 1;

                                                        if (a >= 0)
                                                        {

                                                            if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");

                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "RETORNO REFEICAO")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");

                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                            {
                                                                if (dt4.Rows[a][5].ToString() == "14")
                                                                {
                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                                }
                                                                else
                                                                {
                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                }
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");

                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                            }
                                                            //else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                            //{
                                                            //    if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                            //    {
                                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                            //        // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                            //        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //    }
                                                            //    else if (dt4.Rows[a][5].ToString() == "14")
                                                            //    {
                                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //        write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            //    }
                                                            //    else
                                                            //    {
                                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");

                                                            //    }
                                                            //}
                                                            else if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                            {

                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "FIM DE JORNADA")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");

                                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            }
                                                            else
                                                            {
                                                                // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            }
                                                        }
                                                        else
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                        }
                                                    }
                                                }





                                            }


                                            #endregion

                                            #region PARADA PERNOITE

                                            if (dt4.Rows[w][2].ToString() == "PARADA PERNOITE")
                                            {
                                                int a = 0;
                                                a = w - 1;


                                                if (a >= 0)
                                                {
                                                    if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                    {


                                                        if (dt4.Rows[a][5].ToString() == "14")
                                                        {

                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                            //WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;0102");
                                                            write.WriteLine("+00" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm").Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");


                                                        }
                                                        else if (dt4.Rows[a][5].ToString() == "15")
                                                        {

                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;22");


                                                        }
                                                        //else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                        //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");
                                                        //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //}
                                                        else
                                                        {
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        }



                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "PARADA")
                                                    {
                                                        //if (dt4.Rows[a][5].ToString() == "7")
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");
                                                        //}
                                                        if (dt4.Rows[a][5].ToString() == "14")
                                                        {

                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                            //WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;0102");
                                                            write.WriteLine("+00" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm").Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");


                                                        }
                                                        else
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                        }

                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM")
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";2;22");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";3;22");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                        // write.WriteLine(cracha + ";" + data + ";" + hora + ";3;22");
                                                    }
                                                    //else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                    //{


                                                    //    if (dt4.Rows[a][5].ToString() == "14")
                                                    //    {

                                                    //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                    //        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");


                                                    //    }
                                                    //    //else if (dt4.Rows[a][5].ToString() == "15")
                                                    //    //{

                                                    //    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //    //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");


                                                    //    //}
                                                    //    else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                    //    {
                                                    //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");
                                                    //        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //    }
                                                    //    //else
                                                    //    //{
                                                    //    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;22");
                                                    //    //}



                                                    //}
                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;22");
                                                    //}

                                                }
                                                //else
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;22");
                                                //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");

                                                //}

                                            }

                                            #endregion



                                            write.Flush();
                                            write.Close();



                                        }

                                        //FIM

                                        #endregion

                                    }
                                    else
                                    {
                                        //JORNADA PERNOITE REINICIO DE VIAGEM
                                        string sqli = "select top 1  hr_posicao from tb_parada where cod_cracha=" + dt1.Rows[x][0].ToString() + " and ds_macro = 'REINICIO DE VIAGEM' and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).ToString("yyyy-MM-dd") + "' and fl_deletado is null order by hr_posicao";
                                        SqlDataAdapter adtpi = new SqlDataAdapter(sqli, con);
                                        DataTable dti = new DataTable();
                                        con.Open();
                                        adtpi.Fill(dti);
                                        con.Close();

                                        string sqlf = "select top 1 hr_posicao from tb_parada where cod_cracha=" + dt1.Rows[x][0].ToString() + " and ds_macro = 'FIM DE JORNADA' and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).AddDays(1).ToString("yyyy-MM-dd") + "' and fl_deletado is null OR cod_cracha=" + dt1.Rows[x][0].ToString() + " and ds_macro='PARADA PERNOITE' and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).AddDays(1).ToString("yyyy-MM-dd") + "' and fl_deletado is null order by hr_posicao";
                                        SqlDataAdapter adtpf = new SqlDataAdapter(sqlf, con);
                                        DataTable dtf = new DataTable();
                                        con.Open();
                                        adtpf.Fill(dtf);
                                        con.Close();



                                        if (dti.Rows.Count > 0 && dtf.Rows.Count > 0)
                                        {
                                            #region Jornada Noturna


                                            //sql4 = "select dt_posicao_parada, hr_posicao, ds_macro,cod_transmissao, cod_cracha, isnull(cod_ref_parada,0) as cod_ref_parada, cod_idveiculo from tb_parada where fl_deletado is null and cod_cracha=" + dt1.Rows[x][0].ToString() + " and dt_posicao_parada='" + txtDtInicial.Text + "' order by dt_posicao_parada, hr_posicao";
                                            sql4 = "select dt_posicao_parada, hr_posicao, ds_macro,cod_transmissao, cod_cracha, isnull(cod_ref_parada,0) as cod_ref_parada, cod_idveiculo from tb_parada where fl_deletado is null and cod_cracha=" + dt1.Rows[x][0].ToString() + " and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).ToString("yyyy-MM-dd") + "' and hr_posicao >='" + dti.Rows[0][0].ToString() + "' or cod_cracha=" + dt1.Rows[x][0].ToString() + " and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).AddDays(1).ToString("yyyy-MM-dd") + "' and hr_posicao <= '" + dtf.Rows[0][0].ToString() + "' AND (ds_macro IN ('INICIO DE JORNADA', 'INICIO JORNADA CAMINHAO', 'PARADA REFEICAO', 'FIM DE JORNADA','REINICIO DE VIAGEM','FIM DE VIAGEM', 'PARADA','PARADA INTERNA','INICIO DE VIAGEM','PARADA INTERNA','RETORNO REFEICAO','PARADA CLIENTE / FORNECEDOR','PARADA PERNOITE') OR cod_ref_parada in (2,3,4,14,22)) AND fl_deletado IS NULL ORDER BY dt_posicao_parada, hr_posicao";
                                            // string sql4 = "select dt_posicao_parada, hr_posicao, ds_macro,cod_transmissao, cod_cracha, isnull(cod_ref_parada,0) as cod_ref_parada, cod_idveiculo from tb_parada where fl_deletado is null and cod_cracha=" + dt1.Rows[x][0].ToString() + " and dt_posicao_parada between '" + txtDtInicial.Text + "' and '" + txtDtFinal.Text + "' order by dt_posicao_parada, hr_posicao";
                                            SqlDataAdapter adtp4 = new SqlDataAdapter(sql4, con);
                                            DataTable dt4 = new DataTable();

                                            try
                                            {
                                                con.Open();
                                                adtp4.Fill(dt4);
                                                con.Close();
                                            }
                                            catch (Exception ed)
                                            {
                                                //MessageBox.Show(ed.ToString(), "Erro3");
                                            }

                                            c = 0;

                                            for (int y = 0; y < dt4.Rows.Count; y++)
                                            {
                                                if (dt4.Rows[y][2].ToString() == "FIM DE JORNADA" && dt4.Rows[y][6].ToString() == "725405" || dt4.Rows[y][2].ToString() == "FIM DE JORNADA" && dt4.Rows[y][6].ToString() == "725407" || dt4.Rows[y][2].ToString() == "FIM DE JORNADA" && dt4.Rows[y][6].ToString() == "184525")
                                                {
                                                    c = c + 1;
                                                }

                                            }
                                            string caminho = Server.MapPath("/TXT/");

                                            string filepath = caminho + arquivo;

                                            FileInfo file = new FileInfo(filepath);
                                            //if(file.Exists)
                                            //{
                                            //    file.Delete();
                                            //}



                                            for (int w = 0; w < dt4.Rows.Count; w++)
                                            {

                                                string codigo = dt1.Rows[x][0].ToString();
                                                string[] codigosEspeciais = { "330", "482", "820", "958", "989" };

                                                if (codigo.StartsWith("312"))
                                                {
                                                    cracha = codigo.Insert(3, "0");
                                                }
                                                else if ((codigosEspeciais.Contains(codigo) || codigo.Length <= 4))
                                                {
                                                    cracha = "30" + codigo;
                                                }
                                                else if (codigo.Length <= 3)
                                                {
                                                    cracha = "300" + codigo;
                                                }

                                                else
                                                {
                                                    cracha = codigo;
                                                }

                                                int t = 0;
                                                t = w - 1;

                                                string data = DateTime.Parse(dt4.Rows[w][0].ToString()).ToString("dd/MM/yy");
                                                string horas = DateTime.Parse(dt4.Rows[w][1].ToString()).ToString("HH:mm");
                                                if (t >= 0)
                                                {
                                                    if (DateTime.Parse(dt4.Rows[w][1].ToString()).ToString("HH:mm") == DateTime.Parse(dt4.Rows[t][1].ToString()).ToString("HH:mm"))
                                                    {
                                                        hora = DateTime.Parse(horas).AddMinutes(1).ToString("HH:mm");
                                                    }
                                                    else
                                                    {
                                                        hora = DateTime.Parse(horas).ToString("HH:mm");
                                                    }
                                                }
                                                else
                                                {
                                                    hora = DateTime.Parse(horas).ToString("HH:mm");
                                                }
                                                //tipo = dt4.Rows[w][2].ToString();
                                                string transmissao = dt4.Rows[w][3].ToString();


                                                //if (dt4.Rows[w][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[w][2].ToString() == "TRECHO ALMOÇO" || dt4.Rows[w][2].ToString() == "FIM DE JORNADA")
                                                //{
                                                //    tipo = "2";
                                                //}
                                                //else  if (dt4.Rows[w][2].ToString() == "PARADA FORNECEDOR" || dt4.Rows[w][2].ToString() == "REINICIO DE VIAGEM")
                                                //{
                                                //    tipo = "21";
                                                //}



                                                StreamWriter write = new StreamWriter(caminho + arquivo, true);

                                                #region BLOCO INICIO JORNADA
                                                //BLOCO INICIO JORNADA
                                                if (dt4.Rows[w][2].ToString() == "INICIO DE JORNADA")
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");
                                                }

                                                if (dt4.Rows[w][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[w][2].ToString() == "INICIO JORNADA")
                                                {

                                                    int a = 0;
                                                    a = w - 1;
                                                    if (a >= 0)
                                                    {
                                                        if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");

                                                        }
                                                        else
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");

                                                        }
                                                    }
                                                    else
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    }


                                                }
                                                //FIM
                                                #endregion

                                                #region BLOCO INICIO JORNADA CAMINHAO
                                                //BLOCO INICIO JORNADA CAMINHAO

                                                if (dt4.Rows[w][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[w][2].ToString() == "INICIO JORNADA")
                                                {

                                                    int a = 0;
                                                    a = w - 1;
                                                    if (a >= 0)
                                                    {
                                                        if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");

                                                        }
                                                        else
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");
                                                        }
                                                    }
                                                    else
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    }


                                                }
                                                //FIM
                                                #endregion

                                                #region PARADA INTERNA
                                                //BLOCO PARADA INTERNA
                                                if (dt4.Rows[w][2].ToString() == "PARADA INTERNA")
                                                {
                                                    if (dt4.Rows[w][5].ToString() == "3" || dt4.Rows[w][5].ToString() == "2")
                                                    {
                                                        int a = 0;
                                                        a = w - 1;
                                                        if (a >= 0)
                                                        {
                                                            if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                            }
                                                            else if (dt4.Rows[a][5].ToString() == "14")
                                                            {
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                            }
                                                            else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "1")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "PARADA REFEICAO")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM")
                                                            {
                                                                //////write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                                ////write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                                ////write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                            }
                                                            else
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                            }

                                                        }

                                                    }
                                                    else if (dt4.Rows[w][5].ToString() == "14")
                                                    {
                                                        int a = 0;
                                                        a = w - 1;
                                                        if (a >= 0)
                                                        {
                                                            if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                            {
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                            }
                                                            if (dt4.Rows[a][5].ToString() == "14")
                                                            {
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                            }
                                                            else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "1")
                                                            {
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "PARADA REFEICAO")
                                                            {
                                                                // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                            {
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                            {

                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");

                                                            }
                                                            if (dt4.Rows[a][5].ToString() == "22")
                                                            {
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                            }
                                                            //else
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93: 71489");
                                                            //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                            //}

                                                        }
                                                    }
                                                    else if (dt4.Rows[w][5].ToString() == "22")
                                                    {
                                                        int a = 0;
                                                        a = w - 1;
                                                        if (a >= 0)
                                                        {

                                                            if (dt4.Rows[a][5].ToString() == "14")
                                                            {
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                            }


                                                        }
                                                    }
                                                    else
                                                    {
                                                        int a = 0;
                                                        a = w - 1;
                                                        if (a >= 0)
                                                        {
                                                            if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");
                                                            }
                                                            if (dt4.Rows[a][5].ToString() == "14")
                                                            {
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                            }

                                                            else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "1")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");
                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "PARADA REFEICAO")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                                //// write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                            {

                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");
                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                            {

                                                                //// write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");

                                                            }

                                                        }
                                                    }

                                                }
                                                //FIM 
                                                #endregion

                                                #region BLOCO PARADA REFEIÇÃO
                                                //BLOCO PARADA REFEIÇÃO
                                                if (dt4.Rows[w][2].ToString() == "PARADA REFEICAO")
                                                {
                                                    int a = 0;
                                                    a = w - 1;
                                                    if (a >= 0)
                                                    {
                                                        //if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                        //{

                                                        //    if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                        //    {
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;93");
                                                        //    }
                                                        //    else
                                                        //    {
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;93");
                                                        //    }
                                                        //}
                                                        if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");

                                                        }
                                                        else
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                        }

                                                    }
                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;93");
                                                    //}
                                                }
                                                //FIM
                                                #endregion

                                                #region RETORNO REFEIÇAO
                                                //BLOCO RETORNO REFEIÇAO
                                                if (dt4.Rows[w][2].ToString() == "RETORNO REFEICAO")
                                                {

                                                    int a = 0;
                                                    int b = 0;
                                                    a = w - 1;
                                                    b = w + 1;
                                                    if (a >= 0)
                                                    {

                                                        if (dt4.Rows[a][2].ToString() == "PARADA REFEICAO")
                                                        {

                                                            // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;0102");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");

                                                        }
                                                        //if (dt4.Rows[b][2].ToString() == "FIM DE JORNADA")
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                        //}
                                                        //else
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                        //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");

                                                        //}
                                                    }


                                                }
                                                //FIM
                                                #endregion

                                                #region INICIO DE VIAGEM
                                                //BLOCO REINICIO / INICIO DE VIAGEM
                                                if (dt4.Rows[w][2].ToString() == "INICIO DE VIAGEM")
                                                {
                                                    int a = 0;
                                                    a = w - 1;
                                                    if (a >= 0)
                                                    {
                                                        //if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                        //{
                                                        //    if (dt4.Rows[a][5].ToString() == "14")
                                                        //    {
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");

                                                        //    }
                                                        //    else
                                                        //        if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                        //    {
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");

                                                        //    }
                                                        //    else
                                                        //    {
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                        //    }
                                                        //}
                                                        //if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                        //}
                                                        //else if (dt4.Rows[a][2].ToString() == "PARADA PERNOITE")
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;22");
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                        //}
                                                        //else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                        //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                        //}

                                                        if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                        {


                                                            if (dt4.Rows[a][5].ToString() == "14")
                                                            {

                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");



                                                            }
                                                            //else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "1" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "4")
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                            //}



                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "PARADA")
                                                        {


                                                            if (dt4.Rows[a][5].ToString() == "14")
                                                            {

                                                                // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                            }
                                                            //else
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");



                                                            //}



                                                        }
                                                        //else if (dt4.Rows[a][2].ToString() == "RETORNO REFEICAO")
                                                        //{
                                                        //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                        //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                        //    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");

                                                        //}

                                                    }
                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //}



                                                }
                                                //FIM
                                                #endregion

                                                #region PARADA CLIENTE / FORNECEDOR
                                                if (dt4.Rows[w][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                {
                                                    if (dt4.Rows[w][5].ToString() == "3" || dt4.Rows[w][5].ToString() == "2" || dt4.Rows[w][5].ToString() == "4")
                                                    {
                                                        int a = 0;
                                                        a = w - 1;
                                                        if (a >= 0)
                                                        {
                                                            //if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                            //}
                                                            if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                            {
                                                                if (dt4.Rows[a][5].ToString() == "14")
                                                                {
                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;0102");
                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");


                                                                }
                                                                //else if (dt4.Rows[a][5].ToString() == "15")
                                                                //{
                                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");

                                                                //}
                                                                //else
                                                                //{
                                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                                //}

                                                            }
                                                        }

                                                    }
                                                    else if (dt4.Rows[w][5].ToString() == "14")
                                                    {
                                                        int a = 0;
                                                        a = w - 1;
                                                        if (a >= 0)
                                                        {
                                                            if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                            {
                                                                if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "4")
                                                                {
                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                                }
                                                                else if (dt4.Rows[a][5].ToString() == "14")
                                                                {
                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");

                                                                }


                                                            }
                                                            else
                                                            {
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                            }

                                                        }


                                                    }


                                                }
                                                #endregion

                                                #region REINICIO
                                                //BLOCO REINICIO / INICIO DE VIAGEM
                                                if (dt4.Rows[w][2].ToString() == "REINICIO DE VIAGEM")
                                                {
                                                    int a = 0;
                                                    a = w - 1;
                                                    if (a >= 0)
                                                    {
                                                        if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                        {

                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "PARADA PERNOITE")
                                                        {
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                        }

                                                        else if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                        {

                                                            if (a >= 0)
                                                            {

                                                                if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                                {
                                                                    //if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                                    //{
                                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                                    //}
                                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                                    {

                                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");

                                                                    }
                                                                    //else if (dt4.Rows[a][5].ToString() == "15")
                                                                    //{

                                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");

                                                                    //}
                                                                    //else
                                                                    //{
                                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                                    //}
                                                                }
                                                                //else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                                //{
                                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                                //}


                                                            }



                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "PARADA")
                                                        {
                                                            if (dt4.Rows[a][5].ToString() == "14")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                            }
                                                            //else
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                            //}




                                                        }
                                                        //else if (dt4.Rows[a][2].ToString() == "OFICINA / MANUTENCAO")
                                                        //{

                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");


                                                        //}

                                                    }
                                                    else
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");
                                                        // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                    }



                                                }
                                                //FIM
                                                #endregion

                                                #region BLOCO PARADA
                                                // BLOCO PARADA
                                                if (dt4.Rows[w][2].ToString() == "PARADA")
                                                {
                                                    int a = 0;
                                                    a = w - 1;


                                                    if (dt4.Rows[w][5].ToString() == "14")
                                                    {
                                                        if (dt4.Rows.Count >= a)
                                                        {
                                                            if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                            {
                                                                // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");


                                                            }

                                                        }
                                                    }
                                                    //else
                                                    //{
                                                    //    if (dt4.Rows.Count >= a)
                                                    //    {
                                                    //        if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                    //        {
                                                    //            write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");

                                                    //        }
                                                    //        //else
                                                    //        //{
                                                    //        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //        //    // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                    //        //}
                                                    //    }
                                                    //}



                                                    //  write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");

                                                }
                                                //FIM
                                                #endregion

                                                #region FIM DE VIAGEM
                                                //BLOCO FIM DE VIAGEM
                                                if (dt4.Rows[w][2].ToString() == "FIM DE VIAGEM")
                                                {
                                                    int a = 0;
                                                    int g = 0;
                                                    a = w - 1;
                                                    g = w - 2;
                                                    if (a >= 0)
                                                    {
                                                        if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                        {


                                                            if (dt4.Rows[a][5].ToString() == "14")
                                                            {

                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;0102");

                                                            }

                                                            //else if (dt4.Rows[a][5].ToString() == "14")
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                            //    // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                            //}

                                                            //else
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //    // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                            //}



                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "PARADA")
                                                        {


                                                            if (dt4.Rows[a][5].ToString() == "14")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;0102");

                                                            }

                                                            //else
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //    // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");

                                                            //}


                                                        }

                                                        else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                        {
                                                            if (g >= 0)
                                                            {
                                                                //if (dt4.Rows[g][2].ToString() == "PARADA PERNOITE")
                                                                //{
                                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                                //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                //}
                                                                //else
                                                                //{
                                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                                //}
                                                            }
                                                            //else
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //}


                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                        }


                                                    }
                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //}

                                                }

                                                //
                                                #endregion

                                                #region FIM DE JORNADA
                                                //BLOCO FIM DE JORMADA
                                                if (c > 0)
                                                {
                                                    if (dt4.Rows[w][2].ToString() == "FIM DE JORNADA" && dt4.Rows[w][6].ToString() == "725405" || dt4.Rows[w][2].ToString() == "FIM DE JORNADA" && dt4.Rows[w][6].ToString() == "725407" || dt4.Rows[w][2].ToString() == "FIM DE JORNADA" && dt4.Rows[w][6].ToString() == "184525")
                                                    {
                                                        int a = 0;
                                                        a = w - 1;

                                                        if (a >= 0)
                                                        {
                                                            if (dt4.Rows[a][2].ToString() == "RETORNO REFEICAO")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                            {

                                                                //WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");


                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "RETORNO REFEICAO")
                                                            {

                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");

                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                            {
                                                                int b = 0;
                                                                b = a - 1;

                                                                if (b >= 0)
                                                                {
                                                                    if (dt4.Rows[b][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[b][2].ToString() == "REINICIO DE VIAGEM")
                                                                    {
                                                                        int d = 0;
                                                                        d = b - 1;
                                                                        if (d >= 0)
                                                                        {

                                                                            if (dt4.Rows[d][2].ToString() == "PARADA")
                                                                            {
                                                                                if (dt4.Rows[d][5].ToString() == "14")
                                                                                {
                                                                                    // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                                }
                                                                                else
                                                                                {
                                                                                    // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                                    // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                                }




                                                                            }
                                                                            else
                                                                            {
                                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                                // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                            }
                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                        // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                    }

                                                                }
                                                                else
                                                                {
                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                                }

                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "PARADA")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                            {
                                                                if (dt4.Rows[a][5].ToString() == "14")
                                                                {
                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                                }
                                                                else
                                                                {
                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                }
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");

                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "FIM DE JORNADA")
                                                            {
                                                                int m = 0;
                                                                m = a - 1;

                                                                if (m >= 0)
                                                                {
                                                                    if (dt4.Rows[m][2].ToString() == "RETORNO REFEICAO" || dt4.Rows[m][2].ToString() == "INICIO DE JORNADA")
                                                                    {
                                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                    }
                                                                    else if (dt4.Rows[m][2].ToString() == "FIM DE VIAGEM")
                                                                    {
                                                                        int b = 0;
                                                                        b = m - 1;

                                                                        if (b >= 0)
                                                                        {
                                                                            if (dt4.Rows[b][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[b][2].ToString() == "REINICIO DE VIAGEM")
                                                                            {
                                                                                int d = 0;
                                                                                d = b - 1;
                                                                                if (d >= 0)
                                                                                {

                                                                                    if (dt4.Rows[d][2].ToString() == "PARADA")
                                                                                    {
                                                                                        if (dt4.Rows[d][5].ToString() == "14")
                                                                                        {
                                                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                                            //.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                                                        }


                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                                    }
                                                                                }
                                                                            }
                                                                            else
                                                                            {
                                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                            }

                                                                        }


                                                                    }
                                                                    //else if (dt4.Rows[m][2].ToString() == "REINICIO DE VIAGEM")
                                                                    //{
                                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                                    //}
                                                                    //else if (dt4.Rows[m][2].ToString() == "PARADA INTERNA")
                                                                    //{
                                                                    //    if (dt4.Rows[m][5].ToString() == "3" || dt4.Rows[m][5].ToString() == "1" || dt4.Rows[m][5].ToString() == "2")
                                                                    //    {
                                                                    //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");

                                                                    //    }
                                                                    //    else if (dt4.Rows[m][5].ToString() == "22")
                                                                    //    {
                                                                    //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                                    //    }

                                                                    //    else if (dt4.Rows[m][2].ToString() == "FIM DE JORNADA")
                                                                    //    {
                                                                    //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                                    //        write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                    //    }

                                                                    //}
                                                                    else if (dt4.Rows[m][2].ToString() == "PARADA")
                                                                    {
                                                                        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                                    }
                                                                    //else if (dt4.Rows[m][2].ToString() == "PARADA INTERNA")
                                                                    //{
                                                                    //    if (dt4.Rows[m][5].ToString() != "3" || dt4.Rows[m][5].ToString() != "1" || dt4.Rows[m][5].ToString() != "2")
                                                                    //    {
                                                                    //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                                    //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                                    //        write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                                    //    }

                                                                    //}

                                                                    else
                                                                    {
                                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                    }


                                                                }
                                                                else
                                                                {
                                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                }
                                                            }
                                                            else
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            }


                                                        }
                                                        else
                                                        {
                                                            // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                        }
                                                    }

                                                }
                                                else
                                                {
                                                    if (dt4.Rows[w][2].ToString() == "FIM DE JORNADA")
                                                    {
                                                        int q = 0;
                                                        q = w + 1;

                                                        if (q < dt4.Rows.Count)
                                                        {
                                                            if (dt4.Rows[q][2].ToString() == "FIM DE JORNADA")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                            }
                                                            else
                                                            {
                                                                int a = 0;
                                                                a = w - 1;

                                                                if (a >= 0)
                                                                {

                                                                    if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM" || dt4.Rows[a][2].ToString() == "RETORNO REFEICAO" || dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                                    {
                                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                        // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                                    }
                                                                    //else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                                    //{
                                                                    //    if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                                    //    {
                                                                    //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                                    //        // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                                    //        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                                    //    }
                                                                    //    else if (dt4.Rows[a][5].ToString() == "14")
                                                                    //    {
                                                                    //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                                    //        write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                    //    }
                                                                    //    else
                                                                    //    {
                                                                    //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");


                                                                    //    }
                                                                    //}
                                                                    else if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                                    {

                                                                    }
                                                                    else if (dt4.Rows[a][2].ToString() == "FIM DE JORNADA")
                                                                    {
                                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                    }
                                                                    else
                                                                    {
                                                                        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                        // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                    }
                                                                }
                                                            }

                                                        }
                                                        else
                                                        {
                                                            int a = 0;
                                                            a = w - 1;

                                                            if (a >= 0)
                                                            {

                                                                if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                                {
                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");

                                                                }
                                                                else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                                {
                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                                }
                                                                else if (dt4.Rows[a][2].ToString() == "RETORNO REFEICAO")
                                                                {
                                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");

                                                                }
                                                                else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                                {
                                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                                    {
                                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                                    }
                                                                    else
                                                                    {
                                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                    }
                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");

                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                                }
                                                                //else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                                //{
                                                                //    if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                                //    {
                                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                                //        // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                                //        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                                //    }
                                                                //    else if (dt4.Rows[a][5].ToString() == "14")
                                                                //    {
                                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                                //        write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                //    }
                                                                //    else
                                                                //    {
                                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");

                                                                //    }
                                                                //}
                                                                else if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                                {

                                                                }
                                                                else if (dt4.Rows[a][2].ToString() == "FIM DE JORNADA")
                                                                {
                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");

                                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                }
                                                                else
                                                                {
                                                                    // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                }
                                                            }
                                                            else
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            }
                                                        }
                                                    }





                                                }


                                                #endregion

                                                #region PARADA PERNOITE

                                                if (dt4.Rows[w][2].ToString() == "PARADA PERNOITE")
                                                {
                                                    int a = 0;
                                                    a = w - 1;


                                                    if (a >= 0)
                                                    {
                                                        if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                        {


                                                            if (dt4.Rows[a][5].ToString() == "14")
                                                            {

                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                                //WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;0102");
                                                                write.WriteLine("+00" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm").Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");


                                                            }
                                                            else if (dt4.Rows[a][5].ToString() == "15")
                                                            {

                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;22");


                                                            }
                                                            //else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                            //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");
                                                            //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //}
                                                            else
                                                            {
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            }



                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "PARADA")
                                                        {
                                                            //if (dt4.Rows[a][5].ToString() == "7")
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");
                                                            //}
                                                            if (dt4.Rows[a][5].ToString() == "14")
                                                            {

                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                                //WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;0102");
                                                                write.WriteLine("+00" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm").Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");


                                                            }
                                                            else
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            }

                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM")
                                                        {
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";2;22");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";3;22");
                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                        {
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                            // write.WriteLine(cracha + ";" + data + ";" + hora + ";3;22");
                                                        }
                                                        //else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                        //{


                                                        //    if (dt4.Rows[a][5].ToString() == "14")
                                                        //    {

                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                        //        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");


                                                        //    }
                                                        //    //else if (dt4.Rows[a][5].ToString() == "15")
                                                        //    //{

                                                        //    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //    //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");


                                                        //    //}
                                                        //    else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                        //    {
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");
                                                        //        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //    }
                                                        //    //else
                                                        //    //{
                                                        //    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;22");
                                                        //    //}



                                                        //}
                                                        //else
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;22");
                                                        //}

                                                    }
                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;22");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");

                                                    //}

                                                }

                                                #endregion


                                                write.Flush();
                                                write.Close();
                                            }

                                            //FIM

                                            #endregion
                                        }



                                    }

                                }
                                else
                                {
                                    //JORNADA DIFERENCIA DE COMEÇO

                                    //VERIFICA SE A ULTIMA MARCAÇÃO DO DIA É PARADA PERNOITE OU FIM DE VIAGEM
                                    string sqlz = "select TOP 1 ds_macro from tb_parada where cod_cracha=" + dt1.Rows[x][0].ToString() + " and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).ToString("yyyy-MM-dd") + "' and fl_deletado is null order by hr_posicao  DESC ";
                                    SqlDataAdapter adtpz = new SqlDataAdapter(sqlz, con);
                                    DataTable dtz = new DataTable();
                                    con.Open();
                                    adtpz.Fill(dtz);
                                    con.Close();




                                    if (dtz.Rows[0][0].ToString() == "FIM DE JORNADA" || dtz.Rows[0][0].ToString() == "PARADA PERNOITE")
                                    {
                                        //JORNADA NORMAL COM DIFERENÇA NO COMEÇO
                                        string sqld = "select TOP 1  ds_macro, hr_posicao from tb_parada  where  cod_cracha=" + dt1.Rows[x][0].ToString() + " and fl_deletado is null and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).ToString("yyyy-MM-dd") + "'  and hr_posicao > (select top 1 hr_posicao from tb_parada where cod_cracha=" + dt1.Rows[x][0].ToString() + " and fl_deletado is null and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).ToString("yyyy-MM-dd") + "'  and ds_macro='FIM DE JORNADA'  OR cod_cracha=" + dt1.Rows[x][0].ToString() + " and fl_deletado is null and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).ToString("yyyy-MM-dd") + "'  and ds_macro='PARADA PERNOITE' order by hr_posicao) order by hr_posicao ";
                                        SqlDataAdapter adtpd = new SqlDataAdapter(sqld, con);
                                        DataTable dtd = new DataTable();
                                        con.Open();
                                        adtpd.Fill(dtd);
                                        con.Close();

                                        if (dtd.Rows.Count > 0)
                                        {

                                            #region Jornada Normal
                                            //string arquivo = "Transmot" + DateTime.Parse(txtDtInicial.Text).ToString("ddMM") + "001.txt";

                                            sql4 = "select dt_posicao_parada, hr_posicao, ds_macro,cod_transmissao, cod_cracha, isnull(cod_ref_parada,0) as cod_ref_parada, cod_idveiculo from tb_parada where fl_deletado is null and cod_cracha=" + dt1.Rows[x][0].ToString() + " and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).ToString("yyyy-MM-dd") + "' and fl_deletado is null and hr_posicao >= '" + dtd.Rows[0][1].ToString() + "' AND (ds_macro IN ('INICIO DE JORNADA', 'INICIO JORNADA CAMINHAO', 'PARADA REFEICAO', 'FIM DE JORNADA','REINICIO DE VIAGEM','FIM DE VIAGEM', 'PARADA','PARADA INTERNA','INICIO DE VIAGEM','PARADA INTERNA','RETORNO REFEICAO','PARADA CLIENTE / FORNECEDOR','PARADA PERNOITE') OR cod_ref_parada in (2,3,4,14,22)) AND fl_deletado IS NULL ORDER BY dt_posicao_parada, hr_posicao";
                                            // string sql4 = "select dt_posicao_parada, hr_posicao, ds_macro,cod_transmissao, cod_cracha, isnull(cod_ref_parada,0) as cod_ref_parada, cod_idveiculo from tb_parada where fl_deletado is null and cod_cracha=" + dt1.Rows[x][0].ToString() + " and dt_posicao_parada between '" + txtDtInicial.Text + "' and '" + txtDtFinal.Text + "' order by dt_posicao_parada, hr_posicao";
                                            SqlDataAdapter adtp4 = new SqlDataAdapter(sql4, con);
                                            DataTable dt4 = new DataTable();

                                            try
                                            {
                                                con.Open();
                                                adtp4.Fill(dt4);
                                                con.Close();
                                            }
                                            catch (Exception ed)
                                            {
                                                // MessageBox.Show(ed.ToString(), "Erro3");
                                            }

                                            c = 0;

                                            for (int y = 0; y < dt4.Rows.Count; y++)
                                            {
                                                if (dt4.Rows[y][2].ToString() == "FIM DE JORNADA" && dt4.Rows[y][6].ToString() == "725405" || dt4.Rows[y][2].ToString() == "FIM DE JORNADA" && dt4.Rows[y][6].ToString() == "725407" || dt4.Rows[y][2].ToString() == "FIM DE JORNADA" && dt4.Rows[y][6].ToString() == "184525")
                                                {
                                                    c = c + 1;
                                                }

                                            }
                                            string caminho = Server.MapPath("/TXT/");

                                            string filepath = caminho + arquivo;

                                            FileInfo file = new FileInfo(filepath);

                                            //if (file.Exists)
                                            //{
                                            //    file.Delete();
                                            //}


                                            for (int w = 0; w < dt4.Rows.Count; w++)
                                            {
                                                //if (chkDiadema.Checked || chkCadiriri.Checked)
                                                //{


                                                //        if (dt1.Rows[x][0].ToString().Length < 4)
                                                //        {
                                                //            cracha = "300" + dt1.Rows[x][0].ToString();
                                                //        }
                                                //        else if (dt1.Rows[x][0].ToString().Length >= 4 || dt1.Rows[x][0].ToString().Length <= 5)
                                                //        {
                                                //            cracha = "30" + dt1.Rows[x][0].ToString();
                                                //        }
                                                //        else
                                                //        {
                                                //            cracha = dt1.Rows[x][0].ToString();
                                                //        }




                                                //}
                                                //else
                                                //{
                                                //    if (dt1.Rows[x][0].ToString().Length < 4)
                                                //    {
                                                //        cracha = "300" + dt1.Rows[x][0].ToString();
                                                //    }
                                                //    else if (dt1.Rows[x][0].ToString().Length >= 4 || dt1.Rows[x][0].ToString().Length <= 5)
                                                //    {
                                                //        cracha = "30" + dt1.Rows[x][0].ToString();
                                                //    }
                                                //    else
                                                //    {
                                                //        cracha = dt1.Rows[x][0].ToString();
                                                //    }
                                                //}
                                                string codigo = dt1.Rows[x][0].ToString();
                                                string[] codigosEspeciais = { "330", "482", "820", "958", "989" };

                                                if (codigo.StartsWith("312"))
                                                {
                                                    cracha = codigo.Insert(3, "0");
                                                }
                                                else if ((codigosEspeciais.Contains(codigo) || codigo.Length <= 4))
                                                {
                                                    cracha = "30" + codigo;
                                                }
                                                else if (codigo.Length <= 3)
                                                {
                                                    cracha = "300" + codigo;
                                                }

                                                else
                                                {
                                                    cracha = codigo;
                                                }





                                                //  cracha = "30" + dt1.Rows[x][0].ToString();
                                                int t = 0;
                                                t = w - 1;

                                                string data = DateTime.Parse(dt4.Rows[w][0].ToString()).ToString("dd/MM/yy");
                                                string horas = DateTime.Parse(dt4.Rows[w][1].ToString()).ToString("HH:mm");
                                                if (t >= 0)
                                                {
                                                    if (DateTime.Parse(dt4.Rows[w][1].ToString()).ToString("HH:mm") == DateTime.Parse(dt4.Rows[t][1].ToString()).ToString("HH:mm"))
                                                    {
                                                        hora = DateTime.Parse(horas).AddMinutes(1).ToString("HH:mm");
                                                    }
                                                    else
                                                    {
                                                        hora = DateTime.Parse(horas).ToString("HH:mm");
                                                    }
                                                }
                                                else
                                                {
                                                    hora = DateTime.Parse(horas).ToString("HH:mm");
                                                }
                                                //tipo = dt4.Rows[w][2].ToString();
                                                string transmissao = dt4.Rows[w][3].ToString();


                                                //if (dt4.Rows[w][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[w][2].ToString() == "TRECHO ALMOÇO" || dt4.Rows[w][2].ToString() == "FIM DE JORNADA")
                                                //{
                                                //    tipo = "2";
                                                //}
                                                //else  if (dt4.Rows[w][2].ToString() == "PARADA FORNECEDOR" || dt4.Rows[w][2].ToString() == "REINICIO DE VIAGEM")
                                                //{
                                                //    tipo = "21";
                                                //}






                                                StreamWriter write = new StreamWriter(caminho + arquivo, true);


                                                #region BLOCO INICIO JORNADA
                                                //BLOCO INICIO JORNADA
                                                if (dt4.Rows[w][2].ToString() == "INICIO DE JORNADA")
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");
                                                }

                                                if (dt4.Rows[w][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[w][2].ToString() == "INICIO JORNADA")
                                                {

                                                    int a = 0;
                                                    a = w - 1;
                                                    if (a >= 0)
                                                    {
                                                        if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");

                                                        }
                                                        else
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");

                                                        }
                                                    }
                                                    else
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    }


                                                }
                                                //FIM
                                                #endregion

                                                #region BLOCO INICIO JORNADA CAMINHAO
                                                //BLOCO INICIO JORNADA CAMINHAO

                                                if (dt4.Rows[w][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[w][2].ToString() == "INICIO JORNADA")
                                                {

                                                    int a = 0;
                                                    a = w - 1;
                                                    if (a >= 0)
                                                    {
                                                        if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");

                                                        }
                                                        else
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");
                                                        }
                                                    }
                                                    else
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    }


                                                }
                                                //FIM
                                                #endregion

                                                #region PARADA INTERNA
                                                //BLOCO PARADA INTERNA
                                                if (dt4.Rows[w][2].ToString() == "PARADA INTERNA")
                                                {
                                                    if (dt4.Rows[w][5].ToString() == "3" || dt4.Rows[w][5].ToString() == "2")
                                                    {
                                                        int a = 0;
                                                        a = w - 1;
                                                        if (a >= 0)
                                                        {
                                                            if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                            }
                                                            else if (dt4.Rows[a][5].ToString() == "14")
                                                            {
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                            }
                                                            else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "1")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "PARADA REFEICAO")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM")
                                                            {
                                                                //////write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                                ////write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                                ////write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                            }
                                                            else
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                            }

                                                        }

                                                    }
                                                    else if (dt4.Rows[w][5].ToString() == "14")
                                                    {
                                                        int a = 0;
                                                        a = w - 1;
                                                        if (a >= 0)
                                                        {
                                                            if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                            {
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                            }
                                                            if (dt4.Rows[a][5].ToString() == "14")
                                                            {
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                            }
                                                            else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "1")
                                                            {
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "PARADA REFEICAO")
                                                            {
                                                                // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                            {
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                            {

                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");

                                                            }
                                                            if (dt4.Rows[a][5].ToString() == "22")
                                                            {
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                            }
                                                            //else
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93: 71489");
                                                            //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                            //}

                                                        }
                                                    }
                                                    else if (dt4.Rows[w][5].ToString() == "22")
                                                    {
                                                        int a = 0;
                                                        a = w - 1;
                                                        if (a >= 0)
                                                        {

                                                            if (dt4.Rows[a][5].ToString() == "14")
                                                            {
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                            }


                                                        }
                                                    }
                                                    else
                                                    {
                                                        int a = 0;
                                                        a = w - 1;
                                                        if (a >= 0)
                                                        {
                                                            if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");
                                                            }
                                                            if (dt4.Rows[a][5].ToString() == "14")
                                                            {
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                            }

                                                            else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "1")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");
                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "PARADA REFEICAO")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                                //// write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                            {

                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");
                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                            {

                                                                //// write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");

                                                            }

                                                        }
                                                    }

                                                }
                                                //FIM 
                                                #endregion

                                                #region BLOCO PARADA REFEIÇÃO
                                                //BLOCO PARADA REFEIÇÃO
                                                if (dt4.Rows[w][2].ToString() == "PARADA REFEICAO")
                                                {
                                                    int a = 0;
                                                    a = w - 1;
                                                    if (a >= 0)
                                                    {
                                                        //if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                        //{

                                                        //    if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                        //    {
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;93");
                                                        //    }
                                                        //    else
                                                        //    {
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;93");
                                                        //    }
                                                        //}
                                                        if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");

                                                        }
                                                        else
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                        }

                                                    }
                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;93");
                                                    //}
                                                }
                                                //FIM
                                                #endregion

                                                #region RETORNO REFEIÇAO
                                                //BLOCO RETORNO REFEIÇAO
                                                if (dt4.Rows[w][2].ToString() == "RETORNO REFEICAO")
                                                {

                                                    int a = 0;
                                                    int b = 0;
                                                    a = w - 1;
                                                    b = w + 1;
                                                    if (a >= 0)
                                                    {

                                                        if (dt4.Rows[a][2].ToString() == "PARADA REFEICAO")
                                                        {

                                                            // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;0102");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");

                                                        }
                                                        //if (dt4.Rows[b][2].ToString() == "FIM DE JORNADA")
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                        //}
                                                        //else
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                        //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");

                                                        //}
                                                    }


                                                }
                                                //FIM
                                                #endregion

                                                #region INICIO DE VIAGEM
                                                //BLOCO REINICIO / INICIO DE VIAGEM
                                                if (dt4.Rows[w][2].ToString() == "INICIO DE VIAGEM")
                                                {
                                                    int a = 0;
                                                    a = w - 1;
                                                    if (a >= 0)
                                                    {
                                                        //if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                        //{
                                                        //    if (dt4.Rows[a][5].ToString() == "14")
                                                        //    {
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");

                                                        //    }
                                                        //    else
                                                        //        if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                        //    {
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");

                                                        //    }
                                                        //    else
                                                        //    {
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                        //    }
                                                        //}
                                                        //if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                        //}
                                                        //else if (dt4.Rows[a][2].ToString() == "PARADA PERNOITE")
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;22");
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                        //}
                                                        //else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                        //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                        //}

                                                        if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                        {


                                                            if (dt4.Rows[a][5].ToString() == "14")
                                                            {

                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");



                                                            }
                                                            //else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "1" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "4")
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                            //}



                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "PARADA")
                                                        {


                                                            if (dt4.Rows[a][5].ToString() == "14")
                                                            {

                                                                // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                            }
                                                            //else
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");



                                                            //}



                                                        }
                                                        //else if (dt4.Rows[a][2].ToString() == "RETORNO REFEICAO")
                                                        //{
                                                        //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                        //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                        //    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");

                                                        //}

                                                    }
                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //}



                                                }
                                                //FIM
                                                #endregion

                                                #region PARADA CLIENTE / FORNECEDOR
                                                if (dt4.Rows[w][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                {
                                                    if (dt4.Rows[w][5].ToString() == "3" || dt4.Rows[w][5].ToString() == "2" || dt4.Rows[w][5].ToString() == "4")
                                                    {
                                                        int a = 0;
                                                        a = w - 1;
                                                        if (a >= 0)
                                                        {
                                                            //if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                            //}
                                                            if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                            {
                                                                if (dt4.Rows[a][5].ToString() == "14")
                                                                {
                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;0102");
                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");


                                                                }
                                                                //else if (dt4.Rows[a][5].ToString() == "15")
                                                                //{
                                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");

                                                                //}
                                                                //else
                                                                //{
                                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                                //}

                                                            }
                                                        }

                                                    }
                                                    else if (dt4.Rows[w][5].ToString() == "14")
                                                    {
                                                        int a = 0;
                                                        a = w - 1;
                                                        if (a >= 0)
                                                        {
                                                            if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                            {
                                                                if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "4")
                                                                {
                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                                }
                                                                else if (dt4.Rows[a][5].ToString() == "14")
                                                                {
                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");

                                                                }


                                                            }
                                                            else
                                                            {
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                            }

                                                        }


                                                    }


                                                }
                                                #endregion

                                                #region REINICIO
                                                //BLOCO REINICIO / INICIO DE VIAGEM
                                                if (dt4.Rows[w][2].ToString() == "REINICIO DE VIAGEM")
                                                {
                                                    int a = 0;
                                                    a = w - 1;
                                                    if (a >= 0)
                                                    {
                                                        if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                        {

                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "PARADA PERNOITE")
                                                        {
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                        }

                                                        else if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                        {

                                                            if (a >= 0)
                                                            {

                                                                if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                                {
                                                                    //if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                                    //{
                                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                                    //}
                                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                                    {

                                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");

                                                                    }
                                                                    //else if (dt4.Rows[a][5].ToString() == "15")
                                                                    //{

                                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");

                                                                    //}
                                                                    //else
                                                                    //{
                                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                                    //}
                                                                }
                                                                //else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                                //{
                                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                                //}


                                                            }



                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "PARADA")
                                                        {
                                                            if (dt4.Rows[a][5].ToString() == "14")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                            }
                                                            //else
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                            //}




                                                        }
                                                        //else if (dt4.Rows[a][2].ToString() == "OFICINA / MANUTENCAO")
                                                        //{

                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");


                                                        //}

                                                    }
                                                    else
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");
                                                        // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                    }



                                                }
                                                //FIM
                                                #endregion

                                                #region BLOCO PARADA
                                                // BLOCO PARADA
                                                if (dt4.Rows[w][2].ToString() == "PARADA")
                                                {
                                                    int a = 0;
                                                    a = w - 1;


                                                    if (dt4.Rows[w][5].ToString() == "14")
                                                    {
                                                        if (dt4.Rows.Count >= a)
                                                        {
                                                            if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                            {
                                                                // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");


                                                            }

                                                        }
                                                    }
                                                    //else
                                                    //{
                                                    //    if (dt4.Rows.Count >= a)
                                                    //    {
                                                    //        if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                    //        {
                                                    //            write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");

                                                    //        }
                                                    //        //else
                                                    //        //{
                                                    //        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //        //    // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                    //        //}
                                                    //    }
                                                    //}



                                                    //  write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");

                                                }
                                                //FIM
                                                #endregion

                                                #region FIM DE VIAGEM
                                                //BLOCO FIM DE VIAGEM
                                                if (dt4.Rows[w][2].ToString() == "FIM DE VIAGEM")
                                                {
                                                    int a = 0;
                                                    int g = 0;
                                                    a = w - 1;
                                                    g = w - 2;
                                                    if (a >= 0)
                                                    {
                                                        if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                        {


                                                            if (dt4.Rows[a][5].ToString() == "14")
                                                            {

                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;0102");

                                                            }

                                                            //else if (dt4.Rows[a][5].ToString() == "14")
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                            //    // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                            //}

                                                            //else
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //    // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                            //}



                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "PARADA")
                                                        {


                                                            if (dt4.Rows[a][5].ToString() == "14")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;0102");

                                                            }

                                                            //else
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //    // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");

                                                            //}


                                                        }

                                                        else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                        {
                                                            if (g >= 0)
                                                            {
                                                                //if (dt4.Rows[g][2].ToString() == "PARADA PERNOITE")
                                                                //{
                                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                                //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                //}
                                                                //else
                                                                //{
                                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                                //}
                                                            }
                                                            //else
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //}


                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                        }


                                                    }
                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //}

                                                }

                                                //
                                                #endregion

                                                #region FIM DE JORNADA
                                                //BLOCO FIM DE JORMADA
                                                if (c > 0)
                                                {
                                                    if (dt4.Rows[w][2].ToString() == "FIM DE JORNADA" && dt4.Rows[w][6].ToString() == "725405" || dt4.Rows[w][2].ToString() == "FIM DE JORNADA" && dt4.Rows[w][6].ToString() == "725407" || dt4.Rows[w][2].ToString() == "FIM DE JORNADA" && dt4.Rows[w][6].ToString() == "184525")
                                                    {
                                                        int a = 0;
                                                        a = w - 1;

                                                        if (a >= 0)
                                                        {
                                                            if (dt4.Rows[a][2].ToString() == "RETORNO REFEICAO")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                            {

                                                                //WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");


                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "RETORNO REFEICAO")
                                                            {

                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");

                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                            {
                                                                int b = 0;
                                                                b = a - 1;

                                                                if (b >= 0)
                                                                {
                                                                    if (dt4.Rows[b][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[b][2].ToString() == "REINICIO DE VIAGEM")
                                                                    {
                                                                        int d = 0;
                                                                        d = b - 1;
                                                                        if (d >= 0)
                                                                        {

                                                                            if (dt4.Rows[d][2].ToString() == "PARADA")
                                                                            {
                                                                                if (dt4.Rows[d][5].ToString() == "14")
                                                                                {
                                                                                    // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                                }
                                                                                else
                                                                                {
                                                                                    // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                                    // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                                }




                                                                            }
                                                                            else
                                                                            {
                                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                                // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                            }
                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                        // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                    }

                                                                }
                                                                else
                                                                {
                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                                }

                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "PARADA")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                            {
                                                                if (dt4.Rows[a][5].ToString() == "14")
                                                                {
                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                                }
                                                                else
                                                                {
                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                }
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");

                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "FIM DE JORNADA")
                                                            {
                                                                int m = 0;
                                                                m = a - 1;

                                                                if (m >= 0)
                                                                {
                                                                    if (dt4.Rows[m][2].ToString() == "RETORNO REFEICAO" || dt4.Rows[m][2].ToString() == "INICIO DE JORNADA")
                                                                    {
                                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                    }
                                                                    else if (dt4.Rows[m][2].ToString() == "FIM DE VIAGEM")
                                                                    {
                                                                        int b = 0;
                                                                        b = m - 1;

                                                                        if (b >= 0)
                                                                        {
                                                                            if (dt4.Rows[b][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[b][2].ToString() == "REINICIO DE VIAGEM")
                                                                            {
                                                                                int d = 0;
                                                                                d = b - 1;
                                                                                if (d >= 0)
                                                                                {

                                                                                    if (dt4.Rows[d][2].ToString() == "PARADA")
                                                                                    {
                                                                                        if (dt4.Rows[d][5].ToString() == "14")
                                                                                        {
                                                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                                            //.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                                                        }


                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                                    }
                                                                                }
                                                                            }
                                                                            else
                                                                            {
                                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                            }

                                                                        }


                                                                    }
                                                                    //else if (dt4.Rows[m][2].ToString() == "REINICIO DE VIAGEM")
                                                                    //{
                                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                                    //}
                                                                    //else if (dt4.Rows[m][2].ToString() == "PARADA INTERNA")
                                                                    //{
                                                                    //    if (dt4.Rows[m][5].ToString() == "3" || dt4.Rows[m][5].ToString() == "1" || dt4.Rows[m][5].ToString() == "2")
                                                                    //    {
                                                                    //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");

                                                                    //    }
                                                                    //    else if (dt4.Rows[m][5].ToString() == "22")
                                                                    //    {
                                                                    //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                                    //    }

                                                                    //    else if (dt4.Rows[m][2].ToString() == "FIM DE JORNADA")
                                                                    //    {
                                                                    //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                                    //        write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                    //    }

                                                                    //}
                                                                    else if (dt4.Rows[m][2].ToString() == "PARADA")
                                                                    {
                                                                        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                                    }
                                                                    //else if (dt4.Rows[m][2].ToString() == "PARADA INTERNA")
                                                                    //{
                                                                    //    if (dt4.Rows[m][5].ToString() != "3" || dt4.Rows[m][5].ToString() != "1" || dt4.Rows[m][5].ToString() != "2")
                                                                    //    {
                                                                    //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                                    //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                                    //        write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                                    //    }

                                                                    //}

                                                                    else
                                                                    {
                                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                    }


                                                                }
                                                                else
                                                                {
                                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                }
                                                            }
                                                            else
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            }


                                                        }
                                                        else
                                                        {
                                                            // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                        }
                                                    }

                                                }
                                                else
                                                {
                                                    if (dt4.Rows[w][2].ToString() == "FIM DE JORNADA")
                                                    {
                                                        int q = 0;
                                                        q = w + 1;

                                                        if (q < dt4.Rows.Count)
                                                        {
                                                            if (dt4.Rows[q][2].ToString() == "FIM DE JORNADA")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                            }
                                                            else
                                                            {
                                                                int a = 0;
                                                                a = w - 1;

                                                                if (a >= 0)
                                                                {

                                                                    if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM" || dt4.Rows[a][2].ToString() == "RETORNO REFEICAO" || dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                                    {
                                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                        // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                                    }
                                                                    //else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                                    //{
                                                                    //    if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                                    //    {
                                                                    //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                                    //        // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                                    //        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                                    //    }
                                                                    //    else if (dt4.Rows[a][5].ToString() == "14")
                                                                    //    {
                                                                    //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                                    //        write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                    //    }
                                                                    //    else
                                                                    //    {
                                                                    //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");


                                                                    //    }
                                                                    //}
                                                                    else if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                                    {

                                                                    }
                                                                    else if (dt4.Rows[a][2].ToString() == "FIM DE JORNADA")
                                                                    {
                                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                    }
                                                                    else
                                                                    {
                                                                        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                        // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                    }
                                                                }
                                                            }

                                                        }
                                                        else
                                                        {
                                                            int a = 0;
                                                            a = w - 1;

                                                            if (a >= 0)
                                                            {

                                                                if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                                {
                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");

                                                                }
                                                                else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                                {
                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                                }
                                                                else if (dt4.Rows[a][2].ToString() == "RETORNO REFEICAO")
                                                                {
                                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");

                                                                }
                                                                else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                                {
                                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                                    {
                                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                                    }
                                                                    else
                                                                    {
                                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                    }
                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");

                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                                }
                                                                //else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                                //{
                                                                //    if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                                //    {
                                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                                //        // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                                //        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                                //    }
                                                                //    else if (dt4.Rows[a][5].ToString() == "14")
                                                                //    {
                                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                                //        write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                //    }
                                                                //    else
                                                                //    {
                                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");

                                                                //    }
                                                                //}
                                                                else if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                                {

                                                                }
                                                                else if (dt4.Rows[a][2].ToString() == "FIM DE JORNADA")
                                                                {
                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");

                                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                }
                                                                else
                                                                {
                                                                    // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                }
                                                            }
                                                            else
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            }
                                                        }
                                                    }





                                                }


                                                #endregion

                                                #region PARADA PERNOITE

                                                if (dt4.Rows[w][2].ToString() == "PARADA PERNOITE")
                                                {
                                                    int a = 0;
                                                    a = w - 1;


                                                    if (a >= 0)
                                                    {
                                                        if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                        {


                                                            if (dt4.Rows[a][5].ToString() == "14")
                                                            {

                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                                //WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;0102");
                                                                write.WriteLine("+00" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm").Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");


                                                            }
                                                            else if (dt4.Rows[a][5].ToString() == "15")
                                                            {

                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;22");


                                                            }
                                                            //else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                            //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");
                                                            //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //}
                                                            else
                                                            {
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            }



                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "PARADA")
                                                        {
                                                            //if (dt4.Rows[a][5].ToString() == "7")
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");
                                                            //}
                                                            if (dt4.Rows[a][5].ToString() == "14")
                                                            {

                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                                //WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;0102");
                                                                write.WriteLine("+00" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm").Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");


                                                            }
                                                            else
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            }

                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM")
                                                        {
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";2;22");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";3;22");
                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                        {
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                            // write.WriteLine(cracha + ";" + data + ";" + hora + ";3;22");
                                                        }
                                                        //else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                        //{


                                                        //    if (dt4.Rows[a][5].ToString() == "14")
                                                        //    {

                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                        //        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");


                                                        //    }
                                                        //    //else if (dt4.Rows[a][5].ToString() == "15")
                                                        //    //{

                                                        //    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //    //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");


                                                        //    //}
                                                        //    else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                        //    {
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");
                                                        //        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //    }
                                                        //    //else
                                                        //    //{
                                                        //    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;22");
                                                        //    //}



                                                        //}
                                                        //else
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;22");
                                                        //}

                                                    }
                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;22");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");

                                                    //}

                                                }

                                                #endregion

                                                write.Flush();
                                                write.Close();

                                            }

                                            //FIM

                                            #endregion
                                        }
                                        else
                                        {

                                        }

                                    }
                                    else
                                    {
                                        //JORNADA PERNOITE COM DIFERENÇA NO COMEÇO
                                        string sqli = "select TOP 1  hr_posicao from tb_parada  where  cod_cracha=" + dt1.Rows[x][0].ToString() + " and fl_deletado is null and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).ToString("yyyy-MM-dd") + "'  and hr_posicao > (select top 1 hr_posicao from tb_parada where cod_cracha=" + dt1.Rows[x][0].ToString() + " and fl_deletado is null and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).ToString("yyyy-MM-dd") + "'  and ds_macro='FIM DE JORNADA'  OR cod_cracha=" + dt1.Rows[x][0].ToString() + " and fl_deletado is null and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).ToString("yyyy-MM-dd") + "'  and ds_macro='PARADA PERNOITE' order by hr_posicao) order by hr_posicao ";
                                        SqlDataAdapter adtpi = new SqlDataAdapter(sqli, con);
                                        DataTable dti = new DataTable();
                                        con.Open();
                                        adtpi.Fill(dti);
                                        con.Close();

                                        string sqlf = "select top 1 hr_posicao from tb_parada where cod_cracha=" + dt1.Rows[x][0].ToString() + " and ds_macro = 'FIM DE JORNADA' and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).AddDays(1).ToString("yyyy-MM-dd") + "' and fl_deletado is null OR cod_cracha=" + dt1.Rows[x][0].ToString() + " and ds_macro='PARADA PERNOITE' and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).AddDays(1).ToString("yyyy-MM-dd") + "' and fl_deletado is null order by hr_posicao";
                                        SqlDataAdapter adtpf = new SqlDataAdapter(sqlf, con);
                                        DataTable dtf = new DataTable();
                                        con.Open();
                                        adtpf.Fill(dtf);
                                        con.Close();



                                        if (dti.Rows.Count > 0 && dtf.Rows.Count > 0)
                                        {
                                            #region Jornada Noturna


                                            //sql4 = "select dt_posicao_parada, hr_posicao, ds_macro,cod_transmissao, cod_cracha, isnull(cod_ref_parada,0) as cod_ref_parada, cod_idveiculo from tb_parada where fl_deletado is null and cod_cracha=" + dt1.Rows[x][0].ToString() + " and dt_posicao_parada='" + txtDtInicial.Text + "' order by dt_posicao_parada, hr_posicao";
                                            sql4 = "select dt_posicao_parada, hr_posicao, ds_macro,cod_transmissao, cod_cracha, isnull(cod_ref_parada,0) as cod_ref_parada, cod_idveiculo from tb_parada where fl_deletado is null and cod_cracha=" + dt1.Rows[x][0].ToString() + " and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).ToString("yyyy-MM-dd") + "' and hr_posicao >='" + dti.Rows[0][0].ToString() + "' or cod_cracha=" + dt1.Rows[x][0].ToString() + " and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).AddDays(1).ToString("yyyy-MM-dd") + "' and hr_posicao <= '" + dtf.Rows[0][0].ToString() + "' AND (ds_macro IN ('INICIO DE JORNADA', 'INICIO JORNADA CAMINHAO', 'PARADA REFEICAO', 'FIM DE JORNADA','REINICIO DE VIAGEM','FIM DE VIAGEM', 'PARADA','INICIO DE VIAGEM','PARADA INTERNA','RETORNO REFEICAO','PARADA CLIENTE / FORNECEDOR','PARADA PERNOITE') OR cod_ref_parada in (2,3,4,14,22)) AND fl_deletado IS NULL ORDER BY dt_posicao_parada, hr_posicao";
                                            // string sql4 = "select dt_posicao_parada, hr_posicao, ds_macro,cod_transmissao, cod_cracha, isnull(cod_ref_parada,0) as cod_ref_parada, cod_idveiculo from tb_parada where fl_deletado is null and cod_cracha=" + dt1.Rows[x][0].ToString() + " and dt_posicao_parada between '" + txtDtInicial.Text + "' and '" + txtDtFinal.Text + "' order by dt_posicao_parada, hr_posicao";
                                            SqlDataAdapter adtp4 = new SqlDataAdapter(sql4, con);
                                            DataTable dt4 = new DataTable();

                                            try
                                            {
                                                con.Open();
                                                adtp4.Fill(dt4);
                                                con.Close();
                                            }
                                            catch (Exception ed)
                                            {
                                                //MessageBox.Show(ed.ToString(), "Erro3");
                                            }

                                            c = 0;

                                            for (int y = 0; y < dt4.Rows.Count; y++)
                                            {
                                                if (dt4.Rows[y][2].ToString() == "FIM DE JORNADA" && dt4.Rows[y][6].ToString() == "725405" || dt4.Rows[y][2].ToString() == "FIM DE JORNADA" && dt4.Rows[y][6].ToString() == "725407" || dt4.Rows[y][2].ToString() == "FIM DE JORNADA" && dt4.Rows[y][6].ToString() == "184525")
                                                {
                                                    c = c + 1;
                                                }

                                            }
                                            string caminho = Server.MapPath("/TXT/");

                                            string filepath = caminho + arquivo;

                                            FileInfo file = new FileInfo(filepath);
                                            //if(file.Exists)
                                            //{
                                            //    file.Delete();
                                            //}



                                            for (int w = 0; w < dt4.Rows.Count; w++)
                                            {

                                                string codigo = dt1.Rows[x][0].ToString();
                                                string[] codigosEspeciais = { "330", "482", "820", "958", "989" };

                                                if (codigo.StartsWith("312"))
                                                {
                                                    cracha = codigo.Insert(3, "0");
                                                }
                                                else if ((codigosEspeciais.Contains(codigo) || codigo.Length <= 4))
                                                {
                                                    cracha = "30" + codigo;
                                                }
                                                else if (codigo.Length <= 3)
                                                {
                                                    cracha = "300" + codigo;
                                                }

                                                else
                                                {
                                                    cracha = codigo;
                                                }

                                                // cracha = "30" + dt1.Rows[x][0].ToString();
                                                int t = 0;
                                                t = w - 1;
                                                string data = DateTime.Parse(dt4.Rows[w][0].ToString()).ToString("dd/MM/yy");
                                                string horas = DateTime.Parse(dt4.Rows[w][1].ToString()).ToString("HH:mm");
                                                if (t >= 0)
                                                {
                                                    if (DateTime.Parse(dt4.Rows[w][1].ToString()).ToString("HH:mm") == DateTime.Parse(dt4.Rows[t][1].ToString()).ToString("HH:mm"))
                                                    {
                                                        hora = DateTime.Parse(horas).AddMinutes(1).ToString("HH:mm");
                                                    }
                                                    else
                                                    {
                                                        hora = DateTime.Parse(horas).ToString("HH:mm");
                                                    }
                                                }
                                                else
                                                {
                                                    hora = DateTime.Parse(horas).ToString("HH:mm");
                                                }
                                                //tipo = dt4.Rows[w][2].ToString();
                                                string transmissao = dt4.Rows[w][3].ToString();


                                                //if (dt4.Rows[w][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[w][2].ToString() == "TRECHO ALMOÇO" || dt4.Rows[w][2].ToString() == "FIM DE JORNADA")
                                                //{
                                                //    tipo = "2";
                                                //}
                                                //else  if (dt4.Rows[w][2].ToString() == "PARADA FORNECEDOR" || dt4.Rows[w][2].ToString() == "REINICIO DE VIAGEM")
                                                //{
                                                //    tipo = "21";
                                                //}



                                                StreamWriter write = new StreamWriter(caminho + arquivo, true);

                                                #region BLOCO INICIO JORNADA
                                                //BLOCO INICIO JORNADA
                                                if (dt4.Rows[w][2].ToString() == "INICIO DE JORNADA")
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");
                                                }

                                                if (dt4.Rows[w][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[w][2].ToString() == "INICIO JORNADA")
                                                {

                                                    int a = 0;
                                                    a = w - 1;
                                                    if (a >= 0)
                                                    {
                                                        if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");

                                                        }
                                                        else
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");

                                                        }
                                                    }
                                                    else
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    }


                                                }
                                                //FIM
                                                #endregion

                                                #region BLOCO INICIO JORNADA CAMINHAO
                                                //BLOCO INICIO JORNADA CAMINHAO

                                                if (dt4.Rows[w][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[w][2].ToString() == "INICIO JORNADA")
                                                {

                                                    int a = 0;
                                                    a = w - 1;
                                                    if (a >= 0)
                                                    {
                                                        if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");

                                                        }
                                                        else
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");
                                                        }
                                                    }
                                                    else
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    }


                                                }
                                                //FIM
                                                #endregion

                                                #region PARADA INTERNA
                                                //BLOCO PARADA INTERNA
                                                if (dt4.Rows[w][2].ToString() == "PARADA INTERNA")
                                                {
                                                    if (dt4.Rows[w][5].ToString() == "3" || dt4.Rows[w][5].ToString() == "2")
                                                    {
                                                        int a = 0;
                                                        a = w - 1;
                                                        if (a >= 0)
                                                        {
                                                            if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                            }
                                                            else if (dt4.Rows[a][5].ToString() == "14")
                                                            {
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                            }
                                                            else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "1")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "PARADA REFEICAO")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM")
                                                            {
                                                                //////write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                                ////write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                                ////write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                            }
                                                            else
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                            }

                                                        }

                                                    }
                                                    else if (dt4.Rows[w][5].ToString() == "14")
                                                    {
                                                        int a = 0;
                                                        a = w - 1;
                                                        if (a >= 0)
                                                        {
                                                            if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                            {
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                            }
                                                            if (dt4.Rows[a][5].ToString() == "14")
                                                            {
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                            }
                                                            else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "1")
                                                            {
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "PARADA REFEICAO")
                                                            {
                                                                // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                            {
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                            {

                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");

                                                            }
                                                            if (dt4.Rows[a][5].ToString() == "22")
                                                            {
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                            }
                                                            //else
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93: 71489");
                                                            //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                            //}

                                                        }
                                                    }
                                                    else if (dt4.Rows[w][5].ToString() == "22")
                                                    {
                                                        int a = 0;
                                                        a = w - 1;
                                                        if (a >= 0)
                                                        {

                                                            if (dt4.Rows[a][5].ToString() == "14")
                                                            {
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                            }


                                                        }
                                                    }
                                                    else
                                                    {
                                                        int a = 0;
                                                        a = w - 1;
                                                        if (a >= 0)
                                                        {
                                                            if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");
                                                            }
                                                            if (dt4.Rows[a][5].ToString() == "14")
                                                            {
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                            }

                                                            else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "1")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");
                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "PARADA REFEICAO")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                                //// write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                            {

                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");
                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                            {

                                                                //// write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");

                                                            }

                                                        }
                                                    }

                                                }
                                                //FIM 
                                                #endregion

                                                #region BLOCO PARADA REFEIÇÃO
                                                //BLOCO PARADA REFEIÇÃO
                                                if (dt4.Rows[w][2].ToString() == "PARADA REFEICAO")
                                                {
                                                    int a = 0;
                                                    a = w - 1;
                                                    if (a >= 0)
                                                    {
                                                        //if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                        //{

                                                        //    if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                        //    {
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;93");
                                                        //    }
                                                        //    else
                                                        //    {
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;93");
                                                        //    }
                                                        //}
                                                        if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");

                                                        }
                                                        else
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                        }

                                                    }
                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;93");
                                                    //}
                                                }
                                                //FIM
                                                #endregion

                                                #region RETORNO REFEIÇAO
                                                //BLOCO RETORNO REFEIÇAO
                                                if (dt4.Rows[w][2].ToString() == "RETORNO REFEICAO")
                                                {

                                                    int a = 0;
                                                    int b = 0;
                                                    a = w - 1;
                                                    b = w + 1;
                                                    if (a >= 0)
                                                    {

                                                        if (dt4.Rows[a][2].ToString() == "PARADA REFEICAO")
                                                        {

                                                            // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;0102");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");

                                                        }
                                                        //if (dt4.Rows[b][2].ToString() == "FIM DE JORNADA")
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                        //}
                                                        //else
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                        //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");

                                                        //}
                                                    }


                                                }
                                                //FIM
                                                #endregion

                                                #region INICIO DE VIAGEM
                                                //BLOCO REINICIO / INICIO DE VIAGEM
                                                if (dt4.Rows[w][2].ToString() == "INICIO DE VIAGEM")
                                                {
                                                    int a = 0;
                                                    a = w - 1;
                                                    if (a >= 0)
                                                    {
                                                        //if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                        //{
                                                        //    if (dt4.Rows[a][5].ToString() == "14")
                                                        //    {
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");

                                                        //    }
                                                        //    else
                                                        //        if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                        //    {
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");

                                                        //    }
                                                        //    else
                                                        //    {
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                        //    }
                                                        //}
                                                        //if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                        //}
                                                        //else if (dt4.Rows[a][2].ToString() == "PARADA PERNOITE")
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;22");
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                        //}
                                                        //else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                        //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                        //}

                                                        if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                        {


                                                            if (dt4.Rows[a][5].ToString() == "14")
                                                            {

                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");



                                                            }
                                                            //else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "1" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "4")
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                            //}



                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "PARADA")
                                                        {


                                                            if (dt4.Rows[a][5].ToString() == "14")
                                                            {

                                                                // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                            }
                                                            //else
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");



                                                            //}



                                                        }
                                                        //else if (dt4.Rows[a][2].ToString() == "RETORNO REFEICAO")
                                                        //{
                                                        //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                        //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                        //    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");

                                                        //}

                                                    }
                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //}



                                                }
                                                //FIM
                                                #endregion

                                                #region PARADA CLIENTE / FORNECEDOR
                                                if (dt4.Rows[w][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                {
                                                    if (dt4.Rows[w][5].ToString() == "3" || dt4.Rows[w][5].ToString() == "2" || dt4.Rows[w][5].ToString() == "4")
                                                    {
                                                        int a = 0;
                                                        a = w - 1;
                                                        if (a >= 0)
                                                        {
                                                            //if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                            //}
                                                            if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                            {
                                                                if (dt4.Rows[a][5].ToString() == "14")
                                                                {
                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;0102");
                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");


                                                                }
                                                                //else if (dt4.Rows[a][5].ToString() == "15")
                                                                //{
                                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");

                                                                //}
                                                                //else
                                                                //{
                                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                                //}

                                                            }
                                                        }

                                                    }
                                                    else if (dt4.Rows[w][5].ToString() == "14")
                                                    {
                                                        int a = 0;
                                                        a = w - 1;
                                                        if (a >= 0)
                                                        {
                                                            if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                            {
                                                                if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "4")
                                                                {
                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                                }
                                                                else if (dt4.Rows[a][5].ToString() == "14")
                                                                {
                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");

                                                                }


                                                            }
                                                            else
                                                            {
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                            }

                                                        }


                                                    }


                                                }
                                                #endregion

                                                #region REINICIO
                                                //BLOCO REINICIO / INICIO DE VIAGEM
                                                if (dt4.Rows[w][2].ToString() == "REINICIO DE VIAGEM")
                                                {
                                                    int a = 0;
                                                    a = w - 1;
                                                    if (a >= 0)
                                                    {
                                                        if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                        {

                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "PARADA PERNOITE")
                                                        {
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                        }

                                                        else if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                        {

                                                            if (a >= 0)
                                                            {

                                                                if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                                {
                                                                    //if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                                    //{
                                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                                    //}
                                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                                    {

                                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");

                                                                    }
                                                                    //else if (dt4.Rows[a][5].ToString() == "15")
                                                                    //{

                                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");

                                                                    //}
                                                                    //else
                                                                    //{
                                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                                    //}
                                                                }
                                                                //else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                                //{
                                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                                //}


                                                            }



                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "PARADA")
                                                        {
                                                            if (dt4.Rows[a][5].ToString() == "14")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                            }
                                                            //else
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                            //}




                                                        }
                                                        //else if (dt4.Rows[a][2].ToString() == "OFICINA / MANUTENCAO")
                                                        //{

                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");


                                                        //}

                                                    }
                                                    else
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");
                                                        // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                    }



                                                }
                                                //FIM
                                                #endregion

                                                #region BLOCO PARADA
                                                // BLOCO PARADA
                                                if (dt4.Rows[w][2].ToString() == "PARADA")
                                                {
                                                    int a = 0;
                                                    a = w - 1;


                                                    if (dt4.Rows[w][5].ToString() == "14")
                                                    {
                                                        if (dt4.Rows.Count >= a)
                                                        {
                                                            if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                            {
                                                                // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");


                                                            }

                                                        }
                                                    }
                                                    //else
                                                    //{
                                                    //    if (dt4.Rows.Count >= a)
                                                    //    {
                                                    //        if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                    //        {
                                                    //            write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");

                                                    //        }
                                                    //        //else
                                                    //        //{
                                                    //        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //        //    // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                    //        //}
                                                    //    }
                                                    //}



                                                    //  write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");

                                                }
                                                //FIM
                                                #endregion

                                                #region FIM DE VIAGEM
                                                //BLOCO FIM DE VIAGEM
                                                if (dt4.Rows[w][2].ToString() == "FIM DE VIAGEM")
                                                {
                                                    int a = 0;
                                                    int g = 0;
                                                    a = w - 1;
                                                    g = w - 2;
                                                    if (a >= 0)
                                                    {
                                                        if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                        {


                                                            if (dt4.Rows[a][5].ToString() == "14")
                                                            {

                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;0102");

                                                            }

                                                            //else if (dt4.Rows[a][5].ToString() == "14")
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                            //    // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                            //}

                                                            //else
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //    // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                            //}



                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "PARADA")
                                                        {


                                                            if (dt4.Rows[a][5].ToString() == "14")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;0102");

                                                            }

                                                            //else
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //    // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");

                                                            //}


                                                        }

                                                        else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                        {
                                                            if (g >= 0)
                                                            {
                                                                //if (dt4.Rows[g][2].ToString() == "PARADA PERNOITE")
                                                                //{
                                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                                //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                //}
                                                                //else
                                                                //{
                                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                                //}
                                                            }
                                                            //else
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //}


                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                        }


                                                    }
                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //}

                                                }

                                                //
                                                #endregion

                                                #region FIM DE JORNADA
                                                //BLOCO FIM DE JORMADA
                                                if (c > 0)
                                                {
                                                    if (dt4.Rows[w][2].ToString() == "FIM DE JORNADA" && dt4.Rows[w][6].ToString() == "725405" || dt4.Rows[w][2].ToString() == "FIM DE JORNADA" && dt4.Rows[w][6].ToString() == "725407" || dt4.Rows[w][2].ToString() == "FIM DE JORNADA" && dt4.Rows[w][6].ToString() == "184525")
                                                    {
                                                        int a = 0;
                                                        a = w - 1;

                                                        if (a >= 0)
                                                        {
                                                            if (dt4.Rows[a][2].ToString() == "RETORNO REFEICAO")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                            {

                                                                //WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");


                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "RETORNO REFEICAO")
                                                            {

                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");

                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                            {
                                                                int b = 0;
                                                                b = a - 1;

                                                                if (b >= 0)
                                                                {
                                                                    if (dt4.Rows[b][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[b][2].ToString() == "REINICIO DE VIAGEM")
                                                                    {
                                                                        int d = 0;
                                                                        d = b - 1;
                                                                        if (d >= 0)
                                                                        {

                                                                            if (dt4.Rows[d][2].ToString() == "PARADA")
                                                                            {
                                                                                if (dt4.Rows[d][5].ToString() == "14")
                                                                                {
                                                                                    // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                                }
                                                                                else
                                                                                {
                                                                                    // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                                    // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                                }




                                                                            }
                                                                            else
                                                                            {
                                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                                // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                            }
                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                        // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                    }

                                                                }
                                                                else
                                                                {
                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                                }

                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "PARADA")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                            {
                                                                if (dt4.Rows[a][5].ToString() == "14")
                                                                {
                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                                }
                                                                else
                                                                {
                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                }
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");

                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "FIM DE JORNADA")
                                                            {
                                                                int m = 0;
                                                                m = a - 1;

                                                                if (m >= 0)
                                                                {
                                                                    if (dt4.Rows[m][2].ToString() == "RETORNO REFEICAO" || dt4.Rows[m][2].ToString() == "INICIO DE JORNADA")
                                                                    {
                                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                    }
                                                                    else if (dt4.Rows[m][2].ToString() == "FIM DE VIAGEM")
                                                                    {
                                                                        int b = 0;
                                                                        b = m - 1;

                                                                        if (b >= 0)
                                                                        {
                                                                            if (dt4.Rows[b][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[b][2].ToString() == "REINICIO DE VIAGEM")
                                                                            {
                                                                                int d = 0;
                                                                                d = b - 1;
                                                                                if (d >= 0)
                                                                                {

                                                                                    if (dt4.Rows[d][2].ToString() == "PARADA")
                                                                                    {
                                                                                        if (dt4.Rows[d][5].ToString() == "14")
                                                                                        {
                                                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                                            //.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                                        }
                                                                                        else
                                                                                        {
                                                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                                                        }


                                                                                    }
                                                                                    else
                                                                                    {
                                                                                        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                                    }
                                                                                }
                                                                            }
                                                                            else
                                                                            {
                                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                            }

                                                                        }


                                                                    }
                                                                    //else if (dt4.Rows[m][2].ToString() == "REINICIO DE VIAGEM")
                                                                    //{
                                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                                    //}
                                                                    //else if (dt4.Rows[m][2].ToString() == "PARADA INTERNA")
                                                                    //{
                                                                    //    if (dt4.Rows[m][5].ToString() == "3" || dt4.Rows[m][5].ToString() == "1" || dt4.Rows[m][5].ToString() == "2")
                                                                    //    {
                                                                    //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");

                                                                    //    }
                                                                    //    else if (dt4.Rows[m][5].ToString() == "22")
                                                                    //    {
                                                                    //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                                    //    }

                                                                    //    else if (dt4.Rows[m][2].ToString() == "FIM DE JORNADA")
                                                                    //    {
                                                                    //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                                    //        write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                    //    }

                                                                    //}
                                                                    else if (dt4.Rows[m][2].ToString() == "PARADA")
                                                                    {
                                                                        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                                    }
                                                                    //else if (dt4.Rows[m][2].ToString() == "PARADA INTERNA")
                                                                    //{
                                                                    //    if (dt4.Rows[m][5].ToString() != "3" || dt4.Rows[m][5].ToString() != "1" || dt4.Rows[m][5].ToString() != "2")
                                                                    //    {
                                                                    //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                                    //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                                    //        write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                                    //    }

                                                                    //}

                                                                    else
                                                                    {
                                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                    }


                                                                }
                                                                else
                                                                {
                                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                }
                                                            }
                                                            else
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            }


                                                        }
                                                        else
                                                        {
                                                            // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                        }
                                                    }

                                                }
                                                else
                                                {
                                                    if (dt4.Rows[w][2].ToString() == "FIM DE JORNADA")
                                                    {
                                                        int q = 0;
                                                        q = w + 1;

                                                        if (q < dt4.Rows.Count)
                                                        {
                                                            if (dt4.Rows[q][2].ToString() == "FIM DE JORNADA")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                            }
                                                            else
                                                            {
                                                                int a = 0;
                                                                a = w - 1;

                                                                if (a >= 0)
                                                                {

                                                                    if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM" || dt4.Rows[a][2].ToString() == "RETORNO REFEICAO" || dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                                    {
                                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                        // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                                    }
                                                                    //else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                                    //{
                                                                    //    if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                                    //    {
                                                                    //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                                    //        // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                                    //        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                                    //    }
                                                                    //    else if (dt4.Rows[a][5].ToString() == "14")
                                                                    //    {
                                                                    //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                                    //        write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                    //    }
                                                                    //    else
                                                                    //    {
                                                                    //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");


                                                                    //    }
                                                                    //}
                                                                    else if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                                    {

                                                                    }
                                                                    else if (dt4.Rows[a][2].ToString() == "FIM DE JORNADA")
                                                                    {
                                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                    }
                                                                    else
                                                                    {
                                                                        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                        // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                    }
                                                                }
                                                            }

                                                        }
                                                        else
                                                        {
                                                            int a = 0;
                                                            a = w - 1;

                                                            if (a >= 0)
                                                            {

                                                                if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                                {
                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");

                                                                }
                                                                else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                                {
                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                                }
                                                                else if (dt4.Rows[a][2].ToString() == "RETORNO REFEICAO")
                                                                {
                                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");

                                                                }
                                                                else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                                {
                                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                                    {
                                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                                    }
                                                                    else
                                                                    {
                                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                    }
                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");

                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                                }
                                                                //else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                                //{
                                                                //    if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                                //    {
                                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                                //        // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                                //        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                                //    }
                                                                //    else if (dt4.Rows[a][5].ToString() == "14")
                                                                //    {
                                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                                //        write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                //    }
                                                                //    else
                                                                //    {
                                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");

                                                                //    }
                                                                //}
                                                                else if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                                {

                                                                }
                                                                else if (dt4.Rows[a][2].ToString() == "FIM DE JORNADA")
                                                                {
                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");

                                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                }
                                                                else
                                                                {
                                                                    // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                }
                                                            }
                                                            else
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            }
                                                        }
                                                    }





                                                }


                                                #endregion

                                                #region PARADA PERNOITE

                                                if (dt4.Rows[w][2].ToString() == "PARADA PERNOITE")
                                                {
                                                    int a = 0;
                                                    a = w - 1;


                                                    if (a >= 0)
                                                    {
                                                        if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                        {


                                                            if (dt4.Rows[a][5].ToString() == "14")
                                                            {

                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                                //WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;0102");
                                                                write.WriteLine("+00" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm").Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");


                                                            }
                                                            else if (dt4.Rows[a][5].ToString() == "15")
                                                            {

                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;22");


                                                            }
                                                            //else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                            //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");
                                                            //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //}
                                                            else
                                                            {
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            }



                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "PARADA")
                                                        {
                                                            //if (dt4.Rows[a][5].ToString() == "7")
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");
                                                            //}
                                                            if (dt4.Rows[a][5].ToString() == "14")
                                                            {

                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                                //WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;0102");
                                                                write.WriteLine("+00" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm").Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");


                                                            }
                                                            else
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            }

                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM")
                                                        {
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";2;22");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";3;22");
                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                        {
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                            // write.WriteLine(cracha + ";" + data + ";" + hora + ";3;22");
                                                        }
                                                        //else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                        //{


                                                        //    if (dt4.Rows[a][5].ToString() == "14")
                                                        //    {

                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                        //        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");


                                                        //    }
                                                        //    //else if (dt4.Rows[a][5].ToString() == "15")
                                                        //    //{

                                                        //    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //    //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");


                                                        //    //}
                                                        //    else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                        //    {
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");
                                                        //        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //    }
                                                        //    //else
                                                        //    //{
                                                        //    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;22");
                                                        //    //}



                                                        //}
                                                        //else
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;22");
                                                        //}

                                                    }
                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;22");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");

                                                    //}

                                                }

                                                #endregion


                                                write.Flush();
                                                write.Close();
                                            }

                                            //FIM

                                            #endregion
                                        }
                                    }
                                }

                            }

                        }
                        else
                        {
                            //JORNADA DIFERENCIA DE COMEÇO

                            //VERIFICA SE A ULTIMA MARCAÇÃO DO DIA É PARADA PERNOITE OU FIM DE VIAGEM
                            string sqlz = "select TOP 1 ds_macro from tb_parada where cod_cracha=" + dt1.Rows[x][0].ToString() + " and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).ToString("yyyy-MM-dd") + "' and fl_deletado is null order by hr_posicao  DESC ";
                            SqlDataAdapter adtpz = new SqlDataAdapter(sqlz, con);
                            DataTable dtz = new DataTable();
                            con.Open();
                            adtpz.Fill(dtz);
                            con.Close();




                            if (dtz.Rows[0][0].ToString() == "FIM DE JORNADA" || dtz.Rows[0][0].ToString() == "PARADA PERNOITE")
                            {
                                //JORNADA NORMAL COM DIFERENÇA NO COMEÇO
                                string sqld = "select TOP 1  ds_macro, hr_posicao from tb_parada  where  cod_cracha=" + dt1.Rows[x][0].ToString() + " and fl_deletado is null and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).ToString("yyyy-MM-dd") + "'  and hr_posicao > (select top 1 hr_posicao from tb_parada where cod_cracha=" + dt1.Rows[x][0].ToString() + " and fl_deletado is null and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).ToString("yyyy-MM-dd") + "'  and ds_macro='FIM DE JORNADA'  OR cod_cracha=" + dt1.Rows[x][0].ToString() + " and fl_deletado is null and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).ToString("yyyy-MM-dd") + "'  and ds_macro='PARADA PERNOITE' order by hr_posicao) order by hr_posicao ";
                                SqlDataAdapter adtpd = new SqlDataAdapter(sqld, con);
                                DataTable dtd = new DataTable();
                                con.Open();
                                adtpd.Fill(dtd);
                                con.Close();

                                if (dtd.Rows.Count > 0)
                                {

                                    #region Jornada Normal
                                    //string arquivo = "Transmot" + DateTime.Parse(txtDtInicial.Text).ToString("ddMM") + "001.txt";

                                    sql4 = "select dt_posicao_parada, hr_posicao, ds_macro,cod_transmissao, cod_cracha, isnull(cod_ref_parada,0) as cod_ref_parada, cod_idveiculo from tb_parada where fl_deletado is null and cod_cracha=" + dt1.Rows[x][0].ToString() + " and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).ToString("yyyy-MM-dd") + "' and fl_deletado is null and hr_posicao >= '" + dtd.Rows[0][1].ToString() + "' AND (ds_macro IN ('INICIO DE JORNADA', 'INICIO JORNADA CAMINHAO', 'PARADA REFEICAO', 'FIM DE JORNADA','REINICIO DE VIAGEM','FIM DE VIAGEM', 'PARADA','PARADA INTERNA','INICIO DE VIAGEM','PARADA INTERNA','RETORNO REFEICAO','PARADA CLIENTE / FORNECEDOR','PARADA PERNOITE') OR cod_ref_parada in (2,3,4,14,22)) AND fl_deletado IS NULL ORDER BY dt_posicao_parada, hr_posicao";
                                    // string sql4 = "select dt_posicao_parada, hr_posicao, ds_macro,cod_transmissao, cod_cracha, isnull(cod_ref_parada,0) as cod_ref_parada, cod_idveiculo from tb_parada where fl_deletado is null and cod_cracha=" + dt1.Rows[x][0].ToString() + " and dt_posicao_parada between '" + txtDtInicial.Text + "' and '" + txtDtFinal.Text + "' order by dt_posicao_parada, hr_posicao";
                                    SqlDataAdapter adtp4 = new SqlDataAdapter(sql4, con);
                                    DataTable dt4 = new DataTable();

                                    try
                                    {
                                        con.Open();
                                        adtp4.Fill(dt4);
                                        con.Close();
                                    }
                                    catch (Exception ed)
                                    {
                                        // MessageBox.Show(ed.ToString(), "Erro3");
                                    }

                                    c = 0;

                                    for (int y = 0; y < dt4.Rows.Count; y++)
                                    {
                                        if (dt4.Rows[y][2].ToString() == "FIM DE JORNADA" && dt4.Rows[y][6].ToString() == "725405" || dt4.Rows[y][2].ToString() == "FIM DE JORNADA" && dt4.Rows[y][6].ToString() == "725407" || dt4.Rows[y][2].ToString() == "FIM DE JORNADA" && dt4.Rows[y][6].ToString() == "184525")
                                        {
                                            c = c + 1;
                                        }

                                    }
                                    string caminho = Server.MapPath("/TXT/");

                                    string filepath = caminho + arquivo;

                                    FileInfo file = new FileInfo(filepath);

                                    //if (file.Exists)
                                    //{
                                    //    file.Delete();
                                    //}


                                    for (int w = 0; w < dt4.Rows.Count; w++)
                                    {
                                        //if (chkDiadema.Checked || chkCadiriri.Checked)
                                        //{


                                        //        if (dt1.Rows[x][0].ToString().Length < 4)
                                        //        {
                                        //            cracha = "300" + dt1.Rows[x][0].ToString();
                                        //        }
                                        //        else if (dt1.Rows[x][0].ToString().Length >= 4 || dt1.Rows[x][0].ToString().Length <= 5)
                                        //        {
                                        //            cracha = "30" + dt1.Rows[x][0].ToString();
                                        //        }
                                        //        else
                                        //        {
                                        //            cracha = dt1.Rows[x][0].ToString();
                                        //        }




                                        //}
                                        //else
                                        //{
                                        //    if (dt1.Rows[x][0].ToString().Length < 4)
                                        //    {
                                        //        cracha = "300" + dt1.Rows[x][0].ToString();
                                        //    }
                                        //    else if (dt1.Rows[x][0].ToString().Length >= 4 || dt1.Rows[x][0].ToString().Length <= 5)
                                        //    {
                                        //        cracha = "30" + dt1.Rows[x][0].ToString();
                                        //    }
                                        //    else
                                        //    {
                                        //        cracha = dt1.Rows[x][0].ToString();
                                        //    }
                                        //}
                                        string codigo = dt1.Rows[x][0].ToString();
                                        string[] codigosEspeciais = { "330", "482", "820", "958", "989" };

                                        if (codigo.StartsWith("312"))
                                        {
                                            cracha = codigo.Insert(3, "0");
                                        }
                                        else if ((codigosEspeciais.Contains(codigo) || codigo.Length <= 4))
                                        {
                                            cracha = "30" + codigo;
                                        }
                                        else if (codigo.Length <= 3)
                                        {
                                            cracha = "300" + codigo;
                                        }

                                        else
                                        {
                                            cracha = codigo;
                                        }





                                        //  cracha = "30" + dt1.Rows[x][0].ToString();
                                        int t = 0;
                                        t = w - 1;

                                        string data = DateTime.Parse(dt4.Rows[w][0].ToString()).ToString("dd/MM/yy");
                                        string horas = DateTime.Parse(dt4.Rows[w][1].ToString()).ToString("HH:mm");
                                        if (t >= 0)
                                        {
                                            if (DateTime.Parse(dt4.Rows[w][1].ToString()).ToString("HH:mm") == DateTime.Parse(dt4.Rows[t][1].ToString()).ToString("HH:mm"))
                                            {
                                                hora = DateTime.Parse(horas).AddMinutes(1).ToString("HH:mm");
                                            }
                                            else
                                            {
                                                hora = DateTime.Parse(horas).ToString("HH:mm");
                                            }
                                        }
                                        else
                                        {
                                            hora = DateTime.Parse(horas).ToString("HH:mm");
                                        }
                                        //tipo = dt4.Rows[w][2].ToString();
                                        string transmissao = dt4.Rows[w][3].ToString();


                                        //if (dt4.Rows[w][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[w][2].ToString() == "TRECHO ALMOÇO" || dt4.Rows[w][2].ToString() == "FIM DE JORNADA")
                                        //{
                                        //    tipo = "2";
                                        //}
                                        //else  if (dt4.Rows[w][2].ToString() == "PARADA FORNECEDOR" || dt4.Rows[w][2].ToString() == "REINICIO DE VIAGEM")
                                        //{
                                        //    tipo = "21";
                                        //}






                                        StreamWriter write = new StreamWriter(caminho + arquivo, true);


                                        #region BLOCO INICIO JORNADA
                                        //BLOCO INICIO JORNADA
                                        if (dt4.Rows[w][2].ToString() == "INICIO DE JORNADA")
                                        {
                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");
                                        }

                                        if (dt4.Rows[w][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[w][2].ToString() == "INICIO JORNADA")
                                        {

                                            int a = 0;
                                            a = w - 1;
                                            if (a >= 0)
                                            {
                                                if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");

                                                }
                                                else
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");

                                                }
                                            }
                                            else
                                            {
                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");
                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                            }


                                        }
                                        //FIM
                                        #endregion

                                        #region BLOCO INICIO JORNADA CAMINHAO
                                        //BLOCO INICIO JORNADA CAMINHAO

                                        if (dt4.Rows[w][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[w][2].ToString() == "INICIO JORNADA")
                                        {

                                            int a = 0;
                                            a = w - 1;
                                            if (a >= 0)
                                            {
                                                if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");

                                                }
                                                else
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");
                                                }
                                            }
                                            else
                                            {
                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                            }


                                        }
                                        //FIM
                                        #endregion

                                        #region PARADA INTERNA
                                        //BLOCO PARADA INTERNA
                                        if (dt4.Rows[w][2].ToString() == "PARADA INTERNA")
                                        {
                                            if (dt4.Rows[w][5].ToString() == "3" || dt4.Rows[w][5].ToString() == "2")
                                            {
                                                int a = 0;
                                                a = w - 1;
                                                if (a >= 0)
                                                {
                                                    if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                    }
                                                    else if (dt4.Rows[a][5].ToString() == "14")
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                    }
                                                    else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "1")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "PARADA REFEICAO")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM")
                                                    {
                                                        //////write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        ////write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        ////write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                    }
                                                    else
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                    }

                                                }

                                            }
                                            else if (dt4.Rows[w][5].ToString() == "14")
                                            {
                                                int a = 0;
                                                a = w - 1;
                                                if (a >= 0)
                                                {
                                                    if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                    }
                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                    }
                                                    else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "1")
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "PARADA REFEICAO")
                                                    {
                                                        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                    {

                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");

                                                    }
                                                    if (dt4.Rows[a][5].ToString() == "22")
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                    }
                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93: 71489");
                                                    //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                    //}

                                                }
                                            }
                                            else if (dt4.Rows[w][5].ToString() == "22")
                                            {
                                                int a = 0;
                                                a = w - 1;
                                                if (a >= 0)
                                                {

                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                    }


                                                }
                                            }
                                            else
                                            {
                                                int a = 0;
                                                a = w - 1;
                                                if (a >= 0)
                                                {
                                                    if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");
                                                    }
                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                    }

                                                    else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "1")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "PARADA REFEICAO")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                        //// write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                    {

                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                    {

                                                        //// write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");

                                                    }

                                                }
                                            }

                                        }
                                        //FIM 
                                        #endregion

                                        #region BLOCO PARADA REFEIÇÃO
                                        //BLOCO PARADA REFEIÇÃO
                                        if (dt4.Rows[w][2].ToString() == "PARADA REFEICAO")
                                        {
                                            int a = 0;
                                            a = w - 1;
                                            if (a >= 0)
                                            {
                                                //if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                //{

                                                //    if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                //    {
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;93");
                                                //    }
                                                //    else
                                                //    {
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;93");
                                                //    }
                                                //}
                                                if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");

                                                }
                                                else
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                }

                                            }
                                            //else
                                            //{
                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;93");
                                            //}
                                        }
                                        //FIM
                                        #endregion

                                        #region RETORNO REFEIÇAO
                                        //BLOCO RETORNO REFEIÇAO
                                        if (dt4.Rows[w][2].ToString() == "RETORNO REFEICAO")
                                        {

                                            int a = 0;
                                            int b = 0;
                                            a = w - 1;
                                            b = w + 1;
                                            if (a >= 0)
                                            {

                                                if (dt4.Rows[a][2].ToString() == "PARADA REFEICAO")
                                                {

                                                    // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;0102");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");

                                                }
                                                //if (dt4.Rows[b][2].ToString() == "FIM DE JORNADA")
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                //}
                                                //else
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");

                                                //}
                                            }


                                        }
                                        //FIM
                                        #endregion

                                        #region INICIO DE VIAGEM
                                        //BLOCO REINICIO / INICIO DE VIAGEM
                                        if (dt4.Rows[w][2].ToString() == "INICIO DE VIAGEM")
                                        {
                                            int a = 0;
                                            a = w - 1;
                                            if (a >= 0)
                                            {
                                                //if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                //{
                                                //    if (dt4.Rows[a][5].ToString() == "14")
                                                //    {
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");

                                                //    }
                                                //    else
                                                //        if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                //    {
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");

                                                //    }
                                                //    else
                                                //    {
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                //    }
                                                //}
                                                //if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                //}
                                                //else if (dt4.Rows[a][2].ToString() == "PARADA PERNOITE")
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;22");
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                //}
                                                //else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                //}

                                                if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                {


                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {

                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");



                                                    }
                                                    //else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "1" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "4")
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                    //}



                                                }
                                                else if (dt4.Rows[a][2].ToString() == "PARADA")
                                                {


                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {

                                                        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                    }
                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");



                                                    //}



                                                }
                                                //else if (dt4.Rows[a][2].ToString() == "RETORNO REFEICAO")
                                                //{
                                                //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                //    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");

                                                //}

                                            }
                                            //else
                                            //{
                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                            //}



                                        }
                                        //FIM
                                        #endregion

                                        #region PARADA CLIENTE / FORNECEDOR
                                        if (dt4.Rows[w][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                        {
                                            if (dt4.Rows[w][5].ToString() == "3" || dt4.Rows[w][5].ToString() == "2" || dt4.Rows[w][5].ToString() == "4")
                                            {
                                                int a = 0;
                                                a = w - 1;
                                                if (a >= 0)
                                                {
                                                    //if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                    //}
                                                    if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                    {
                                                        if (dt4.Rows[a][5].ToString() == "14")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;0102");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");


                                                        }
                                                        //else if (dt4.Rows[a][5].ToString() == "15")
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");

                                                        //}
                                                        //else
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                        //}

                                                    }
                                                }

                                            }
                                            else if (dt4.Rows[w][5].ToString() == "14")
                                            {
                                                int a = 0;
                                                a = w - 1;
                                                if (a >= 0)
                                                {
                                                    if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                    {
                                                        if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "4")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                        }
                                                        else if (dt4.Rows[a][5].ToString() == "14")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");

                                                        }


                                                    }
                                                    else
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                    }

                                                }


                                            }


                                        }
                                        #endregion

                                        #region REINICIO
                                        //BLOCO REINICIO / INICIO DE VIAGEM
                                        if (dt4.Rows[w][2].ToString() == "REINICIO DE VIAGEM")
                                        {
                                            int a = 0;
                                            a = w - 1;
                                            if (a >= 0)
                                            {
                                                if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                {

                                                }
                                                else if (dt4.Rows[a][2].ToString() == "PARADA PERNOITE")
                                                {
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                }

                                                else if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                {

                                                    if (a >= 0)
                                                    {

                                                        if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                        {
                                                            //if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                            //}
                                                            if (dt4.Rows[a][5].ToString() == "14")
                                                            {

                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");

                                                            }
                                                            //else if (dt4.Rows[a][5].ToString() == "15")
                                                            //{

                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");

                                                            //}
                                                            //else
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                            //}
                                                        }
                                                        //else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                        //}


                                                    }



                                                }
                                                else if (dt4.Rows[a][2].ToString() == "PARADA")
                                                {
                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                    }
                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                    //}




                                                }
                                                //else if (dt4.Rows[a][2].ToString() == "OFICINA / MANUTENCAO")
                                                //{

                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");


                                                //}

                                            }
                                            else
                                            {
                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");
                                                // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                            }



                                        }
                                        //FIM
                                        #endregion

                                        #region BLOCO PARADA
                                        // BLOCO PARADA
                                        if (dt4.Rows[w][2].ToString() == "PARADA")
                                        {
                                            int a = 0;
                                            a = w - 1;


                                            if (dt4.Rows[w][5].ToString() == "14")
                                            {
                                                if (dt4.Rows.Count >= a)
                                                {
                                                    if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                    {
                                                        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");


                                                    }

                                                }
                                            }
                                            //else
                                            //{
                                            //    if (dt4.Rows.Count >= a)
                                            //    {
                                            //        if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                            //        {
                                            //            write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                            //            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");

                                            //        }
                                            //        //else
                                            //        //{
                                            //        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                            //        //    // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                            //        //}
                                            //    }
                                            //}



                                            //  write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");

                                        }
                                        //FIM
                                        #endregion

                                        #region FIM DE VIAGEM
                                        //BLOCO FIM DE VIAGEM
                                        if (dt4.Rows[w][2].ToString() == "FIM DE VIAGEM")
                                        {
                                            int a = 0;
                                            int g = 0;
                                            a = w - 1;
                                            g = w - 2;
                                            if (a >= 0)
                                            {
                                                if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                {


                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {

                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;0102");

                                                    }

                                                    //else if (dt4.Rows[a][5].ToString() == "14")
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                    //    // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                    //}

                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //    // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                    //}



                                                }
                                                else if (dt4.Rows[a][2].ToString() == "PARADA")
                                                {


                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;0102");

                                                    }

                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //    // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");

                                                    //}


                                                }

                                                else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                {
                                                    if (g >= 0)
                                                    {
                                                        //if (dt4.Rows[g][2].ToString() == "PARADA PERNOITE")
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                        //}
                                                        //else
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //}
                                                    }
                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //}


                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                }


                                            }
                                            //else
                                            //{
                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                            //}

                                        }

                                        //
                                        #endregion

                                        #region FIM DE JORNADA
                                        //BLOCO FIM DE JORMADA
                                        if (c > 0)
                                        {
                                            if (dt4.Rows[w][2].ToString() == "FIM DE JORNADA" && dt4.Rows[w][6].ToString() == "725405" || dt4.Rows[w][2].ToString() == "FIM DE JORNADA" && dt4.Rows[w][6].ToString() == "725407" || dt4.Rows[w][2].ToString() == "FIM DE JORNADA" && dt4.Rows[w][6].ToString() == "184525")
                                            {
                                                int a = 0;
                                                a = w - 1;

                                                if (a >= 0)
                                                {
                                                    if (dt4.Rows[a][2].ToString() == "RETORNO REFEICAO")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                    {

                                                        //WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");


                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "RETORNO REFEICAO")
                                                    {

                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");

                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                    {
                                                        int b = 0;
                                                        b = a - 1;

                                                        if (b >= 0)
                                                        {
                                                            if (dt4.Rows[b][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[b][2].ToString() == "REINICIO DE VIAGEM")
                                                            {
                                                                int d = 0;
                                                                d = b - 1;
                                                                if (d >= 0)
                                                                {

                                                                    if (dt4.Rows[d][2].ToString() == "PARADA")
                                                                    {
                                                                        if (dt4.Rows[d][5].ToString() == "14")
                                                                        {
                                                                            // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                        }
                                                                        else
                                                                        {
                                                                            // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                            // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                        }




                                                                    }
                                                                    else
                                                                    {
                                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                        // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                    }
                                                                }
                                                            }
                                                            else
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            }

                                                        }
                                                        else
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                        }

                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "PARADA")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                    {
                                                        if (dt4.Rows[a][5].ToString() == "14")
                                                        {
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                        }
                                                        else
                                                        {
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        }
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");

                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "FIM DE JORNADA")
                                                    {
                                                        int m = 0;
                                                        m = a - 1;

                                                        if (m >= 0)
                                                        {
                                                            if (dt4.Rows[m][2].ToString() == "RETORNO REFEICAO" || dt4.Rows[m][2].ToString() == "INICIO DE JORNADA")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            }
                                                            else if (dt4.Rows[m][2].ToString() == "FIM DE VIAGEM")
                                                            {
                                                                int b = 0;
                                                                b = m - 1;

                                                                if (b >= 0)
                                                                {
                                                                    if (dt4.Rows[b][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[b][2].ToString() == "REINICIO DE VIAGEM")
                                                                    {
                                                                        int d = 0;
                                                                        d = b - 1;
                                                                        if (d >= 0)
                                                                        {

                                                                            if (dt4.Rows[d][2].ToString() == "PARADA")
                                                                            {
                                                                                if (dt4.Rows[d][5].ToString() == "14")
                                                                                {
                                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                                    //.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                                }
                                                                                else
                                                                                {
                                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                                                }


                                                                            }
                                                                            else
                                                                            {
                                                                                // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                            }
                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                    }

                                                                }


                                                            }
                                                            //else if (dt4.Rows[m][2].ToString() == "REINICIO DE VIAGEM")
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //}
                                                            //else if (dt4.Rows[m][2].ToString() == "PARADA INTERNA")
                                                            //{
                                                            //    if (dt4.Rows[m][5].ToString() == "3" || dt4.Rows[m][5].ToString() == "1" || dt4.Rows[m][5].ToString() == "2")
                                                            //    {
                                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");

                                                            //    }
                                                            //    else if (dt4.Rows[m][5].ToString() == "22")
                                                            //    {
                                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                            //    }

                                                            //    else if (dt4.Rows[m][2].ToString() == "FIM DE JORNADA")
                                                            //    {
                                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //        write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            //    }

                                                            //}
                                                            else if (dt4.Rows[m][2].ToString() == "PARADA")
                                                            {
                                                                // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                            }
                                                            //else if (dt4.Rows[m][2].ToString() == "PARADA INTERNA")
                                                            //{
                                                            //    if (dt4.Rows[m][5].ToString() != "3" || dt4.Rows[m][5].ToString() != "1" || dt4.Rows[m][5].ToString() != "2")
                                                            //    {
                                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                            //        write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                            //    }

                                                            //}

                                                            else
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            }


                                                        }
                                                        else
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                        }
                                                    }
                                                    else
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                    }


                                                }
                                                else
                                                {
                                                    // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                }
                                            }

                                        }
                                        else
                                        {
                                            if (dt4.Rows[w][2].ToString() == "FIM DE JORNADA")
                                            {
                                                int q = 0;
                                                q = w + 1;

                                                if (q < dt4.Rows.Count)
                                                {
                                                    if (dt4.Rows[q][2].ToString() == "FIM DE JORNADA")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                    }
                                                    else
                                                    {
                                                        int a = 0;
                                                        a = w - 1;

                                                        if (a >= 0)
                                                        {

                                                            if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM" || dt4.Rows[a][2].ToString() == "RETORNO REFEICAO" || dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                            }
                                                            //else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                            //{
                                                            //    if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                            //    {
                                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                            //        // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                            //        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //    }
                                                            //    else if (dt4.Rows[a][5].ToString() == "14")
                                                            //    {
                                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //        write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            //    }
                                                            //    else
                                                            //    {
                                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");


                                                            //    }
                                                            //}
                                                            else if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                            {

                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "FIM DE JORNADA")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            }
                                                            else
                                                            {
                                                                // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            }
                                                        }
                                                    }

                                                }
                                                else
                                                {
                                                    int a = 0;
                                                    a = w - 1;

                                                    if (a >= 0)
                                                    {

                                                        if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");

                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "RETORNO REFEICAO")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");

                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                        {
                                                            if (dt4.Rows[a][5].ToString() == "14")
                                                            {
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                            }
                                                            else
                                                            {
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            }
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");

                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                        }
                                                        //else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                        //{
                                                        //    if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                        //    {
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                        //        // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                        //        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //    }
                                                        //    else if (dt4.Rows[a][5].ToString() == "14")
                                                        //    {
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //        write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                        //    }
                                                        //    else
                                                        //    {
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");

                                                        //    }
                                                        //}
                                                        else if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                        {

                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "FIM DE JORNADA")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");

                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                        }
                                                        else
                                                        {
                                                            // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                        }
                                                    }
                                                    else
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                    }
                                                }
                                            }





                                        }


                                        #endregion

                                        #region PARADA PERNOITE

                                        if (dt4.Rows[w][2].ToString() == "PARADA PERNOITE")
                                        {
                                            int a = 0;
                                            a = w - 1;


                                            if (a >= 0)
                                            {
                                                if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                {


                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {

                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                        //WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;0102");
                                                        write.WriteLine("+00" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm").Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");


                                                    }
                                                    else if (dt4.Rows[a][5].ToString() == "15")
                                                    {

                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;22");


                                                    }
                                                    //else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");
                                                    //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //}
                                                    else
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                    }



                                                }
                                                else if (dt4.Rows[a][2].ToString() == "PARADA")
                                                {
                                                    //if (dt4.Rows[a][5].ToString() == "7")
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");
                                                    //}
                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {

                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                        //WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;0102");
                                                        write.WriteLine("+00" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm").Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");


                                                    }
                                                    else
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                    }

                                                }
                                                else if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM")
                                                {
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";2;22");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";3;22");
                                                }
                                                else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                {
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                    // write.WriteLine(cracha + ";" + data + ";" + hora + ";3;22");
                                                }
                                                //else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                //{


                                                //    if (dt4.Rows[a][5].ToString() == "14")
                                                //    {

                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                //        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");


                                                //    }
                                                //    //else if (dt4.Rows[a][5].ToString() == "15")
                                                //    //{

                                                //    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                //    //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");


                                                //    //}
                                                //    else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                //    {
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                //        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");
                                                //        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                //    }
                                                //    //else
                                                //    //{
                                                //    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;22");
                                                //    //}



                                                //}
                                                //else
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;22");
                                                //}

                                            }
                                            //else
                                            //{
                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;22");
                                            //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");

                                            //}

                                        }

                                        #endregion

                                        write.Flush();
                                        write.Close();

                                    }

                                    //FIM

                                    #endregion
                                }
                                else
                                {

                                }

                            }
                            else
                            {
                                //JORNADA PERNOITE COM DIFERENÇA NO COMEÇO
                                string sqli = "select TOP 1  hr_posicao from tb_parada  where  cod_cracha=" + dt1.Rows[x][0].ToString() + " and fl_deletado is null and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).ToString("yyyy-MM-dd") + "'  and hr_posicao > (select top 1 hr_posicao from tb_parada where cod_cracha=" + dt1.Rows[x][0].ToString() + " and fl_deletado is null and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).ToString("yyyy-MM-dd") + "'  and ds_macro='FIM DE JORNADA'  OR cod_cracha=" + dt1.Rows[x][0].ToString() + " and fl_deletado is null and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).ToString("yyyy-MM-dd") + "'  and ds_macro='PARADA PERNOITE' order by hr_posicao) order by hr_posicao ";
                                SqlDataAdapter adtpi = new SqlDataAdapter(sqli, con);
                                DataTable dti = new DataTable();
                                con.Open();
                                adtpi.Fill(dti);
                                con.Close();

                                string sqlf = "select top 1 hr_posicao from tb_parada where cod_cracha=" + dt1.Rows[x][0].ToString() + " and ds_macro = 'FIM DE JORNADA' and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).AddDays(1).ToString("yyyy-MM-dd") + "' and fl_deletado is null OR cod_cracha=" + dt1.Rows[x][0].ToString() + " and ds_macro='PARADA PERNOITE' and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).AddDays(1).ToString("yyyy-MM-dd") + "' and fl_deletado is null order by hr_posicao";
                                SqlDataAdapter adtpf = new SqlDataAdapter(sqlf, con);
                                DataTable dtf = new DataTable();
                                con.Open();
                                adtpf.Fill(dtf);
                                con.Close();



                                if (dti.Rows.Count > 0 && dtf.Rows.Count > 0)
                                {
                                    #region Jornada Noturna


                                    //sql4 = "select dt_posicao_parada, hr_posicao, ds_macro,cod_transmissao, cod_cracha, isnull(cod_ref_parada,0) as cod_ref_parada, cod_idveiculo from tb_parada where fl_deletado is null and cod_cracha=" + dt1.Rows[x][0].ToString() + " and dt_posicao_parada='" + txtDtInicial.Text + "' order by dt_posicao_parada, hr_posicao";
                                    sql4 = "select dt_posicao_parada, hr_posicao, ds_macro,cod_transmissao, cod_cracha, isnull(cod_ref_parada,0) as cod_ref_parada, cod_idveiculo from tb_parada where fl_deletado is null and cod_cracha=" + dt1.Rows[x][0].ToString() + " and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).ToString("yyyy-MM-dd") + "' and hr_posicao >='" + dti.Rows[0][0].ToString() + "' or cod_cracha=" + dt1.Rows[x][0].ToString() + " and dt_posicao_parada='" + DateTime.Parse(dte.Rows[f][0].ToString()).AddDays(1).ToString("yyyy-MM-dd") + "' and hr_posicao <= '" + dtf.Rows[0][0].ToString() + "' AND (ds_macro IN ('INICIO DE JORNADA', 'INICIO JORNADA CAMINHAO', 'PARADA REFEICAO', 'FIM DE JORNADA','REINICIO DE VIAGEM','FIM DE VIAGEM', 'PARADA','INICIO DE VIAGEM','PARADA INTERNA','RETORNO REFEICAO','PARADA CLIENTE / FORNECEDOR','PARADA PERNOITE') OR cod_ref_parada in (2,3,4,14,22)) AND fl_deletado IS NULL ORDER BY dt_posicao_parada, hr_posicao";
                                    // string sql4 = "select dt_posicao_parada, hr_posicao, ds_macro,cod_transmissao, cod_cracha, isnull(cod_ref_parada,0) as cod_ref_parada, cod_idveiculo from tb_parada where fl_deletado is null and cod_cracha=" + dt1.Rows[x][0].ToString() + " and dt_posicao_parada between '" + txtDtInicial.Text + "' and '" + txtDtFinal.Text + "' order by dt_posicao_parada, hr_posicao";
                                    SqlDataAdapter adtp4 = new SqlDataAdapter(sql4, con);
                                    DataTable dt4 = new DataTable();

                                    try
                                    {
                                        con.Open();
                                        adtp4.Fill(dt4);
                                        con.Close();
                                    }
                                    catch (Exception ed)
                                    {
                                        //MessageBox.Show(ed.ToString(), "Erro3");
                                    }

                                    c = 0;

                                    for (int y = 0; y < dt4.Rows.Count; y++)
                                    {
                                        if (dt4.Rows[y][2].ToString() == "FIM DE JORNADA" && dt4.Rows[y][6].ToString() == "725405" || dt4.Rows[y][2].ToString() == "FIM DE JORNADA" && dt4.Rows[y][6].ToString() == "725407" || dt4.Rows[y][2].ToString() == "FIM DE JORNADA" && dt4.Rows[y][6].ToString() == "184525")
                                        {
                                            c = c + 1;
                                        }

                                    }
                                    string caminho = Server.MapPath("/TXT/");

                                    string filepath = caminho + arquivo;

                                    FileInfo file = new FileInfo(filepath);
                                    //if(file.Exists)
                                    //{
                                    //    file.Delete();
                                    //}



                                    for (int w = 0; w < dt4.Rows.Count; w++)
                                    {

                                        string codigo = dt1.Rows[x][0].ToString();
                                        string[] codigosEspeciais = { "330", "482", "820", "958", "989" };

                                        if (codigo.StartsWith("312"))
                                        {
                                            cracha = codigo.Insert(3, "0");
                                        }
                                        else if ((codigosEspeciais.Contains(codigo) || codigo.Length <= 4))
                                        {
                                            cracha = "30" + codigo;
                                        }
                                        else if (codigo.Length <= 3)
                                        {
                                            cracha = "300" + codigo;
                                        }

                                        else
                                        {
                                            cracha = codigo;
                                        }

                                        // cracha = "30" + dt1.Rows[x][0].ToString();
                                        int t = 0;
                                        t = w - 1;
                                        string data = DateTime.Parse(dt4.Rows[w][0].ToString()).ToString("dd/MM/yy");
                                        string horas = DateTime.Parse(dt4.Rows[w][1].ToString()).ToString("HH:mm");
                                        if (t >= 0)
                                        {
                                            if (DateTime.Parse(dt4.Rows[w][1].ToString()).ToString("HH:mm") == DateTime.Parse(dt4.Rows[t][1].ToString()).ToString("HH:mm"))
                                            {
                                                hora = DateTime.Parse(horas).AddMinutes(1).ToString("HH:mm");
                                            }
                                            else
                                            {
                                                hora = DateTime.Parse(horas).ToString("HH:mm");
                                            }
                                        }
                                        else
                                        {
                                            hora = DateTime.Parse(horas).ToString("HH:mm");
                                        }
                                        //tipo = dt4.Rows[w][2].ToString();
                                        string transmissao = dt4.Rows[w][3].ToString();


                                        //if (dt4.Rows[w][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[w][2].ToString() == "TRECHO ALMOÇO" || dt4.Rows[w][2].ToString() == "FIM DE JORNADA")
                                        //{
                                        //    tipo = "2";
                                        //}
                                        //else  if (dt4.Rows[w][2].ToString() == "PARADA FORNECEDOR" || dt4.Rows[w][2].ToString() == "REINICIO DE VIAGEM")
                                        //{
                                        //    tipo = "21";
                                        //}



                                        StreamWriter write = new StreamWriter(caminho + arquivo, true);

                                        #region BLOCO INICIO JORNADA
                                        //BLOCO INICIO JORNADA
                                        if (dt4.Rows[w][2].ToString() == "INICIO DE JORNADA")
                                        {
                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");
                                        }

                                        if (dt4.Rows[w][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[w][2].ToString() == "INICIO JORNADA")
                                        {

                                            int a = 0;
                                            a = w - 1;
                                            if (a >= 0)
                                            {
                                                if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");

                                                }
                                                else
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");

                                                }
                                            }
                                            else
                                            {
                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                            }


                                        }
                                        //FIM
                                        #endregion

                                        #region BLOCO INICIO JORNADA CAMINHAO
                                        //BLOCO INICIO JORNADA CAMINHAO

                                        if (dt4.Rows[w][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[w][2].ToString() == "INICIO JORNADA")
                                        {

                                            int a = 0;
                                            a = w - 1;
                                            if (a >= 0)
                                            {
                                                if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");

                                                }
                                                else
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");
                                                }
                                            }
                                            else
                                            {
                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                            }


                                        }
                                        //FIM
                                        #endregion

                                        #region PARADA INTERNA
                                        //BLOCO PARADA INTERNA
                                        if (dt4.Rows[w][2].ToString() == "PARADA INTERNA")
                                        {
                                            if (dt4.Rows[w][5].ToString() == "3" || dt4.Rows[w][5].ToString() == "2")
                                            {
                                                int a = 0;
                                                a = w - 1;
                                                if (a >= 0)
                                                {
                                                    if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                    }
                                                    else if (dt4.Rows[a][5].ToString() == "14")
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                    }
                                                    else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "1")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "PARADA REFEICAO")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM")
                                                    {
                                                        //////write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        ////write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        ////write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                    }
                                                    else
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                    }

                                                }

                                            }
                                            else if (dt4.Rows[w][5].ToString() == "14")
                                            {
                                                int a = 0;
                                                a = w - 1;
                                                if (a >= 0)
                                                {
                                                    if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                    }
                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                    }
                                                    else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "1")
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "PARADA REFEICAO")
                                                    {
                                                        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                    {

                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");

                                                    }
                                                    if (dt4.Rows[a][5].ToString() == "22")
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                    }
                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93: 71489");
                                                    //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                    //}

                                                }
                                            }
                                            else if (dt4.Rows[w][5].ToString() == "22")
                                            {
                                                int a = 0;
                                                a = w - 1;
                                                if (a >= 0)
                                                {

                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                    }


                                                }
                                            }
                                            else
                                            {
                                                int a = 0;
                                                a = w - 1;
                                                if (a >= 0)
                                                {
                                                    if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");
                                                    }
                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                    }

                                                    else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "1")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "PARADA REFEICAO")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                        //// write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                    {

                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                    {

                                                        //// write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");

                                                    }

                                                }
                                            }

                                        }
                                        //FIM 
                                        #endregion

                                        #region BLOCO PARADA REFEIÇÃO
                                        //BLOCO PARADA REFEIÇÃO
                                        if (dt4.Rows[w][2].ToString() == "PARADA REFEICAO")
                                        {
                                            int a = 0;
                                            a = w - 1;
                                            if (a >= 0)
                                            {
                                                //if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                //{

                                                //    if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                //    {
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;93");
                                                //    }
                                                //    else
                                                //    {
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;93");
                                                //    }
                                                //}
                                                if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");

                                                }
                                                else
                                                {
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                }

                                            }
                                            //else
                                            //{
                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;93");
                                            //}
                                        }
                                        //FIM
                                        #endregion

                                        #region RETORNO REFEIÇAO
                                        //BLOCO RETORNO REFEIÇAO
                                        if (dt4.Rows[w][2].ToString() == "RETORNO REFEICAO")
                                        {

                                            int a = 0;
                                            int b = 0;
                                            a = w - 1;
                                            b = w + 1;
                                            if (a >= 0)
                                            {

                                                if (dt4.Rows[a][2].ToString() == "PARADA REFEICAO")
                                                {

                                                    // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;0102");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");

                                                }
                                                //if (dt4.Rows[b][2].ToString() == "FIM DE JORNADA")
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                //}
                                                //else
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");

                                                //}
                                            }


                                        }
                                        //FIM
                                        #endregion

                                        #region INICIO DE VIAGEM
                                        //BLOCO REINICIO / INICIO DE VIAGEM
                                        if (dt4.Rows[w][2].ToString() == "INICIO DE VIAGEM")
                                        {
                                            int a = 0;
                                            a = w - 1;
                                            if (a >= 0)
                                            {
                                                //if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                //{
                                                //    if (dt4.Rows[a][5].ToString() == "14")
                                                //    {
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");

                                                //    }
                                                //    else
                                                //        if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                //    {
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");

                                                //    }
                                                //    else
                                                //    {
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                //    }
                                                //}
                                                //if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                //}
                                                //else if (dt4.Rows[a][2].ToString() == "PARADA PERNOITE")
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;22");
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                //}
                                                //else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                //}

                                                if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                {


                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {

                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");



                                                    }
                                                    //else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "1" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "4")
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                    //}



                                                }
                                                else if (dt4.Rows[a][2].ToString() == "PARADA")
                                                {


                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {

                                                        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                    }
                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");



                                                    //}



                                                }
                                                //else if (dt4.Rows[a][2].ToString() == "RETORNO REFEICAO")
                                                //{
                                                //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                //    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");

                                                //}

                                            }
                                            //else
                                            //{
                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                            //}



                                        }
                                        //FIM
                                        #endregion

                                        #region PARADA CLIENTE / FORNECEDOR
                                        if (dt4.Rows[w][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                        {
                                            if (dt4.Rows[w][5].ToString() == "3" || dt4.Rows[w][5].ToString() == "2" || dt4.Rows[w][5].ToString() == "4")
                                            {
                                                int a = 0;
                                                a = w - 1;
                                                if (a >= 0)
                                                {
                                                    //if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                    //}
                                                    if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                    {
                                                        if (dt4.Rows[a][5].ToString() == "14")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;0102");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");


                                                        }
                                                        //else if (dt4.Rows[a][5].ToString() == "15")
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");

                                                        //}
                                                        //else
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;21");
                                                        //}

                                                    }
                                                }

                                            }
                                            else if (dt4.Rows[w][5].ToString() == "14")
                                            {
                                                int a = 0;
                                                a = w - 1;
                                                if (a >= 0)
                                                {
                                                    if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                    {
                                                        if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2" || dt4.Rows[a][5].ToString() == "4")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                        }
                                                        else if (dt4.Rows[a][5].ToString() == "14")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");

                                                        }


                                                    }
                                                    else
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");
                                                    }

                                                }


                                            }


                                        }
                                        #endregion

                                        #region REINICIO
                                        //BLOCO REINICIO / INICIO DE VIAGEM
                                        if (dt4.Rows[w][2].ToString() == "REINICIO DE VIAGEM")
                                        {
                                            int a = 0;
                                            a = w - 1;
                                            if (a >= 0)
                                            {
                                                if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                {

                                                }
                                                else if (dt4.Rows[a][2].ToString() == "PARADA PERNOITE")
                                                {
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                }

                                                else if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                {

                                                    if (a >= 0)
                                                    {

                                                        if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                        {
                                                            //if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                            //}
                                                            if (dt4.Rows[a][5].ToString() == "14")
                                                            {

                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");

                                                            }
                                                            //else if (dt4.Rows[a][5].ToString() == "15")
                                                            //{

                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");

                                                            //}
                                                            //else
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                            //}
                                                        }
                                                        //else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                        //}


                                                    }



                                                }
                                                else if (dt4.Rows[a][2].ToString() == "PARADA")
                                                {
                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                    }
                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                    //}




                                                }
                                                //else if (dt4.Rows[a][2].ToString() == "OFICINA / MANUTENCAO")
                                                //{

                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");


                                                //}

                                            }
                                            else
                                            {
                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");
                                                // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                            }



                                        }
                                        //FIM
                                        #endregion

                                        #region BLOCO PARADA
                                        // BLOCO PARADA
                                        if (dt4.Rows[w][2].ToString() == "PARADA")
                                        {
                                            int a = 0;
                                            a = w - 1;


                                            if (dt4.Rows[w][5].ToString() == "14")
                                            {
                                                if (dt4.Rows.Count >= a)
                                                {
                                                    if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                    {
                                                        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0193");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01930000");


                                                    }

                                                }
                                            }
                                            //else
                                            //{
                                            //    if (dt4.Rows.Count >= a)
                                            //    {
                                            //        if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                            //        {
                                            //            write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                            //            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;95");

                                            //        }
                                            //        //else
                                            //        //{
                                            //        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                            //        //    // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                            //        //}
                                            //    }
                                            //}



                                            //  write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");

                                        }
                                        //FIM
                                        #endregion

                                        #region FIM DE VIAGEM
                                        //BLOCO FIM DE VIAGEM
                                        if (dt4.Rows[w][2].ToString() == "FIM DE VIAGEM")
                                        {
                                            int a = 0;
                                            int g = 0;
                                            a = w - 1;
                                            g = w - 2;
                                            if (a >= 0)
                                            {
                                                if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                {


                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {

                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;0102");

                                                    }

                                                    //else if (dt4.Rows[a][5].ToString() == "14")
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                    //    // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                    //}

                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //    // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                    //}



                                                }
                                                else if (dt4.Rows[a][2].ToString() == "PARADA")
                                                {


                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;0102");

                                                    }

                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //    // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");

                                                    //}


                                                }

                                                else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                {
                                                    if (g >= 0)
                                                    {
                                                        //if (dt4.Rows[g][2].ToString() == "PARADA PERNOITE")
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                        //}
                                                        //else
                                                        //{
                                                        //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //}
                                                    }
                                                    //else
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //}


                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;94");
                                                }


                                            }
                                            //else
                                            //{
                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                            //}

                                        }

                                        //
                                        #endregion

                                        #region FIM DE JORNADA
                                        //BLOCO FIM DE JORMADA
                                        if (c > 0)
                                        {
                                            if (dt4.Rows[w][2].ToString() == "FIM DE JORNADA" && dt4.Rows[w][6].ToString() == "725405" || dt4.Rows[w][2].ToString() == "FIM DE JORNADA" && dt4.Rows[w][6].ToString() == "725407" || dt4.Rows[w][2].ToString() == "FIM DE JORNADA" && dt4.Rows[w][6].ToString() == "184525")
                                            {
                                                int a = 0;
                                                a = w - 1;

                                                if (a >= 0)
                                                {
                                                    if (dt4.Rows[a][2].ToString() == "RETORNO REFEICAO")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                    {

                                                        //WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");


                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "RETORNO REFEICAO")
                                                    {

                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");

                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM")
                                                    {
                                                        int b = 0;
                                                        b = a - 1;

                                                        if (b >= 0)
                                                        {
                                                            if (dt4.Rows[b][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[b][2].ToString() == "REINICIO DE VIAGEM")
                                                            {
                                                                int d = 0;
                                                                d = b - 1;
                                                                if (d >= 0)
                                                                {

                                                                    if (dt4.Rows[d][2].ToString() == "PARADA")
                                                                    {
                                                                        if (dt4.Rows[d][5].ToString() == "14")
                                                                        {
                                                                            // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                        }
                                                                        else
                                                                        {
                                                                            // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                            // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                        }




                                                                    }
                                                                    else
                                                                    {
                                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                        // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                    }
                                                                }
                                                            }
                                                            else
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            }

                                                        }
                                                        else
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                        }

                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "PARADA")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                    {
                                                        if (dt4.Rows[a][5].ToString() == "14")
                                                        {
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                        }
                                                        else
                                                        {
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        }
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");

                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                    }
                                                    else if (dt4.Rows[a][2].ToString() == "FIM DE JORNADA")
                                                    {
                                                        int m = 0;
                                                        m = a - 1;

                                                        if (m >= 0)
                                                        {
                                                            if (dt4.Rows[m][2].ToString() == "RETORNO REFEICAO" || dt4.Rows[m][2].ToString() == "INICIO DE JORNADA")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            }
                                                            else if (dt4.Rows[m][2].ToString() == "FIM DE VIAGEM")
                                                            {
                                                                int b = 0;
                                                                b = m - 1;

                                                                if (b >= 0)
                                                                {
                                                                    if (dt4.Rows[b][2].ToString() == "INICIO DE VIAGEM" || dt4.Rows[b][2].ToString() == "REINICIO DE VIAGEM")
                                                                    {
                                                                        int d = 0;
                                                                        d = b - 1;
                                                                        if (d >= 0)
                                                                        {

                                                                            if (dt4.Rows[d][2].ToString() == "PARADA")
                                                                            {
                                                                                if (dt4.Rows[d][5].ToString() == "14")
                                                                                {
                                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                                    //.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                                }
                                                                                else
                                                                                {
                                                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                                                }


                                                                            }
                                                                            else
                                                                            {
                                                                                // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                            }
                                                                        }
                                                                    }
                                                                    else
                                                                    {
                                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                                    }

                                                                }


                                                            }
                                                            //else if (dt4.Rows[m][2].ToString() == "REINICIO DE VIAGEM")
                                                            //{
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;94");
                                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //}
                                                            //else if (dt4.Rows[m][2].ToString() == "PARADA INTERNA")
                                                            //{
                                                            //    if (dt4.Rows[m][5].ToString() == "3" || dt4.Rows[m][5].ToString() == "1" || dt4.Rows[m][5].ToString() == "2")
                                                            //    {
                                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");

                                                            //    }
                                                            //    else if (dt4.Rows[m][5].ToString() == "22")
                                                            //    {
                                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                            //    }

                                                            //    else if (dt4.Rows[m][2].ToString() == "FIM DE JORNADA")
                                                            //    {
                                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //        write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            //    }

                                                            //}
                                                            else if (dt4.Rows[m][2].ToString() == "PARADA")
                                                            {
                                                                // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                            }
                                                            //else if (dt4.Rows[m][2].ToString() == "PARADA INTERNA")
                                                            //{
                                                            //    if (dt4.Rows[m][5].ToString() != "3" || dt4.Rows[m][5].ToString() != "1" || dt4.Rows[m][5].ToString() != "2")
                                                            //    {
                                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");
                                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                            //        write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                            //    }

                                                            //}

                                                            else
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            }


                                                        }
                                                        else
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                        }
                                                    }
                                                    else
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                    }


                                                }
                                                else
                                                {
                                                    // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                }
                                            }

                                        }
                                        else
                                        {
                                            if (dt4.Rows[w][2].ToString() == "FIM DE JORNADA")
                                            {
                                                int q = 0;
                                                q = w + 1;

                                                if (q < dt4.Rows.Count)
                                                {
                                                    if (dt4.Rows[q][2].ToString() == "FIM DE JORNADA")
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                    }
                                                    else
                                                    {
                                                        int a = 0;
                                                        a = w - 1;

                                                        if (a >= 0)
                                                        {

                                                            if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM" || dt4.Rows[a][2].ToString() == "RETORNO REFEICAO" || dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                            }
                                                            //else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                            //{
                                                            //    if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                            //    {
                                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                            //        // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                            //        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //    }
                                                            //    else if (dt4.Rows[a][5].ToString() == "14")
                                                            //    {
                                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                            //        write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            //    }
                                                            //    else
                                                            //    {
                                                            //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");


                                                            //    }
                                                            //}
                                                            else if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                            {

                                                            }
                                                            else if (dt4.Rows[a][2].ToString() == "FIM DE JORNADA")
                                                            {
                                                                //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            }
                                                            else
                                                            {
                                                                // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                                // write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            }
                                                        }
                                                    }

                                                }
                                                else
                                                {
                                                    int a = 0;
                                                    a = w - 1;

                                                    if (a >= 0)
                                                    {

                                                        if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");

                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "FIM DE VIAGEM" || dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "RETORNO REFEICAO")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");

                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                        {
                                                            if (dt4.Rows[a][5].ToString() == "14")
                                                            {
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                            }
                                                            else
                                                            {
                                                                write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                            }
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");

                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                        }
                                                        //else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                        //{
                                                        //    if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                        //    {
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                        //        // write.WriteLine(cracha + ";" + data + ";" + hora + ";2;2");
                                                        //        // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //    }
                                                        //    else if (dt4.Rows[a][5].ToString() == "14")
                                                        //    {
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                        //        write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                        //    }
                                                        //    else
                                                        //    {
                                                        //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;95");

                                                        //    }
                                                        //}
                                                        else if (dt4.Rows[a][2].ToString() == "INICIO DE JORNADA" || dt4.Rows[a][2].ToString() == "INICIO JORNADA CAMINHAO" || dt4.Rows[a][2].ToString() == "INICIO JORNADA")
                                                        {

                                                        }
                                                        else if (dt4.Rows[a][2].ToString() == "FIM DE JORNADA")
                                                        {
                                                            //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");

                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                        }
                                                        else
                                                        {
                                                            // write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                            //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                        }
                                                    }
                                                    else
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                    }
                                                }
                                            }





                                        }


                                        #endregion

                                        #region PARADA PERNOITE

                                        if (dt4.Rows[w][2].ToString() == "PARADA PERNOITE")
                                        {
                                            int a = 0;
                                            a = w - 1;


                                            if (a >= 0)
                                            {
                                                if (dt4.Rows[a][2].ToString() == "PARADA CLIENTE / FORNECEDOR")
                                                {


                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {

                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                        //WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;0102");
                                                        write.WriteLine("+00" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm").Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");


                                                    }
                                                    else if (dt4.Rows[a][5].ToString() == "15")
                                                    {

                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";2;22");


                                                    }
                                                    //else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;21");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");
                                                    //    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //}
                                                    else
                                                    {
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                    }



                                                }
                                                else if (dt4.Rows[a][2].ToString() == "PARADA")
                                                {
                                                    //if (dt4.Rows[a][5].ToString() == "7")
                                                    //{
                                                    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                    //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");
                                                    //}
                                                    if (dt4.Rows[a][5].ToString() == "14")
                                                    {

                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0293");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02930000");
                                                        //WriteLine(cracha + ";" + data + ";" + hora + ";1;0102");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;0102");
                                                        write.WriteLine("+00" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm").Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "01020000");


                                                    }
                                                    else
                                                    {
                                                        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                        write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                    }

                                                }
                                                else if (dt4.Rows[a][2].ToString() == "INICIO DE VIAGEM")
                                                {
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");
                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";2;22");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";3;22");
                                                }
                                                else if (dt4.Rows[a][2].ToString() == "REINICIO DE VIAGEM")
                                                {
                                                    write.WriteLine("+00" + hora.Replace(":", "") + data.Replace("/", "") + cracha.PadLeft(10, '0') + "02020000");
                                                    //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;0202");
                                                    //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;2");

                                                    // write.WriteLine(cracha + ";" + data + ";" + hora + ";3;22");
                                                }
                                                //else if (dt4.Rows[a][2].ToString() == "PARADA INTERNA")
                                                //{


                                                //    if (dt4.Rows[a][5].ToString() == "14")
                                                //    {

                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;93");
                                                //        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");


                                                //    }
                                                //    //else if (dt4.Rows[a][5].ToString() == "15")
                                                //    //{

                                                //    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                //    //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");


                                                //    //}
                                                //    else if (dt4.Rows[a][5].ToString() == "3" || dt4.Rows[a][5].ToString() == "2")
                                                //    {
                                                //        write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                //        //write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");
                                                //        //write.WriteLine(cracha + ";" + data + ";" + hora + ";1;2");
                                                //    }
                                                //    //else
                                                //    //{
                                                //    //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;22");
                                                //    //}



                                                //}
                                                //else
                                                //{
                                                //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;22");
                                                //}

                                            }
                                            //else
                                            //{
                                            //    write.WriteLine(cracha + ";" + data + ";" + hora + ";1;22");
                                            //    write.WriteLine(cracha + ";" + data + ";" + DateTime.Parse(hora).AddMinutes(1).ToString("HH:mm") + ";1;22");

                                            //}

                                        }

                                        #endregion


                                        write.Flush();
                                        write.Close();
                                    }

                                    //FIM

                                    #endregion
                                }
                            }
                        }
                    }



                    else
                    {

                        string retorno = "Erro! Contate o administrador. Detalhes do erro 60340: Não há marcações";
                        System.Text.StringBuilder sb2 = new System.Text.StringBuilder();
                        sb2.Append("<script type = 'text/javascript'>");
                        sb2.Append("window.onload=function(){");
                        sb2.Append("alert('");
                        sb2.Append(retorno);
                        sb2.Append("')};");
                        sb2.Append("</script>");
                        ClientScript.RegisterClientScriptBlock(this.GetType(), "alert", sb2.ToString());
                    }




                }
            }

            CarregaLista();
            string message = "Gerado com Sucesso!";
            System.Text.StringBuilder sb = new System.Text.StringBuilder();
            sb.Append("<script type = 'text/javascript'>");
            sb.Append("window.onload=function(){");
            sb.Append("alert('");
            sb.Append(message);
            sb.Append("')};");
            sb.Append("</script>");
            ClientScript.RegisterClientScriptBlock(this.GetType(), "alert", sb.ToString());

            txtDtInicial.Text = "";
            Response.Redirect(Request.RawUrl);




            //}
            //catch (Exception ed)
            //{

            //}
        }

        public void CarregaLista()
        {

            System.IO.DirectoryInfo di = new System.IO.DirectoryInfo(Request.ServerVariables["APPL_PHYSICAL_PATH"] + @"\TXT\");
            System.IO.FileInfo[] fi = di.GetFiles();
            ddlEscolherArquivo.Items.Add("(Selecione um Arquivo)");
            foreach (System.IO.FileInfo arquivo in fi)
                ddlEscolherArquivo.Items.Add(arquivo.Name);
        }
        protected void ddlEscolherArquivo_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (ddlEscolherArquivo.SelectedIndex != 0)
            {
                System.IO.FileInfo arquivo = new System.IO.FileInfo(Request.ServerVariables["APPL_PHYSICAL_PATH"] + @"\TXT\" + ddlEscolherArquivo.SelectedValue);
                Response.Clear();
                Response.AddHeader("Content-Disposition", "attachment; filename=" + arquivo.Name);
                Response.AddHeader("Content-Length", arquivo.Length.ToString());
                Response.ContentType = "application/octet-stream";
                Response.WriteFile(arquivo.FullName);
                Response.End();
            }
        }
    }
}